<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>16&nbsp; Statistical Models – Introduction to R for Modellers</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chap_03/chap_08.html" rel="next">
<link href="../exercises/exercises_all_2.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-597958c53c93a607afca12fd375c57ed.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-7ac2f9da8c2617a4fdd15004b4601015.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-597958c53c93a607afca12fd375c57ed.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f20fda0d586aae35f34e9d1db767c6bf.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-0df3fcf739b8a8f11d64fcee4b5f352d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-f20fda0d586aae35f34e9d1db767c6bf.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-265VMT9VML"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-265VMT9VML', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chap_03/chap_07.html">Model Building</a></li><li class="breadcrumb-item"><a href="../chap_03/chap_07.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Statistical Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Introduction to R for Modellers</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mgh.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MGH module matters</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Language Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/get_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Get Started</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/operators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Operators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/control_flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Control Flows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/environments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Environments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/code_style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Coding Style</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercises_all_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exercises I</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/containers_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Homogeneous Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/containers_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Heterogeneous Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/data_manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data manipulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/vis_base.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Visualisation I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/vis_ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualisation II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/work_w_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Working with files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercises_all_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exercises II</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Model Building</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_03/chap_07.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Statistical Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_03/chap_08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Mathematical Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Further Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_03/chap_09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Performance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/wks_02_rnumbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Random Numbers and Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/wks_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Sensitivity analysis workflow</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_00/file_address_sys.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">File address system</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/00_know_your_computer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Know your computer</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#model-building-in-r" id="toc-model-building-in-r" class="nav-link active" data-scroll-target="#model-building-in-r">Model building in R</a>
  <ul class="collapse">
  <li><a href="#model-types" id="toc-model-types" class="nav-link" data-scroll-target="#model-types">Model types</a></li>
  </ul></li>
  <li><a href="#statistical-models" id="toc-statistical-models" class="nav-link" data-scroll-target="#statistical-models"><strong>Statistical models</strong></a>
  <ul class="collapse">
  <li><a href="#interpolation" id="toc-interpolation" class="nav-link" data-scroll-target="#interpolation"><span class="header-section-number">16.1</span> Interpolation</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="header-section-number">16.2</span> Linear regression</a>
  <ul class="collapse">
  <li><a href="#dobson-2.2.2" id="toc-dobson-2.2.2" class="nav-link" data-scroll-target="#dobson-2.2.2"><span class="header-section-number">16.2.1</span> Dobson 2.2.2</a></li>
  </ul></li>
  <li><a href="#non-linear-models" id="toc-non-linear-models" class="nav-link" data-scroll-target="#non-linear-models"><span class="header-section-number">16.3</span> Non-linear models</a>
  <ul class="collapse">
  <li><a href="#transformation" id="toc-transformation" class="nav-link" data-scroll-target="#transformation"><span class="header-section-number">16.3.1</span> Transformation</a></li>
  <li><a href="#nls" id="toc-nls" class="nav-link" data-scroll-target="#nls"><span class="header-section-number">16.3.2</span> <code>nls</code></a></li>
  </ul></li>
  <li><a href="#optimisation-with-optim" id="toc-optimisation-with-optim" class="nav-link" data-scroll-target="#optimisation-with-optim"><span class="header-section-number">16.4</span> Optimisation with <code>optim</code></a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><strong>Exercises</strong></a>
  <ul class="collapse">
  <li><a href="#e7.1" id="toc-e7.1" class="nav-link" data-scroll-target="#e7.1">E7.1</a></li>
  <li><a href="#e7.2" id="toc-e7.2" class="nav-link" data-scroll-target="#e7.2">E7.2</a></li>
  <li><a href="#e7.3" id="toc-e7.3" class="nav-link" data-scroll-target="#e7.3">E7.3</a></li>
  <li><a href="#e7.4" id="toc-e7.4" class="nav-link" data-scroll-target="#e7.4">E7.4</a></li>
  <li><a href="#e7.5" id="toc-e7.5" class="nav-link" data-scroll-target="#e7.5">E7.5</a></li>
  <li><a href="#e7.6" id="toc-e7.6" class="nav-link" data-scroll-target="#e7.6">E7.6</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://bg-intro-r.github.io/" class="toc-action"><i class="bi bi-chat-right"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chap_03/chap_07.html">Model Building</a></li><li class="breadcrumb-item"><a href="../chap_03/chap_07.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Statistical Models</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Statistical Models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="model-building-in-r" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="model-building-in-r">Model building in R</h2>
<blockquote class="blockquote">
<p><a href="https://www.r-project.org/about.html">What is R?</a> - R is a language and environment for <strong>statistical</strong> computing and graphics.</p>
</blockquote>
<p><strong>Outline</strong></p>
<ul>
<li><strong>Model types</strong></li>
<li><strong>Statistical methods</strong>
<ul>
<li>Linear interpolation</li>
<li>Linear regression</li>
<li>Nonlinear regression</li>
<li>Optimisation</li>
</ul></li>
<li>Mathematical models
<ul>
<li>Model limits</li>
<li>Lorenz system</li>
<li>Solve differential equations with <code>desolve</code></li>
<li>Exponential growth model</li>
<li>Logistic growth model</li>
<li>Lotka-Volterra model</li>
<li>Drug concentration model</li>
</ul></li>
</ul>
<p><strong>Recommended readings:</strong></p>
<ul>
<li><a href="https://r4ds.had.co.nz/model-basics.html">Chapter 23, R for Data Science, Hadley</a></li>
</ul>
<section id="model-types" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-types">Model types</h3>
<p><code>WorldPhones</code> is a dataset for the number of telephones in various regions of the world (in thousands) in the 1950s.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>WorldPhones</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     N.Amer Europe Asia S.Amer Oceania Africa Mid.Amer
1951  45939  21574 2876   1815    1646     89      555
1956  60423  29990 4708   2568    2366   1411      733
1957  64721  32510 5230   2695    2526   1546      773
1958  68484  35218 6662   2845    2691   1663      836
1959  71799  37598 6856   3000    2868   1769      911
1960  76036  40341 8220   3145    3054   1905     1008
1961  79831  43173 9053   3338    3224   2005     1076</code></pre>
</div>
</div>
<p>We see that data for a few years between 1951 and 1956 are missing.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>x_data <span class="ot">&lt;-</span> <span class="fu">rownames</span>(WorldPhones)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb3-2"><a href="#cb3-2"></a>y_data <span class="ot">&lt;-</span> WorldPhones[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">"N.Amer"</span>]</span>
<span id="cb3-3"><a href="#cb3-3"></a>{</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">plot</span>(</span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="at">x =</span> x_data, <span class="at">xlab =</span> <span class="st">"Years (t)"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="at">y =</span> y_data, <span class="at">ylab =</span> <span class="st">"number of phones (n)"</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>)</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1953</span>, <span class="at">y =</span> <span class="dv">52500</span> <span class="sc">+</span> (<span class="fu">rnorm</span>(<span class="dv">7</span>)<span class="sc">*</span><span class="dv">3000</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"?"</span>))</span>
<span id="cb3-9"><a href="#cb3-9"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What if we want to estimate how many phones “N.Amer” had in 1953?</p>
<ul>
<li>We assume that the increase in the number of phones (<span class="math inline">\(n\)</span>) is constant over time (<span class="math inline">\(t\)</span>)</li>
<li>We assume that the values between 1951 and 1956 are only related to these two data points</li>
</ul>
<hr>
<ul>
<li><strong>Method 1</strong> : Linear interpolation (<code>approx</code>, <code>approxfun</code>)</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>a <span class="ot">&lt;-</span> <span class="fu">approx</span>(<span class="at">x =</span> x_data, <span class="at">y =</span> y_data)</span>
<span id="cb4-2"><a href="#cb4-2"></a>afunc <span class="ot">&lt;-</span> <span class="fu">approxfun</span>(<span class="at">x =</span> x_data, <span class="at">y =</span> y_data)</span>
<span id="cb4-3"><a href="#cb4-3"></a>wanted_t <span class="ot">&lt;-</span> <span class="dv">1953</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>wanted_n <span class="ot">&lt;-</span> <span class="fu">afunc</span>(wanted_t)</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>{</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="fu">plot</span>(</span>
<span id="cb4-8"><a href="#cb4-8"></a>  <span class="at">x =</span> <span class="fu">rownames</span>(WorldPhones)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab =</span> <span class="st">"Years (t)"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="at">y =</span> WorldPhones[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">"N.Amer"</span>], <span class="at">ylab =</span> <span class="st">"number of phones (n)"</span>,</span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="at">main =</span> <span class="st">"Linear interpolation"</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>)</span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="fu">points</span>(a)</span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="fu">points</span>(<span class="at">x =</span> wanted_t, <span class="at">y =</span> wanted_n, <span class="at">pch =</span> <span class="dv">18</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="fu">text</span>(<span class="at">x =</span> wanted_t, <span class="at">y =</span> wanted_n <span class="sc">*</span> <span class="fl">1.01</span>, <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"(t = "</span>, wanted_t, <span class="st">", n = "</span>, wanted_n, <span class="st">")"</span>), <span class="at">pos =</span> <span class="dv">2</span>)</span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="fu">abline</span>(<span class="at">v =</span> wanted_t, <span class="at">lty =</span> <span class="st">"dotted"</span>)</span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="fu">abline</span>(<span class="at">h =</span> wanted_n, <span class="at">lty =</span> <span class="st">"dotted"</span>)</span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> wanted_n, <span class="at">labels =</span> <span class="fu">paste0</span>(wanted_n<span class="sc">%/%</span><span class="dv">1000</span>, <span class="st">"k"</span>), <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb4-18"><a href="#cb4-18"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Method 2</strong> : Mathematical model</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>dndt <span class="ot">&lt;-</span> <span class="fu">diff</span>(y_data) <span class="sc">/</span> <span class="fu">diff</span>(<span class="fu">as.numeric</span>(x_data))</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>YearStep <span class="ot">&lt;-</span> <span class="cf">function</span>(n_prev_year, dndt) {</span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">return</span>(n_prev_year <span class="sc">+</span> dndt)</span>
<span id="cb5-5"><a href="#cb5-5"></a>}</span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a>n <span class="ot">&lt;-</span> y_data[<span class="dv">1</span>]</span>
<span id="cb5-8"><a href="#cb5-8"></a>num_years <span class="ot">&lt;-</span> wanted_t <span class="sc">-</span> <span class="fu">as.numeric</span>(x_data[<span class="dv">1</span>])</span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="fu">stopifnot</span>(num_years <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="cf">for</span> (tt <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_years) {</span>
<span id="cb5-11"><a href="#cb5-11"></a>  n <span class="ot">&lt;-</span> <span class="fu">YearStep</span>(n, dndt)</span>
<span id="cb5-12"><a href="#cb5-12"></a>}</span>
<span id="cb5-13"><a href="#cb5-13"></a>n</span>
<span id="cb5-14"><a href="#cb5-14"></a>  </span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co"># simplified version</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co"># f &lt;- function(init_n, init_t, dndt, t) {</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#   return(init_n + (t - init_t) * dndt)</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co"># }</span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co"># f(y_data[1], as.numeric(x_data[1]), dndt, wanted_t) </span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We see that although the two methods reach the same conclusion, their modelling methods differ.</p>
<ul>
<li><strong>Method 1</strong> (statistical): values are interpolated between the two known data points</li>
<li><strong>Method 2</strong> (mathematical): the yearly rate of change (<span class="math inline">\(dn/dt\)</span>) is worked out for the state change equation</li>
<li>The initial assumption that the number of phones (<span class="math inline">\(n\)</span>) increase linearly in time (<span class="math inline">\(t\)</span>) is often a conclusion drawn from statistical analysis of the known data points.</li>
<li>Statistical models build on the premise that a pattern is identifiable from a set of data points, and estimate the probability distribution of a set of outcomes.</li>
<li>Mathematical models describe the mechanisms of real world event with a set of equations (a system of equations), and derive predictions via simulation.</li>
<li>Statistics is a mathematical discipline, and statistical models are a special class of mathematical model that uses statistical methods to describe data and make inferences</li>
<li>Mathematical model, just like mathematics, is widely applied across disciplines.</li>
</ul>
<p><a href="https://serc.carleton.edu/introgeo/mathstatmodels/index.html">More on the difference between statistical and mathematical modelling approaches</a></p>
<hr>
</section>
</section>
<section id="statistical-models" class="level1 unnumbered">
<h1 class="unnumbered"><strong>Statistical models</strong></h1>
<section id="interpolation" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="interpolation"><span class="header-section-number">16.1</span> Interpolation</h2>
<ul>
<li>Linear interpolation
<ul>
<li><code>approx</code> - returns a list of points which linearly interpolate given data points.</li>
<li><code>approxfun</code> - returns a function that performs the interpolation.</li>
</ul></li>
<li>Polynomial interpolation
<ul>
<li><code>spline</code> - returns a list of points along the spline interpolation of the given data points.</li>
<li><code>splinefun</code> - returns a function of the spline interpolation</li>
</ul></li>
</ul>
<p><code>?approx</code>:</p>
<ul>
<li>with <code>approx</code>:</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>{</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="fu">plot</span>(x, y, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="fu">points</span>(<span class="fu">approx</span>(x, y), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="fu">points</span>(<span class="fu">approx</span>(x, y, <span class="at">method =</span> <span class="st">"constant"</span>), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"method = linear"</span>, <span class="st">"method = constant"</span>),</span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>),</span>
<span id="cb6-11"><a href="#cb6-11"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb6-12"><a href="#cb6-12"></a>)</span>
<span id="cb6-13"><a href="#cb6-13"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><code>approxfun</code></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>f <span class="ot">&lt;-</span> <span class="fu">approxfun</span>(x, y)</span>
<span id="cb7-2"><a href="#cb7-2"></a>{</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">curve</span>(<span class="fu">f</span>(x), <span class="dv">1</span>, <span class="dv">10</span>, <span class="at">col =</span> <span class="st">"green2"</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="fu">points</span>(x, y)</span>
<span id="cb7-5"><a href="#cb7-5"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><code>splinefun</code></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># x &lt;- 1:10</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co"># y &lt;- rnorm(10)</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>f <span class="ot">&lt;-</span> <span class="fu">splinefun</span>(x, y)</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="fu">curve</span>(<span class="fu">f</span>(x), <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="fu">points</span>(x, y)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpolation methods ensures that the fitted curve goes through every point in the observed dataset. A bit like connecting the dots:</p>
<p><img src="img/7_overfit.png" class="img-fluid"></p>
<ul>
<li>It is great at preserving the known data exactly</li>
<li>It preserves all flaws that the data carries</li>
<li>Selective representation of the real world situation, missing data points are not represented</li>
<li>Over fit</li>
</ul>
<p>Example:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># x &lt;- 1:10</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co"># y &lt;- rnorm(10)</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># f &lt;- splinefun(x, y)</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>x_extra <span class="ot">&lt;-</span> <span class="fl">7.5</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>y_extra <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>f2 <span class="ot">&lt;-</span> <span class="fu">splinefun</span>(<span class="fu">c</span>(x, x_extra), <span class="fu">c</span>(y, y_extra))</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a>{</span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="fu">curve</span>(<span class="fu">f</span>(x), <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="fu">points</span>(x, y)</span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co"># par(new = TRUE)</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb9-13"><a href="#cb9-13"></a>y2 <span class="ot">&lt;-</span> <span class="fu">f2</span>(x2)</span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="fu">lines</span>(x2, y2, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="fu">points</span>(x_extra, y_extra, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"original data"</span>, <span class="st">"additional data"</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>))</span>
<span id="cb9-17"><a href="#cb9-17"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="linear-regression" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="linear-regression"><span class="header-section-number">16.2</span> Linear regression</h2>
<blockquote class="blockquote">
<p><code>?lm</code> - performs linear least squares regression to fit linear models</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/7_regression.png" class="img-fluid figure-img"></p>
<figcaption>residuals of least square fit, <a href="https://en.wikipedia.org/wiki/Linear_least_squares">image source</a></figcaption>
</figure>
</div>
<section id="dobson-2.2.2" class="level3" data-number="16.2.1">
<h3 data-number="16.2.1" class="anchored" data-anchor-id="dobson-2.2.2"><span class="header-section-number">16.2.1</span> Dobson 2.2.2</h3>
<p>This dataset comes from section 2.2.2 of Annette J. Dobson, “An introduction to generalized linear models”, 2nd edition:</p>
<p><img src="img/7_Dobson.png" class="img-fluid"></p>
<p>In this table are the birthweights (in grams) and estimated gestational ages (in weeks) of 12 boys and 12 girls born in a certain hospital.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">38</span>, <span class="dv">40</span>, <span class="dv">35</span>, <span class="dv">36</span>, <span class="dv">37</span>, <span class="dv">41</span>, <span class="dv">40</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">40</span>, <span class="dv">38</span>,  <span class="co"># boys</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>          <span class="dv">40</span>, <span class="dv">36</span>, <span class="dv">40</span>, <span class="dv">38</span>, <span class="dv">42</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">37</span>, <span class="dv">36</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>), <span class="co"># girls</span></span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">2968</span>, <span class="dv">2795</span>, <span class="dv">3163</span>, <span class="dv">2925</span>, <span class="dv">2625</span>, <span class="dv">2847</span>, <span class="dv">3292</span>, <span class="dv">3473</span>, <span class="dv">2628</span>, <span class="dv">3176</span>, <span class="dv">3421</span>, <span class="dv">2975</span>, <span class="co"># boys</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>             <span class="dv">3317</span>, <span class="dv">2729</span>, <span class="dv">2935</span>, <span class="dv">2754</span>, <span class="dv">3210</span>, <span class="dv">2817</span>, <span class="dv">3126</span>, <span class="dv">2539</span>, <span class="dv">2412</span>, <span class="dv">2991</span>, <span class="dv">2875</span>, <span class="dv">3231</span>), <span class="co"># girls</span></span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="at">gender =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">24</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"boys"</span>, <span class="st">"girls"</span>))</span>
<span id="cb10-9"><a href="#cb10-9"></a>)</span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="fu">summary</span>(dtf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      age            weight       gender  
 Min.   :35.00   Min.   :2412   boys :12  
 1st Qu.:37.00   1st Qu.:2785   girls:12  
 Median :38.50   Median :2952             
 Mean   :38.54   Mean   :2968             
 3rd Qu.:40.00   3rd Qu.:3184             
 Max.   :42.00   Max.   :3473             </code></pre>
</div>
</div>
<p>Let’s use the simple <code>weight</code> is a function of <code>age</code> formula:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>f1 <span class="ot">&lt;-</span> weight <span class="sc">~</span> age</span>
<span id="cb12-2"><a href="#cb12-2"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(f1, <span class="at">data =</span> dtf)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">summary</span>(lm1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = f1, data = dtf)

Residuals:
    Min      1Q  Median      3Q     Max 
-262.03 -158.29    8.35   88.15  366.50 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -1485.0      852.6  -1.742   0.0955 .  
age            115.5       22.1   5.228 3.04e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 192.6 on 22 degrees of freedom
Multiple R-squared:  0.554, Adjusted R-squared:  0.5338 
F-statistic: 27.33 on 1 and 22 DF,  p-value: 3.04e-05</code></pre>
</div>
</div>
<ul>
<li>The <strong>R-squared</strong> values is between 0 and 1. The lower end (closer to 0) indicate a poorly fitted model, the higher end (closer to 1) indicate a model of good fit.</li>
<li>A <strong>p-value</strong> that’s less than 0.05 means an independent variable (predictor) plays a meaningful part in the fitted model.</li>
<li>A small p-value of 3.04e-05 means that <code>age</code> plays a significant part in this model.</li>
<li>A p-value of 0.0955 means that the intercept term is not significant for this model.</li>
</ul>
<p>Let’s take a look at the coefficients of the fitted model:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">attributes</span>(lm1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
 [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "xlevels"       "call"          "terms"         "model"        

$class
[1] "lm"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>lm1<span class="sc">$</span>coefficients</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         age 
 -1484.9846    115.5283 </code></pre>
</div>
</div>
<p>The fitted formula is <span class="math inline">\(weight = -1484.9846 + 115.5283\times age\)</span>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>{</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">plot</span>(f1, <span class="at">data =</span> dtf,  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">42</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1500</span>, <span class="dv">3400</span>))</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="fu">abline</span>(lm1, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a>}<span class="co">#plot(lm1)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The negative intercept means that the baby has a negative weight at age 0</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">predict</span>(<span class="at">object =</span> lm1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">0</span>)) <span class="co"># weight when age is 0 (intercept)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
-1484.985 </code></pre>
</div>
</div>
<p>Let’s drop the intercept term from the formula:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>f2 <span class="ot">&lt;-</span> weight <span class="sc">~</span> age <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(f2, <span class="at">data =</span> dtf)</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="fu">summary</span>(lm2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = f2, data = dtf)

Residuals:
    Min      1Q  Median      3Q     Max 
-362.91 -148.65  -16.19  135.71  389.77 

Coefficients:
    Estimate Std. Error t value Pr(&gt;|t|)    
age   77.081      1.063   72.51   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 200.9 on 23 degrees of freedom
Multiple R-squared:  0.9956,    Adjusted R-squared:  0.9955 
F-statistic:  5258 on 1 and 23 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The p-value for <code>age</code> is 2.2e-16. Compare the two fitted models:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>{</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">plot</span>(f2, <span class="at">data =</span> dtf, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">42</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3400</span>))</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="fu">abline</span>(lm2, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="fu">abline</span>(lm1, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">c</span>(<span class="st">"no intercept"</span>, <span class="st">"with intercept"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span>
<span id="cb23-6"><a href="#cb23-6"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>We can bring <code>gender</code> into the formula:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>f3 <span class="ot">&lt;-</span> weight <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> age <span class="sc">+</span> gender</span>
<span id="cb24-2"><a href="#cb24-2"></a>lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(f3, <span class="at">data =</span> dtf)</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="fu">summary</span>(lm3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = f3, data = dtf)

Residuals:
    Min      1Q  Median      3Q     Max 
-257.49 -125.28  -58.44  169.00  303.98 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
age           120.89      20.46   5.908 7.28e-06 ***
genderboys  -1610.28     786.08  -2.049   0.0532 .  
gendergirls -1773.32     794.59  -2.232   0.0367 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 177.1 on 21 degrees of freedom
Multiple R-squared:  0.9969,    Adjusted R-squared:  0.9965 
F-statistic:  2258 on 3 and 21 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<hr>
<p>We can also fit the two genders separately:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>lm2_boys <span class="ot">&lt;-</span> <span class="fu">lm</span>(f2, <span class="at">data =</span> dtf, <span class="at">subset =</span> (gender <span class="sc">==</span> <span class="st">"boys"</span>))</span>
<span id="cb26-2"><a href="#cb26-2"></a>lm2_girls <span class="ot">&lt;-</span> <span class="fu">lm</span>(f2, <span class="at">data =</span> dtf, <span class="at">subset =</span> (gender <span class="sc">==</span> <span class="st">"girls"</span>))</span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="fu">summary</span>(lm2_boys)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = f2, data = dtf, subset = (gender == "boys"))

Residuals:
    Min      1Q  Median      3Q     Max 
-293.50 -194.15  -10.41  164.95  314.62 

Coefficients:
    Estimate Std. Error t value Pr(&gt;|t|)    
age   78.959      1.515   52.13 1.59e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 201.3 on 11 degrees of freedom
Multiple R-squared:  0.996, Adjusted R-squared:  0.9956 
F-statistic:  2718 on 1 and 11 DF,  p-value: 1.593e-14</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">summary</span>(lm2_girls)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = f2, data = dtf, subset = (gender == "girls"))

Residuals:
    Min      1Q  Median      3Q     Max 
-296.72 -108.26  -19.58  120.19  307.31 

Coefficients:
    Estimate Std. Error t value Pr(&gt;|t|)    
age   75.242      1.345   55.95 7.34e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 180.7 on 11 degrees of freedom
Multiple R-squared:  0.9965,    Adjusted R-squared:  0.9962 
F-statistic:  3130 on 1 and 11 DF,  p-value: 7.343e-15</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>b_col <span class="ot">&lt;-</span> <span class="st">"deepskyblue"</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>g_col <span class="ot">&lt;-</span> <span class="st">"deeppink"</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>{</span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="fu">plot</span>(f2, <span class="at">data =</span> dtf, <span class="at">col =</span> b_col, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="fu">points</span>(dtf[dtf<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"girls"</span>,], <span class="at">col =</span> g_col, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="fu">abline</span>(lm2_boys, <span class="at">col =</span> b_col)</span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="fu">abline</span>(lm2_girls, <span class="at">col =</span> g_col)</span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">c</span>(<span class="st">"boys"</span>, <span class="st">"girls"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(b_col, g_col))</span>
<span id="cb30-9"><a href="#cb30-9"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The “R-squared” values is between 0 and 1. The lower end (closer to 0) indicate a poorly fitted model, the higher end (closer to 1) indicate a model of good fit.</li>
<li>Adding gender to the model does improve the quality of the fit.</li>
</ul>
</section>
</section>
<section id="non-linear-models" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="non-linear-models"><span class="header-section-number">16.3</span> Non-linear models</h2>
<section id="transformation" class="level3" data-number="16.3.1">
<h3 data-number="16.3.1" class="anchored" data-anchor-id="transformation"><span class="header-section-number">16.3.1</span> Transformation</h3>
<p>The <code>Indometh</code> dataset contains plasma concentration data of 6 subjects of indometacin, which was published in Kwan, Breault, Umbenhauer, McMahon and Duggan (1976) Kinetics of Indomethacin absorption, elimination, and enterohepatic circulation in man. Journal of Pharmacokinetics and Biopharmaceutics 4, 255–280.</p>
<p>Let’s first inspect the dataset:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># inspect the dataset</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="fu">names</span>(Indometh)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Subject" "time"    "conc"   </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">summary</span>(Indometh)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Subject      time            conc       
 1:11    Min.   :0.250   Min.   :0.0500  
 4:11    1st Qu.:0.750   1st Qu.:0.1100  
 2:11    Median :2.000   Median :0.3400  
 5:11    Mean   :2.886   Mean   :0.5918  
 6:11    3rd Qu.:5.000   3rd Qu.:0.8325  
 3:11    Max.   :8.000   Max.   :2.7200  </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">plot</span>(conc <span class="sc">~</span> time, <span class="at">data =</span> Indometh)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that data resembles the pattern of exponential decay:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/7_exp_decay.png" class="img-fluid figure-img"></p>
<figcaption><a href="https://en.wikipedia.org/wiki/Exponential_decay">image source</a></figcaption>
</figure>
</div>
<p>Therefore we transform <code>conc</code> with <code>log()</code> and get a linear regression fit:</p>
<p><span class="math inline">\(log(conc) = b + a \times time\)</span></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>idm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(conc) <span class="sc">~</span> time, <span class="at">data =</span> Indometh)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">summary</span>(idm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(conc) ~ time, data = Indometh)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.9558 -0.2940 -0.0206  0.3528  1.0125 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.09288    0.09337   0.995    0.324    
time        -0.41910    0.02468 -16.982   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4904 on 64 degrees of freedom
Multiple R-squared:  0.8184,    Adjusted R-squared:  0.8155 
F-statistic: 288.4 on 1 and 64 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>t <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>{</span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="fu">plot</span>(conc <span class="sc">~</span> time, <span class="at">data =</span> Indometh)</span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="fu">lines</span>(</span>
<span id="cb38-5"><a href="#cb38-5"></a>  <span class="at">x =</span> t,</span>
<span id="cb38-6"><a href="#cb38-6"></a>  <span class="at">y =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(idm, <span class="fu">data.frame</span>(<span class="at">time =</span> t))) <span class="co"># note we need exp() to transform y back</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>)</span>
<span id="cb38-8"><a href="#cb38-8"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pick one subject for fitting:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>Indometh_1 <span class="ot">&lt;-</span> Indometh[Indometh<span class="sc">$</span>Subject <span class="sc">==</span> <span class="dv">1</span>,]</span>
<span id="cb39-2"><a href="#cb39-2"></a>idm_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(conc) <span class="sc">~</span> time, <span class="at">data =</span> Indometh_1)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="fu">summary</span>(idm_1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(conc) ~ time, data = Indometh_1)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.63614 -0.27362 -0.08709  0.33472  0.73837 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.22825    0.22407  -1.019    0.335    
time        -0.41862    0.05923  -7.068 5.87e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4804 on 9 degrees of freedom
Multiple R-squared:  0.8473,    Adjusted R-squared:  0.8304 
F-statistic: 49.96 on 1 and 9 DF,  p-value: 5.869e-05</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>{</span>
<span id="cb41-2"><a href="#cb41-2"></a>t <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="fu">plot</span>(conc <span class="sc">~</span> time, <span class="at">data =</span> Indometh)</span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="fu">points</span>(conc <span class="sc">~</span> time, <span class="at">data =</span> Indometh_1, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="fu">lines</span>(</span>
<span id="cb41-6"><a href="#cb41-6"></a>  <span class="at">x =</span> t,</span>
<span id="cb41-7"><a href="#cb41-7"></a>  <span class="at">y =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(idm_1, <span class="fu">data.frame</span>(<span class="at">time =</span> t))),</span>
<span id="cb41-8"><a href="#cb41-8"></a>  <span class="at">col =</span> <span class="st">"blue"</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>)</span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="fu">lines</span>(</span>
<span id="cb41-11"><a href="#cb41-11"></a>  <span class="at">x =</span> t,</span>
<span id="cb41-12"><a href="#cb41-12"></a>  <span class="at">y =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(idm, <span class="fu">data.frame</span>(<span class="at">time =</span> t))),</span>
<span id="cb41-13"><a href="#cb41-13"></a>  <span class="at">col =</span> <span class="st">"black"</span></span>
<span id="cb41-14"><a href="#cb41-14"></a>)</span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"all subjects"</span>, <span class="st">"subject 1"</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"blue"</span>) )</span>
<span id="cb41-16"><a href="#cb41-16"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nls" class="level3" data-number="16.3.2">
<h3 data-number="16.3.2" class="anchored" data-anchor-id="nls"><span class="header-section-number">16.3.2</span> <code>nls</code></h3>
<p>We now further our search with an <code>nls</code> (non-linear least squares) regression search.</p>
<p>We fitted with <code>lm</code> with a transformed <code>conc</code>:</p>
<ul>
<li><span class="math inline">\(log(conc) = b + a \times time\)</span></li>
<li><code>b</code> estimated at 0.09288</li>
<li><code>a</code> estimated at -0.41910</li>
</ul>
<p>Transform the formula back to exponential form: <span class="math inline">\(conc = exp(b + a \times time)\)</span> –&gt; <span class="math inline">\(conc = exp(b) \times exp(a \times time)\)</span></p>
<p>A standard exponential growth function: <span class="math inline">\(P(t) = P_{0} \times exp(r \times t)\)</span></p>
<p>We take the result from <code>lm</code> as starting</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>p0_init <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coefficients</span>(idm)[<span class="dv">1</span>])</span>
<span id="cb42-2"><a href="#cb42-2"></a>r_init  <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(idm)[<span class="dv">2</span>]</span>
<span id="cb42-3"><a href="#cb42-3"></a></span>
<span id="cb42-4"><a href="#cb42-4"></a>init <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p0 =</span> <span class="fu">unname</span>(p0_init), <span class="at">r =</span> <span class="fu">unname</span>(r_init))</span>
<span id="cb42-5"><a href="#cb42-5"></a>init</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$p0
[1] 1.097336

$r
[1] -0.4191029</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>idm_nls <span class="ot">&lt;-</span> <span class="fu">nls</span>(conc <span class="sc">~</span> p0 <span class="sc">*</span> <span class="fu">exp</span>(r <span class="sc">*</span> time), <span class="at">data =</span> Indometh, <span class="at">start =</span> init)</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="fu">summary</span>(idm_nls)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: conc ~ p0 * exp(r * time)

Parameters:
   Estimate Std. Error t value Pr(&gt;|t|)    
p0  2.77706    0.15379   18.06   &lt;2e-16 ***
r  -1.35038    0.09938  -13.59   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2001 on 64 degrees of freedom

Number of iterations to convergence: 9 
Achieved convergence tolerance: 4.283e-06</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>{</span>
<span id="cb46-2"><a href="#cb46-2"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="fu">plot</span>(conc <span class="sc">~</span> time, <span class="at">data =</span> Indometh)</span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="fu">lines</span>(</span>
<span id="cb46-5"><a href="#cb46-5"></a>  <span class="at">x =</span> t,</span>
<span id="cb46-6"><a href="#cb46-6"></a>  <span class="at">y =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(idm, <span class="fu">data.frame</span>(<span class="at">time =</span> t))),</span>
<span id="cb46-7"><a href="#cb46-7"></a>  <span class="at">col =</span> <span class="st">"black"</span></span>
<span id="cb46-8"><a href="#cb46-8"></a>)</span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="fu">lines</span>(</span>
<span id="cb46-10"><a href="#cb46-10"></a>  <span class="at">x =</span> t,</span>
<span id="cb46-11"><a href="#cb46-11"></a>  <span class="at">y =</span> <span class="fu">predict</span>(idm_nls, <span class="fu">data.frame</span>(<span class="at">time =</span> t)),</span>
<span id="cb46-12"><a href="#cb46-12"></a>  <span class="at">col =</span> <span class="st">"skyblue"</span>,</span>
<span id="cb46-13"><a href="#cb46-13"></a>  <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb46-14"><a href="#cb46-14"></a>)</span>
<span id="cb46-15"><a href="#cb46-15"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">residuals</span>(idm)</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="fu">residuals</span>(idm_nls)</span>
<span id="cb47-3"><a href="#cb47-3"></a></span>
<span id="cb47-4"><a href="#cb47-4"></a><span class="fu">sum</span>(<span class="fu">residuals</span>(idm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb47-5"><a href="#cb47-5"></a><span class="fu">sum</span>(<span class="fu">residuals</span>(idm_nls)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="optimisation-with-optim" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="optimisation-with-optim"><span class="header-section-number">16.4</span> Optimisation with <code>optim</code></h2>
<p>Observing the fitted model from <code>nls</code> we see that the fitting is done in iterations until a convergence tolerance is met. This type of search is often applied when the optimal solution (the best fit curve) isn’t obvious and the search space is also big enough that it is (computationally) impossible to try all combinations of parameter values.</p>
<p>This class of problem, when generalised, is referred to as optimisation problems. <code>optim</code> is R’s general-purpose optimisation function.</p>
<p>The <a href="https://en.wikipedia.org/wiki/Rosenbrock_function">Rosenbrock function</a> is a non-convex function with the definition:</p>
<p><span class="math inline">\(f(x, y) = (a - x)^2 + b(y-x^2)^2\)</span></p>
<p>The global minimum is at <span class="math inline">\((x, y) = (a, a^2)\)</span> where <span class="math inline">\(f(x, y) = 0\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/7_Rosenbrock.png" class="img-fluid figure-img"></p>
<figcaption><a href="https://en.wikipedia.org/wiki/Rosenbrock_function">image source</a></figcaption>
</figure>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>b <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>fr <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {   <span class="co"># Rosenbrock Banana function</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>    x1 <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb48-5"><a href="#cb48-5"></a>    x2 <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb48-6"><a href="#cb48-6"></a>    (a <span class="sc">-</span> x1)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b <span class="sc">*</span> (x2 <span class="sc">-</span> x1 <span class="sc">*</span> x1)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb48-7"><a href="#cb48-7"></a>}</span>
<span id="cb48-8"><a href="#cb48-8"></a><span class="fu">optim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="dv">1</span>), fr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 2.000267 4.001077

$value
[1] 7.874009e-08

$counts
function gradient 
     265       NA 

$convergence
[1] 0

$message
NULL</code></pre>
</div>
</div>
<p>See <a href="https://en.wikipedia.org/wiki/Test_functions_for_optimization">Test functions for optimisation</a> for more functions like the Rosenbrock Banana function.</p>
</section>
</section>
<section id="exercises" class="level1 unnumbered">
<h1 class="unnumbered"><strong>Exercises</strong></h1>
<section id="e7.1" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="e7.1">E7.1</h2>
<p>In our example using the <code>WorldPhones</code> dataset, we built a mathematical model assuming the number of new phones per year is a constant. What if we assume that the rate of change is constant, rather than the quantity? i.e.&nbsp;the number of phones has a constant year on year change rate of <span class="math inline">\(r\)</span> such that:</p>
<p><span class="math display">\[n_{a+n} = n_{a}*(1+r)^{n}\]</span></p>
<ol type="1">
<li>Modify the mathematical model we implemented in the lecture with this new assumption.</li>
<li>Compare the results between these two different assumptions with a plot</li>
</ol>
</section>
<section id="e7.2" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="e7.2">E7.2</h2>
<p>We talked about how linear interpolation can be done with <code>approxfun</code> during the lecture. But we only talked about how values are interpolated between the extremes of the dataset. What if we need values outside of these bounds? (Tip: Read the documentation on <code>approxfun</code>)</p>
</section>
<section id="e7.3" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="e7.3">E7.3</h2>
<p>During the lecture, we used the following code to demonstrate how an additional data point can change the result of polynomial interpolations. Modify the code to demonstrate how changes in data point values (in this case a new value for <code>y8</code>) can also affect the interpolation result.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb50-2"><a href="#cb50-2"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb50-4"><a href="#cb50-4"></a>f <span class="ot">&lt;-</span> <span class="fu">splinefun</span>(x, y)</span>
<span id="cb50-5"><a href="#cb50-5"></a>x_extra <span class="ot">&lt;-</span> <span class="fl">7.5</span></span>
<span id="cb50-6"><a href="#cb50-6"></a>y_extra <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb50-7"><a href="#cb50-7"></a>f2 <span class="ot">&lt;-</span> <span class="fu">splinefun</span>(<span class="fu">c</span>(x, x_extra), <span class="fu">c</span>(y, y_extra))</span>
<span id="cb50-8"><a href="#cb50-8"></a></span>
<span id="cb50-9"><a href="#cb50-9"></a>y8_new <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>) <span class="co"># new value for y[8]</span></span>
<span id="cb50-10"><a href="#cb50-10"></a></span>
<span id="cb50-11"><a href="#cb50-11"></a>{</span>
<span id="cb50-12"><a href="#cb50-12"></a><span class="fu">curve</span>(<span class="fu">f</span>(x), <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb50-13"><a href="#cb50-13"></a><span class="fu">points</span>(x, y)</span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="co"># par(new = TRUE)</span></span>
<span id="cb50-15"><a href="#cb50-15"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb50-16"><a href="#cb50-16"></a>y2 <span class="ot">&lt;-</span> <span class="fu">f2</span>(x2)</span>
<span id="cb50-17"><a href="#cb50-17"></a><span class="fu">lines</span>(x2, y2, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb50-18"><a href="#cb50-18"></a><span class="fu">points</span>(x_extra, y_extra, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb50-19"><a href="#cb50-19"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap_07_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="e7.4" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="e7.4">E7.4</h2>
<p>Perform linear regression on R base’s built-in <code>cars</code> dataset.</p>
</section>
<section id="e7.5" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="e7.5">E7.5</h2>
<p>Perform linear regression on the <code>anscombe</code> dataset</p>
</section>
<section id="e7.6" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="e7.6">E7.6</h2>
<p>Use <code>optim</code> to find the minimum of the <a href="https://en.wikipedia.org/wiki/Test_functions_for_optimization#:~:text=Goldstein%E2%80%93Price%20function">Golstein-Price function</a>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../exercises/exercises_all_2.html" class="pagination-link" aria-label="Exercises II">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exercises II</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chap_03/chap_08.html" class="pagination-link" aria-label="Mathematical Models">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Mathematical Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2021 - 2026, Bo Gao</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://bg-intro-r.github.io/" class="toc-action"><i class="bi bi-chat-right"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bogaotory">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/bogaowarwick/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>