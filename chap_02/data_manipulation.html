<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>11&nbsp; Data manipulation – Introduction to R for Modellers</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chap_02/vis_base.html" rel="next">
<link href="../chap_02/containers_02.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-597958c53c93a607afca12fd375c57ed.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-7ac2f9da8c2617a4fdd15004b4601015.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-597958c53c93a607afca12fd375c57ed.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f20fda0d586aae35f34e9d1db767c6bf.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-0df3fcf739b8a8f11d64fcee4b5f352d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-f20fda0d586aae35f34e9d1db767c6bf.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chap_02/containers_01.html">Data Processing</a></li><li class="breadcrumb-item"><a href="../chap_02/data_manipulation.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data manipulation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Introduction to R for Modellers</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mgh.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MGH module matters</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Language Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/get_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Get Started</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/operators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Operators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/control_flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Control Flows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/environments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Environments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_01/code_style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Coding Style</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercises_all_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exercises I</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/containers_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Homogeneous Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/containers_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Heterogeneous Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/data_manipulation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data manipulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/vis_base.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Visualisation I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/vis_ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualisation II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_02/work_w_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Working with files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercises_all_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exercises II</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Model Building</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_03/chap_07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Statistical Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_03/chap_08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Mathematical Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Further Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_03/chap_09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Performance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/wks_02_rnumbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Random Numbers and Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/wks_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Sensitivity analysis workflow</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chap_00/file_address_sys.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">File address system</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/00_know_your_computer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Know your computer</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#extraction" id="toc-extraction" class="nav-link active" data-scroll-target="#extraction"><span class="header-section-number">11.1</span> Extraction</a>
  <ul class="collapse">
  <li><a href="#operators" id="toc-operators" class="nav-link" data-scroll-target="#operators"><span class="header-section-number">11.1.1</span> Operators</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">11.1.2</span> <code>[</code>, <code>[[</code></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><span class="header-section-number">11.1.3</span> <code>$</code></a></li>
  <li><a href="#dynamic-name" id="toc-dynamic-name" class="nav-link" data-scroll-target="#dynamic-name"><span class="header-section-number">11.1.4</span> Dynamic name</a></li>
  <li><a href="#duplicated-names" id="toc-duplicated-names" class="nav-link" data-scroll-target="#duplicated-names"><span class="header-section-number">11.1.5</span> Duplicated names</a></li>
  </ul></li>
  <li><a href="#sequences" id="toc-sequences" class="nav-link" data-scroll-target="#sequences"><span class="header-section-number">11.2</span> Sequences</a>
  <ul class="collapse">
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"><span class="header-section-number">11.2.1</span> <code>:</code></a></li>
  <li><a href="#seq" id="toc-seq" class="nav-link" data-scroll-target="#seq"><span class="header-section-number">11.2.2</span> <code>seq</code></a></li>
  <li><a href="#seq_along" id="toc-seq_along" class="nav-link" data-scroll-target="#seq_along"><span class="header-section-number">11.2.3</span> <code>seq_along</code></a></li>
  <li><a href="#rep" id="toc-rep" class="nav-link" data-scroll-target="#rep"><span class="header-section-number">11.2.4</span> <code>rep</code></a></li>
  <li><a href="#expand.grid" id="toc-expand.grid" class="nav-link" data-scroll-target="#expand.grid"><span class="header-section-number">11.2.5</span> <code>expand.grid</code></a></li>
  <li><a href="#dates" id="toc-dates" class="nav-link" data-scroll-target="#dates"><span class="header-section-number">11.2.6</span> Dates</a></li>
  <li><a href="#random-sequences" id="toc-random-sequences" class="nav-link" data-scroll-target="#random-sequences"><span class="header-section-number">11.2.7</span> Random sequences</a></li>
  </ul></li>
  <li><a href="#sets" id="toc-sets" class="nav-link" data-scroll-target="#sets"><span class="header-section-number">11.3</span> Sets</a></li>
  <li><a href="#search" id="toc-search" class="nav-link" data-scroll-target="#search"><span class="header-section-number">11.4</span> Search</a>
  <ul class="collapse">
  <li><a href="#unique-duplicated" id="toc-unique-duplicated" class="nav-link" data-scroll-target="#unique-duplicated"><span class="header-section-number">11.4.1</span> <code>unique</code>, <code>duplicated</code></a></li>
  <li><a href="#match-in" id="toc-match-in" class="nav-link" data-scroll-target="#match-in"><span class="header-section-number">11.4.2</span> <code>match</code>, <code>%in%</code></a></li>
  <li><a href="#any-all" id="toc-any-all" class="nav-link" data-scroll-target="#any-all"><span class="header-section-number">11.4.3</span> <code>any</code>, <code>all</code></a></li>
  <li><a href="#which-arrayind" id="toc-which-arrayind" class="nav-link" data-scroll-target="#which-arrayind"><span class="header-section-number">11.4.4</span> <code>which</code>, <code>arrayInd</code></a></li>
  <li><a href="#sample" id="toc-sample" class="nav-link" data-scroll-target="#sample"><span class="header-section-number">11.4.5</span> <code>sample</code></a></li>
  </ul></li>
  <li><a href="#merge" id="toc-merge" class="nav-link" data-scroll-target="#merge"><span class="header-section-number">11.5</span> Merge</a>
  <ul class="collapse">
  <li><a href="#lookup" id="toc-lookup" class="nav-link" data-scroll-target="#lookup"><span class="header-section-number">11.5.1</span> Lookup</a></li>
  <li><a href="#match" id="toc-match" class="nav-link" data-scroll-target="#match"><span class="header-section-number">11.5.2</span> <code>match</code></a></li>
  <li><a href="#merge-1" id="toc-merge-1" class="nav-link" data-scroll-target="#merge-1"><span class="header-section-number">11.5.3</span> <code>merge</code></a></li>
  </ul></li>
  <li><a href="#built-in-datasets" id="toc-built-in-datasets" class="nav-link" data-scroll-target="#built-in-datasets"><span class="header-section-number">11.6</span> Built-in datasets</a>
  <ul class="collapse">
  <li><a href="#head-tail-summary" id="toc-head-tail-summary" class="nav-link" data-scroll-target="#head-tail-summary"><span class="header-section-number">11.6.1</span> <code>head</code>, <code>tail</code>, <code>summary</code></a></li>
  </ul></li>
  <li><a href="#reshape" id="toc-reshape" class="nav-link" data-scroll-target="#reshape"><span class="header-section-number">11.7</span> Reshape</a>
  <ul class="collapse">
  <li><a href="#reshape-1" id="toc-reshape-1" class="nav-link" data-scroll-target="#reshape-1"><span class="header-section-number">11.7.1</span> <code>reshape</code></a></li>
  <li><a href="#tidyr" id="toc-tidyr" class="nav-link" data-scroll-target="#tidyr"><span class="header-section-number">11.7.2</span> <code>tidyr</code></a></li>
  </ul></li>
  <li><a href="#aggregate" id="toc-aggregate" class="nav-link" data-scroll-target="#aggregate"><span class="header-section-number">11.8</span> Aggregate</a>
  <ul class="collapse">
  <li><a href="#aggregate-1" id="toc-aggregate-1" class="nav-link" data-scroll-target="#aggregate-1"><span class="header-section-number">11.8.1</span> <code>aggregate</code></a></li>
  <li><a href="#basic-stats-functions" id="toc-basic-stats-functions" class="nav-link" data-scroll-target="#basic-stats-functions"><span class="header-section-number">11.8.2</span> Basic stats functions</a></li>
  <li><a href="#expand" id="toc-expand" class="nav-link" data-scroll-target="#expand"><span class="header-section-number">11.8.3</span> Expand</a></li>
  </ul></li>
  <li><a href="#sorting" id="toc-sorting" class="nav-link" data-scroll-target="#sorting"><span class="header-section-number">11.9</span> Sorting</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/bg-intro-r/bg-intro-r.github.io" class="toc-action"><i class="bi bi-chat-right"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chap_02/containers_01.html">Data Processing</a></li><li class="breadcrumb-item"><a href="../chap_02/data_manipulation.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data manipulation</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data manipulation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Pre-requisites</strong></p>
<ul>
<li><p><code>double</code>, <code>integer</code>, <code>character</code>, <code>logical</code></p></li>
<li><p><code>c</code>, <code>length</code>, <code>typeof</code></p></li>
<li><p><code>as.logical</code>, <code>as.integer</code>, <code>as.double</code>, <code>as.character</code>, <code>as.numeric</code></p></li>
<li><p><code>is.atomic</code>, <code>is.logical</code>, <code>is.integer</code>, <code>is.double</code>, <code>is.character</code>, <code>is.numeric</code></p></li>
<li><p><code>is.infinite</code>, <code>is.nan</code>, <code>is.na</code>, <code>is.null</code></p></li>
<li><p><code>attr</code>, <code>names</code>, <code>setNames</code>, <code>[[]]</code>, <code>str</code></p></li>
<li><p><code>matrix</code>, <code>t</code>, <code>diag</code></p></li>
<li><p><code>dim</code>, <code>nrow</code>, <code>ncol</code>, <code>rownames</code>, <code>colnames</code>, <code>rbind</code>, <code>cbind</code>, <code>is.matrix</code></p></li>
<li><p><code>array</code>, <code>is.array</code></p></li>
<li><p><code>class</code></p></li>
<li><p><code>factor</code>, <code>gl</code>, <code>as.factor</code>, <code>table</code></p></li>
<li><p><code>as.Date</code>, <code>Sys.Date</code></p></li>
<li><p><code>list</code>, <code>is.list</code>, <code>as.list</code>, <code>unlist</code></p></li>
<li><p><code>apply</code>, <code>lapply</code>, <code>sapply</code></p></li>
<li><p>What is data manipulation / transformation</p></li>
</ul>
<p><img src="img/4_data.png" class="img-fluid"></p>
<ul>
<li>Recall the data structures we introduced in the previous session:</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/4_data_structures.png" class="img-fluid figure-img"></p>
<figcaption>data structures in R</figcaption>
</figure>
</div>
<p><strong>Outline</strong></p>
<ul>
<li>Extraction</li>
<li>Sequences</li>
<li>Sets</li>
<li>Search</li>
<li>Merge</li>
<li>Build-in datasets</li>
<li>Reshape</li>
<li>Aggregate</li>
<li>Sorting</li>
</ul>
<p><strong>Recommended readings:</strong></p>
<ul>
<li><a href="https://adv-r.hadley.nz/subsetting.html">Chapter 4, Advanced R, Hadley</a></li>
</ul>
<section id="extraction" class="level2 page-columns page-full" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="extraction"><span class="header-section-number">11.1</span> Extraction</h2>
<p>Extraction, also known as “subsetting” or “indexing”, is the first step of data manipulation. It refers to the step to specify a sub-section of the data structure to operate on.</p>
<section id="operators" class="level3" data-number="11.1.1">
<h3 data-number="11.1.1" class="anchored" data-anchor-id="operators"><span class="header-section-number">11.1.1</span> Operators</h3>
<p><strong><code>[</code>, <code>[[</code>, and <code>$</code></strong></p>
<p>Extraction operators act on vectors, matrices, arrays and lists to extract or replace parts of the data structure. Indexing can occur on the right-hand-side (RHS) of an expression for <strong>extraction</strong>, or on the left-hand-side (LHS) for <strong>replacement</strong>.</p>
<ul>
<li>There are three extraction operators, <code>[</code>, <code>[[</code>, and <code>$</code>. (see <code>?Extract</code>)</li>
<li><code>[</code> can select more than one element whereas the other two select a single element.</li>
<li><code>[</code> returns the same type</li>
<li>Extraction operators interact differently with different data structure.</li>
<li>For vector structures, we only need <code>[</code>.</li>
<li><code>[[</code> and <code>$</code> are only needed for list structures (recursive).</li>
<li><code>$</code> requires column names.</li>
<li>Partial matching is the default behaviour of <code>$</code>, whereas <code>[[</code> applies exact matching by default.</li>
<li>Values of different types may be used as indices.</li>
</ul>
</section>
<section id="section" class="level3 page-columns page-full" data-number="11.1.2">
<h3 data-number="11.1.2" class="anchored" data-anchor-id="section"><span class="header-section-number">11.1.2</span> <code>[</code>, <code>[[</code></h3>
<section id="from-vectors" class="level4 page-columns page-full" data-number="11.1.2.1">
<h4 data-number="11.1.2.1" class="anchored" data-anchor-id="from-vectors"><span class="header-section-number">11.1.2.1</span> from vectors</h4>
<p><strong>atomic vectors</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">22</span>, <span class="dv">33</span>, <span class="dv">44</span>, <span class="dv">55</span>, <span class="dv">10</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># different value types may be used as indices</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># 1. positive integers</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>a[<span class="dv">4</span>]</span>
<span id="cb1-6"><a href="#cb1-6"></a>a[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb1-7"><a href="#cb1-7"></a>a[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)]</span>
<span id="cb1-8"><a href="#cb1-8"></a>a[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)] <span class="co"># repeat the extracted element</span></span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a>a[<span class="fl">4.9</span>]        <span class="co"># implicit coercion</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>a[<span class="fl">1.2</span><span class="sc">:</span><span class="fl">3.2</span>]</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a>a[<span class="fu">length</span>(a)]  <span class="co"># last element</span></span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co"># 2. negative integers</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>a[<span class="sc">-</span><span class="dv">4</span>]</span>
<span id="cb1-17"><a href="#cb1-17"></a>a[<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">3</span>)]</span>
<span id="cb1-18"><a href="#cb1-18"></a>a[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>)]</span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co"># a[c(-4, 3)]</span></span>
<span id="cb1-20"><a href="#cb1-20"></a></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co"># 3. logical values</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>a[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)] <span class="co"># selector vector is of same size</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>a[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>)] <span class="co"># selector vector is shorter than data vector</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>a[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)]</span>
<span id="cb1-25"><a href="#cb1-25"></a>a[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)] <span class="co"># selector vector longer than data vector</span></span>
<span id="cb1-26"><a href="#cb1-26"></a>a <span class="sc">&gt;</span> <span class="dv">35</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>a[a <span class="sc">&gt;</span> <span class="dv">35</span>]</span>
<span id="cb1-28"><a href="#cb1-28"></a>a[a <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">&amp;</span> a <span class="sc">&lt;</span> <span class="dv">50</span>]</span>
<span id="cb1-29"><a href="#cb1-29"></a></span>
<span id="cb1-30"><a href="#cb1-30"></a>a[<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">NA</span>)]</span>
<span id="cb1-31"><a href="#cb1-31"></a></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="co"># 4. empty</span></span>
<span id="cb1-33"><a href="#cb1-33"></a>a[]</span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="fu">identical</span>(a, a[]) <span class="co"># remember that [ is just a function?</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>a[<span class="cn">NULL</span>]</span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="fu">typeof</span>(a[<span class="cn">NULL</span>])</span>
<span id="cb1-37"><a href="#cb1-37"></a>a[<span class="cn">NA</span>]</span>
<span id="cb1-38"><a href="#cb1-38"></a></span>
<span id="cb1-39"><a href="#cb1-39"></a><span class="co"># 5. zero</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>a[<span class="dv">0</span>]</span>
<span id="cb1-41"><a href="#cb1-41"></a>a[<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)]</span>
<span id="cb1-42"><a href="#cb1-42"></a></span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="co"># 6. characters</span></span>
<span id="cb1-44"><a href="#cb1-44"></a>b <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">22</span>, <span class="dv">33</span>), letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) <span class="co"># named vector</span></span>
<span id="cb1-45"><a href="#cb1-45"></a>b[<span class="st">"a"</span>]</span>
<span id="cb1-46"><a href="#cb1-46"></a>b[<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code>[[</code> is not very useful for vectors.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">identical</span>(a[[<span class="dv">1</span>]], a[<span class="dv">1</span>])</span>
<span id="cb2-2"><a href="#cb2-2"></a>a[[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]] <span class="co">#?</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>matrix</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">22</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>m</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># single element</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>m[<span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># multiple elements</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>m[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">3</span>]   <span class="co"># vector</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>m[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="co"># matrix</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Remember that matrices are just vectors with attributes, so you can index it with vectors. Note the difference a comma makes:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>m[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb4-2"><a href="#cb4-2"></a>m[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,]</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a>m[<span class="dv">2</span>]</span>
<span id="cb4-5"><a href="#cb4-5"></a>m[<span class="dv">2</span>, ]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/4_comma.png" class="img-fluid figure-img"></p>
<figcaption><a href="http://blogs.chatham.edu/professionalwritingprogram/2017/06/29/lets-eat-grandma/">image source</a></figcaption>
</figure>
</div>
</div></div><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># with logical vectors</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>m[m <span class="sc">&gt;</span> <span class="dv">5</span>]</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co"># with names character</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="fu">colnames</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"col1"</span>, <span class="st">"col2"</span>, <span class="st">"col3"</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>m[<span class="dv">2</span>, <span class="fu">c</span>(<span class="st">"col1"</span>, <span class="st">"col3"</span>)]</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="fu">typeof</span>(m[<span class="dv">2</span>, <span class="fu">c</span>(<span class="st">"col1"</span>, <span class="st">"col3"</span>)])</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a>m[]</span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="fu">identical</span>(m, m[])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Again, <code>[[</code> is not very useful for matrices (which are vectors).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>m[[<span class="dv">1</span>]]</span>
<span id="cb6-2"><a href="#cb6-2"></a>m[[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]] <span class="co"># ?</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="from-lists" class="level4" data-number="11.1.2.2">
<h4 data-number="11.1.2.2" class="anchored" data-anchor-id="from-lists"><span class="header-section-number">11.1.2.2</span> from lists</h4>
<p><strong>lists</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>l <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="fu">c</span>(<span class="fl">1.4</span>, <span class="fl">3.1</span>, <span class="fl">6.4</span>, <span class="fl">6.2</span>))</span>
<span id="cb7-2"><a href="#cb7-2"></a>l[<span class="dv">1</span>] <span class="co"># returns a list</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>l[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb7-4"><a href="#cb7-4"></a>l[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="fu">identical</span>(l[<span class="sc">-</span><span class="dv">1</span>], l[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb7-6"><a href="#cb7-6"></a>l[<span class="dv">1</span>][<span class="dv">2</span>] <span class="co"># ?</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>To go deeper, use <code>[[</code>. (The clue is in the print.)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>l[[<span class="dv">1</span>]]     <span class="co"># [[ lets you go one level deeper</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>l[<span class="dv">1</span>]       <span class="co"># can you see the difference?</span></span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a>l[[<span class="dv">3</span>]]</span>
<span id="cb8-5"><a href="#cb8-5"></a>l[[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]]   <span class="co"># don't do this</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>l[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]     <span class="co"># this is what you wanted, probably</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>What about a list of lists?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>ll <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>), <span class="fu">list</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">24</span>), <span class="fu">list</span>(<span class="dv">31</span><span class="sc">:</span><span class="dv">34</span>))</span>
<span id="cb9-2"><a href="#cb9-2"></a>ll[<span class="dv">1</span>]</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="fu">length</span>(ll[<span class="dv">1</span>])</span>
<span id="cb9-4"><a href="#cb9-4"></a>ll[[<span class="dv">1</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/4_pepper.png" class="img-fluid figure-img"></p>
<figcaption>Each bag of pepper is a list. <a href="https://twitter.com/hadleywickham/status/643381054758363136/photo/1">image source</a></figcaption>
</figure>
</div>
<p>What about this? Can you point out where this is on the pepper photo?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>ll[[<span class="dv">1</span>]][[<span class="dv">1</span>]][<span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Data frame</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">y =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb11-2"><a href="#cb11-2"></a>df</span>
<span id="cb11-3"><a href="#cb11-3"></a>df[<span class="dv">1</span>]      <span class="co"># data frame</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>df[, <span class="dv">1</span>]    <span class="co"># character vector (comma matters)</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>df[<span class="dv">1</span>, ]    <span class="co"># data frame</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>df[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]  <span class="co"># data frame</span></span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a>df[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, ]  <span class="co"># data frame</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>df[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">2</span>] <span class="co"># character vector</span></span>
<span id="cb11-10"><a href="#cb11-10"></a></span>
<span id="cb11-11"><a href="#cb11-11"></a>df[, <span class="fu">c</span>(<span class="st">"y"</span>, <span class="st">"x"</span>, <span class="st">"x"</span>)] <span class="co"># reorder columns in data frame</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>df[, <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"x"</span>)]      <span class="co"># duplicate columns in data frame</span></span>
<span id="cb11-13"><a href="#cb11-13"></a>df[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>)]</span>
<span id="cb11-14"><a href="#cb11-14"></a></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co"># What is the difference between these pairs of statements:</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>df[<span class="dv">2</span>]</span>
<span id="cb11-17"><a href="#cb11-17"></a>df[[<span class="dv">2</span>]]</span>
<span id="cb11-18"><a href="#cb11-18"></a></span>
<span id="cb11-19"><a href="#cb11-19"></a>df[<span class="st">"y"</span>]</span>
<span id="cb11-20"><a href="#cb11-20"></a>df[[<span class="st">"y"</span>]]</span>
<span id="cb11-21"><a href="#cb11-21"></a></span>
<span id="cb11-22"><a href="#cb11-22"></a>df[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), ]</span>
<span id="cb11-23"><a href="#cb11-23"></a>df[, <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>)]</span>
<span id="cb11-24"><a href="#cb11-24"></a>df[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>)]</span>
<span id="cb11-25"><a href="#cb11-25"></a>df[df[, <span class="st">"x"</span>] <span class="sc">&gt;</span> <span class="dv">5</span>, ]</span>
<span id="cb11-26"><a href="#cb11-26"></a></span>
<span id="cb11-27"><a href="#cb11-27"></a>df[df[, <span class="st">"x"</span>] <span class="sc">&gt;</span> <span class="dv">5</span>, ]</span>
<span id="cb11-28"><a href="#cb11-28"></a>df[df[[<span class="st">"x"</span>]] <span class="sc">&gt;</span> <span class="dv">5</span>, ]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="section-1" class="level3" data-number="11.1.3">
<h3 data-number="11.1.3" class="anchored" data-anchor-id="section-1"><span class="header-section-number">11.1.3</span> <code>$</code></h3>
<ul>
<li><code>$</code> is not valid for vectors</li>
<li><code>$</code> precedes column names of lists</li>
</ul>
<blockquote class="blockquote">
<p><code>?Extract</code> - Both <code>[[</code> and <code>$</code> select a single element of the list. The main difference is that <code>$</code> does not allow computed indices (see <a href="#dynamic-name">Dynamic name</a>), whereas <code>[[</code> does. <code>x$name</code> is equivalent to <code>x[["name", exact = FALSE]]</code>. Also, the partial matching behavior of <code>[[</code> can be controlled using the exact argument.</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># $ is not useful for vectors</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">colnames</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a>m</span>
<span id="cb12-5"><a href="#cb12-5"></a>m[<span class="st">"a"</span>]</span>
<span id="cb12-6"><a href="#cb12-6"></a>m[, <span class="st">"a"</span>]</span>
<span id="cb12-7"><a href="#cb12-7"></a>m<span class="sc">$</span><span class="st">"a"</span></span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">initial =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb12-10"><a href="#cb12-10"></a></span>
<span id="cb12-11"><a href="#cb12-11"></a>df[<span class="st">"age"</span>]</span>
<span id="cb12-12"><a href="#cb12-12"></a>df[[<span class="st">"age"</span>]]</span>
<span id="cb12-13"><a href="#cb12-13"></a>df<span class="sc">$</span>age</span>
<span id="cb12-14"><a href="#cb12-14"></a>df<span class="sc">$</span><span class="st">"age"</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>df<span class="sc">$</span><span class="st">`</span><span class="at">age</span><span class="st">`</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>df<span class="sc">$</span><span class="st">'age'</span></span>
<span id="cb12-17"><a href="#cb12-17"></a></span>
<span id="cb12-18"><a href="#cb12-18"></a>df<span class="sc">$</span>a</span>
<span id="cb12-19"><a href="#cb12-19"></a>df<span class="sc">$</span><span class="st">"a"</span></span>
<span id="cb12-20"><a href="#cb12-20"></a>df<span class="sc">$</span><span class="st">'a'</span></span>
<span id="cb12-21"><a href="#cb12-21"></a>df<span class="sc">$</span><span class="st">`</span><span class="at">a</span><span class="st">`</span></span>
<span id="cb12-22"><a href="#cb12-22"></a></span>
<span id="cb12-23"><a href="#cb12-23"></a>df[[<span class="st">"a"</span>]]</span>
<span id="cb12-24"><a href="#cb12-24"></a></span>
<span id="cb12-25"><a href="#cb12-25"></a><span class="co"># what if both column names start with "a"</span></span>
<span id="cb12-26"><a href="#cb12-26"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">account =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb12-27"><a href="#cb12-27"></a></span>
<span id="cb12-28"><a href="#cb12-28"></a>df2<span class="sc">$</span>a</span>
<span id="cb12-29"><a href="#cb12-29"></a>df2<span class="sc">$</span>g</span>
<span id="cb12-30"><a href="#cb12-30"></a>df2<span class="sc">$</span>ag</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="dynamic-name" class="level3" data-number="11.1.4">
<h3 data-number="11.1.4" class="anchored" data-anchor-id="dynamic-name"><span class="header-section-number">11.1.4</span> Dynamic name</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">initial =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb13-2"><a href="#cb13-2"></a>df<span class="sc">$</span>age <span class="co"># we know this works</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>df<span class="sc">$</span>a   <span class="co"># this also works</span></span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># What if the name of the wanted column is in a variable?</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>wanted_col <span class="ot">&lt;-</span> <span class="st">"a"</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>df<span class="sc">$</span>wanted_col <span class="co"># would this work?</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co"># if it does, why does df$age work?</span></span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a>df[[wanted_col]] <span class="co"># would this work?</span></span>
<span id="cb13-11"><a href="#cb13-11"></a></span>
<span id="cb13-12"><a href="#cb13-12"></a>wanted_col <span class="ot">&lt;-</span> <span class="st">"age"</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>df[[wanted_col]] <span class="co"># feel better now?</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Remember “<strong>Everything that happens in R is a function call</strong>”.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="st">`</span><span class="at">$</span><span class="st">`</span>(df, a)           <span class="co"># works</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">`</span><span class="at">$</span><span class="st">`</span>(df, <span class="st">"a"</span>)         <span class="co"># works</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="st">`</span><span class="at">$</span><span class="st">`</span>(df, wanted_col)  <span class="co"># doesn't work</span></span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="st">`</span><span class="at">[[</span><span class="st">`</span>(df, wanted_col) <span class="co"># works</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="st">`</span><span class="at">[[</span><span class="st">`</span>(df, <span class="st">"age"</span>)      <span class="co"># works</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="st">`</span><span class="at">[[</span><span class="st">`</span>(df, age)        <span class="co"># doesn't work</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Compare the comment for <code>$</code> and <code>[[</code>. How do they each handle the second argument?</p>
<p><a href="https://github.com/wch/r-source/blob/trunk/src/main/subset.c#L1204-L1207">R source code on <code>$</code></a>:</p>
<pre><code>/* The $ subset operator.
   We need to be sure to only evaluate the first argument.
   The second will be a symbol that needs to be matched, not evaluated.
*/</code></pre>
<p><a href="https://github.com/wch/r-source/blob/87eebf48903a7dfa07f477cdb904eb83bb76510b/src/main/subset.c#L893-L894">R source code on <code>[[</code></a>:</p>
<pre><code>/* The [[ subset operator.  It needs to be fast. */
/* The arguments to this call are evaluated on entry. */</code></pre>
</section>
<section id="duplicated-names" class="level3" data-number="11.1.5">
<h3 data-number="11.1.5" class="anchored" data-anchor-id="duplicated-names"><span class="header-section-number">11.1.5</span> Duplicated names</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">13</span>, <span class="at">y =</span> letters[<span class="dv">11</span><span class="sc">:</span><span class="dv">13</span>])</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"r1"</span>, <span class="st">"r2"</span>, <span class="st">"r3"</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># double the rows</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>df_rdbl <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df, df)</span>
<span id="cb17-6"><a href="#cb17-6"></a>df_rdbl</span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="fu">rownames</span>(df_rdbl) <span class="co"># row names are not duplicated</span></span>
<span id="cb17-8"><a href="#cb17-8"></a></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co"># double the columns</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>df_cdbl <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df, df)</span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="fu">names</span>(df_cdbl)    <span class="co"># column names are duplicated</span></span>
<span id="cb17-12"><a href="#cb17-12"></a></span>
<span id="cb17-13"><a href="#cb17-13"></a>df3 <span class="ot">&lt;-</span> df_cdbl[<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="fu">names</span>(df3)        <span class="co"># further operation distinguishes the duplicated columns</span></span>
<span id="cb17-15"><a href="#cb17-15"></a></span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="fu">duplicated</span>(<span class="fu">names</span>(df_cdbl))</span>
<span id="cb17-17"><a href="#cb17-17"></a>df_cdbl[<span class="sc">!</span><span class="fu">duplicated</span>(<span class="fu">names</span>(df_cdbl))] <span class="co"># extract only the not duplicated columns</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<blockquote class="blockquote">
<p>Type <code>?subset</code> and you will see that there is a built-in function called <code>subset</code> in R. Do you think we should include it in the lecture and why?</p>
</blockquote>
</section>
</section>
<section id="sequences" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="sequences"><span class="header-section-number">11.2</span> Sequences</h2>
<p>From the previous section, we see that sequences of numbers are useful for specifying a section of a data structure. In this section, we take a look at different ways to generate sequences of values.</p>
<section id="section-2" class="level3" data-number="11.2.1">
<h3 data-number="11.2.1" class="anchored" data-anchor-id="section-2"><span class="header-section-number">11.2.1</span> <code>:</code></h3>
<p>The colon (<code>:</code>) operator is a quick way to generate a sequence of numbers. Recall that we also used it to control for loops:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>IsLeapYear <span class="ot">&lt;-</span> <span class="cf">function</span> (x) {</span>
<span id="cb18-2"><a href="#cb18-2"></a>    <span class="fu">return</span> (x <span class="sc">%%</span> <span class="dv">400</span> <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> (x <span class="sc">%%</span> <span class="dv">4</span> <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">!=</span> <span class="dv">0</span>))</span>
<span id="cb18-3"><a href="#cb18-3"></a>}</span>
<span id="cb18-4"><a href="#cb18-4"></a>PrintLeapYearsBetween <span class="ot">&lt;-</span> <span class="cf">function</span> (from_year, to_year) {</span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="cf">for</span> (year <span class="cf">in</span> from_year <span class="sc">:</span> to_year) {</span>
<span id="cb18-6"><a href="#cb18-6"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">IsLeapYear</span>(year)) {</span>
<span id="cb18-7"><a href="#cb18-7"></a>      <span class="cf">next</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>    }</span>
<span id="cb18-9"><a href="#cb18-9"></a>    <span class="fu">print</span>(year)</span>
<span id="cb18-10"><a href="#cb18-10"></a>  }</span>
<span id="cb18-11"><a href="#cb18-11"></a>}</span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="fu">PrintLeapYearsBetween</span>(<span class="dv">1990</span>, <span class="dv">2018</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>And that integers are the default type returned by <code>:</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">typeof</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="co"># the `:` operator generate a range of integer values</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>You can also generate a sequence of <code>double</code>s:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># </span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fl">1.5</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="fl">1.5</span><span class="sc">:</span><span class="fl">10.5</span></span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co"># note the difference</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="fu">typeof</span>(<span class="fl">1.5</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="fu">typeof</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">10.5</span>)</span>
<span id="cb20-8"><a href="#cb20-8"></a></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co"># and implicit coercion happens</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>a <span class="ot">&lt;-</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb20-11"><a href="#cb20-11"></a>a[<span class="fl">1.5</span><span class="sc">:</span><span class="fl">3.5</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>What if we swap the bigger value to the LHS?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="dv">10</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="fl">10.6</span><span class="sc">:-</span><span class="fl">1.1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code>:</code> returns a specific type of sequence of numbers that are 1 apart in numeric value. What if we want the interval to be more than 1?</p>
</section>
<section id="seq" class="level3" data-number="11.2.2">
<h3 data-number="11.2.2" class="anchored" data-anchor-id="seq"><span class="header-section-number">11.2.2</span> <code>seq</code></h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># well, you can always do this</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co"># but seriously, let's leave the maths to the computer</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co"># and do this in a safer manner with `seq`</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">20</span>, <span class="at">to =</span> <span class="dv">0</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co">#?</span></span>
<span id="cb22-8"><a href="#cb22-8"></a></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">20.5</span>, <span class="at">to =</span> <span class="sc">-</span><span class="fl">5.30</span>, <span class="at">by =</span> <span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb22-10"><a href="#cb22-10"></a></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">1.6</span>, <span class="at">to =</span> <span class="fl">2.8</span>, <span class="at">length.out =</span> <span class="dv">14</span>)</span>
<span id="cb22-12"><a href="#cb22-12"></a></span>
<span id="cb22-13"><a href="#cb22-13"></a><span class="co"># sequence of length</span></span>
<span id="cb22-14"><a href="#cb22-14"></a><span class="fu">seq_len</span>(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li><code>seq</code> is a generalised version of <code>:</code>.</li>
<li><code>seq_along</code> is the preferred method where possible.</li>
</ul>
<hr>
</section>
<section id="seq_along" class="level3" data-number="11.2.3">
<h3 data-number="11.2.3" class="anchored" data-anchor-id="seq_along"><span class="header-section-number">11.2.3</span> <code>seq_along</code></h3>
<p>It is common to want to iterate through a data structure and perform a set of operations on each of its elements with a for loop. In which case we need to define a sequence to represent the indices of that structure. There are many ways to generate this sequence and we give a comparison between these methods and demonstrate why <code>seq_along</code> is the safest way to generate this sequence.</p>
<p><span class="quote-emph"><strong><code>seq_along</code> is the function to use when you want to iterate a structure with a for loop</strong></span></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># Assuming v0, v1, v2, v3 are the vectors you want to iterate over</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>v3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">11.1</span>, <span class="sc">-</span><span class="fl">22.2</span>, <span class="sc">-</span><span class="fl">33.3</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a>v2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">11.1</span>, <span class="sc">-</span><span class="fl">22.2</span>)</span>
<span id="cb23-4"><a href="#cb23-4"></a>v1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">11.1</span>)</span>
<span id="cb23-5"><a href="#cb23-5"></a>v0 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb23-6"><a href="#cb23-6"></a></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co"># Three versions of looping over the vector</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>print_all_seq_along <span class="ot">&lt;-</span> <span class="cf">function</span>(vv) {</span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="cf">for</span> (ii <span class="cf">in</span> <span class="fu">seq_along</span>(vv)) {</span>
<span id="cb23-10"><a href="#cb23-10"></a>    <span class="fu">print</span>(vv[ii])</span>
<span id="cb23-11"><a href="#cb23-11"></a>  }</span>
<span id="cb23-12"><a href="#cb23-12"></a>}</span>
<span id="cb23-13"><a href="#cb23-13"></a></span>
<span id="cb23-14"><a href="#cb23-14"></a>print_all_seq <span class="ot">&lt;-</span> <span class="cf">function</span>(vv) {</span>
<span id="cb23-15"><a href="#cb23-15"></a>  <span class="cf">for</span> (ii <span class="cf">in</span> <span class="fu">seq</span>(vv)) {</span>
<span id="cb23-16"><a href="#cb23-16"></a>    <span class="fu">print</span>(vv[ii])</span>
<span id="cb23-17"><a href="#cb23-17"></a>  }</span>
<span id="cb23-18"><a href="#cb23-18"></a>}</span>
<span id="cb23-19"><a href="#cb23-19"></a></span>
<span id="cb23-20"><a href="#cb23-20"></a>print_all_length <span class="ot">&lt;-</span> <span class="cf">function</span>(vv) {</span>
<span id="cb23-21"><a href="#cb23-21"></a>  <span class="cf">for</span> (ii <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(vv)) {</span>
<span id="cb23-22"><a href="#cb23-22"></a>    <span class="fu">print</span>(vv[ii])</span>
<span id="cb23-23"><a href="#cb23-23"></a>  }</span>
<span id="cb23-24"><a href="#cb23-24"></a>}</span>
<span id="cb23-25"><a href="#cb23-25"></a></span>
<span id="cb23-26"><a href="#cb23-26"></a><span class="co"># when this vector of at least length 2</span></span>
<span id="cb23-27"><a href="#cb23-27"></a><span class="fu">print_all_seq_along</span>(v3) <span class="co"># works</span></span>
<span id="cb23-28"><a href="#cb23-28"></a><span class="fu">print_all_seq</span>(v3)       <span class="co"># works</span></span>
<span id="cb23-29"><a href="#cb23-29"></a><span class="fu">print_all_length</span>(v3)    <span class="co"># works</span></span>
<span id="cb23-30"><a href="#cb23-30"></a></span>
<span id="cb23-31"><a href="#cb23-31"></a><span class="co"># vector is of length 1</span></span>
<span id="cb23-32"><a href="#cb23-32"></a><span class="fu">print_all_seq_along</span>(v1) <span class="co"># works</span></span>
<span id="cb23-33"><a href="#cb23-33"></a><span class="fu">print_all_seq</span>(v1)       <span class="co"># ?</span></span>
<span id="cb23-34"><a href="#cb23-34"></a><span class="fu">print_all_length</span>(v1)    <span class="co"># works </span></span>
<span id="cb23-35"><a href="#cb23-35"></a></span>
<span id="cb23-36"><a href="#cb23-36"></a><span class="co"># vector is empty</span></span>
<span id="cb23-37"><a href="#cb23-37"></a><span class="fu">print_all_seq_along</span>(v0) <span class="co"># works</span></span>
<span id="cb23-38"><a href="#cb23-38"></a><span class="fu">print_all_seq</span>(v0)       <span class="co"># works</span></span>
<span id="cb23-39"><a href="#cb23-39"></a><span class="fu">print_all_length</span>(v0)    <span class="co"># ?</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="rep" class="level3" data-number="11.2.4">
<h3 data-number="11.2.4" class="anchored" data-anchor-id="rep"><span class="header-section-number">11.2.4</span> <code>rep</code></h3>
<p><code>rep</code> (replicate) is another useful function to generate sequences of certain patterns.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># replicate one value</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="fu">rep</span>(<span class="cn">TRUE</span>, <span class="dv">10</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co"># replicate a vector</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co"># replicate per element</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each =</span> <span class="dv">2</span>)</span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb24-8"><a href="#cb24-8"></a></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="expand.grid" class="level3" data-number="11.2.5">
<h3 data-number="11.2.5" class="anchored" data-anchor-id="expand.grid"><span class="header-section-number">11.2.5</span> <code>expand.grid</code></h3>
<p>Generate pairs of values from two sets of values, with all combinations of value pairs.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">expand.grid</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">y =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="dates" class="level3" data-number="11.2.6">
<h3 data-number="11.2.6" class="anchored" data-anchor-id="dates"><span class="header-section-number">11.2.6</span> Dates</h3>
<p>To create a sequence of dates</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># know the start date and the length of the sequence</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>d <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-02-25"</span>, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a>d <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb26-4"><a href="#cb26-4"></a></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co"># know start date and end date</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>d1 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-02-25"</span>, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb26-7"><a href="#cb26-7"></a>d2 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-03-25"</span>, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb26-8"><a href="#cb26-8"></a>d1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span>(d2 <span class="sc">-</span> d1)</span>
<span id="cb26-9"><a href="#cb26-9"></a></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co"># with seq</span></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="fu">seq</span>(d1, d2, <span class="at">by =</span> <span class="st">"days"</span>)</span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="fu">seq</span>(d1, d2, <span class="at">by =</span> <span class="st">"2 days"</span>)</span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="fu">seq</span>(d1, d2 <span class="sc">+</span> <span class="dv">365</span> <span class="sc">*</span> <span class="dv">3</span>, <span class="at">by =</span> <span class="st">"years"</span>)</span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="fu">seq</span>(d1, d2 <span class="sc">+</span> <span class="dv">365</span> <span class="sc">*</span> <span class="dv">3</span>, <span class="at">by =</span> <span class="st">"quarter"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>It is worth noting the <a href="https://rawgit.com/rstudio/cheatsheets/master/lubridate.pdf"><code>lubridate</code></a> package which provides a more intuitive way to define dates and times.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">"2020-02-25"</span>), <span class="fu">ymd</span>(<span class="st">"2020-03-25"</span>), <span class="at">by =</span> <span class="st">"2 days"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="random-sequences" class="level3" data-number="11.2.7">
<h3 data-number="11.2.7" class="anchored" data-anchor-id="random-sequences"><span class="header-section-number">11.2.7</span> Random sequences</h3>
<section id="runif-and-rnorm" class="level4" data-number="11.2.7.1">
<h4 data-number="11.2.7.1" class="anchored" data-anchor-id="runif-and-rnorm"><span class="header-section-number">11.2.7.1</span> <code>runif</code> and <code>rnorm</code></h4>
<ul>
<li><code>runif(n, min = 0, max = 1)</code>, get <code>n</code> random numbers <strong>uniformly-distributed</strong> between <code>min</code> and <code>max</code> (<code>runif</code> will not generate either of the extreme values unless max == min or max-min is small compared to min)</li>
<li><code>rnorm(n, mean = 0, sd = 1)</code>, get <code>n</code> random numbers <strong>normally-distributed</strong> around <code>mean</code></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">runif</span>(<span class="dv">10</span>) <span class="co"># 10 random numbers between `0` and `1`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">runif</span>(n), <span class="at">y =</span> <span class="fu">rnorm</span>(n), <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_manipulation_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="reproducibility" class="level4" data-number="11.2.7.2">
<h4 data-number="11.2.7.2" class="anchored" data-anchor-id="reproducibility"><span class="header-section-number">11.2.7.2</span> Reproducibility</h4>
<p><strong>seed</strong> - <code>?.Random.seed</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>); <span class="fu">runif</span>(<span class="dv">10</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">set.seed</span>(<span class="dv">1</span>); <span class="fu">runif</span>(<span class="dv">10</span>) <span class="co"># reset seed and same sequence of random number is generated </span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="distributions" class="level4" data-number="11.2.7.3">
<h4 data-number="11.2.7.3" class="anchored" data-anchor-id="distributions"><span class="header-section-number">11.2.7.3</span> Distributions</h4>
<p>Details of these functions will be covered in the Mathematics and Statistics module later in the term.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Distribution</th>
<th style="text-align: center;">Random numbers</th>
<th style="text-align: center;">Probability density function (PDF)</th>
<th style="text-align: center;">Cumulative Distribution function (CDF)</th>
<th style="text-align: center;">Quantile function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Uniform</td>
<td style="text-align: center;"><code>runif</code></td>
<td style="text-align: center;"><code>dunif</code></td>
<td style="text-align: center;"><code>punif</code></td>
<td style="text-align: center;"><code>qunif</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Normal</td>
<td style="text-align: center;"><code>rnorm</code></td>
<td style="text-align: center;"><code>dnorm</code></td>
<td style="text-align: center;"><code>pnorm</code></td>
<td style="text-align: center;"><code>qnorm</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Poisson</td>
<td style="text-align: center;"><code>rpois</code></td>
<td style="text-align: center;"><code>dpois</code></td>
<td style="text-align: center;"><code>ppois</code></td>
<td style="text-align: center;"><code>qpois</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Binomial</td>
<td style="text-align: center;"><code>rbinom</code></td>
<td style="text-align: center;"><code>dbinom</code></td>
<td style="text-align: center;"><code>pbinom</code></td>
<td style="text-align: center;"><code>qbinom</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exponential</td>
<td style="text-align: center;"><code>rexp</code></td>
<td style="text-align: center;"><code>dexp</code></td>
<td style="text-align: center;"><code>pexp</code></td>
<td style="text-align: center;"><code>qexp</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Gamma</td>
<td style="text-align: center;"><code>rgamma</code></td>
<td style="text-align: center;"><code>dgamma</code></td>
<td style="text-align: center;"><code>pgamma</code></td>
<td style="text-align: center;"><code>qgamma</code></td>
</tr>
</tbody>
</table>
<p>See <code>?Distributions</code> for more details.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/8_distributions.png" class="img-fluid figure-img"></p>
<figcaption>Probability distributions<a href="http://commons.apache.org/proper/commons-math/userguide/distribution.html">image source</a></figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="sets" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="sets"><span class="header-section-number">11.3</span> Sets</h2>
<p>In this section, we take a look at when two groups of values are involved in the operation.</p>
<p><strong>Basic set operations</strong></p>
<p>A key property of sets, as compared to vectors, is that it does not contain duplicated values. R has a set of functions to perform basic set operations.</p>
<blockquote class="blockquote">
<p><code>?union</code> - Performs set union, intersection, (asymmetric!) difference, equality and membership on two vectors. Each of <code>union</code>, <code>intersect</code>, <code>setdiff</code> and <code>setequal</code> will discard any duplicated values in the arguments, and they apply <code>as.vector</code> to their arguments (and so in particular coerce factors to character vectors).</p>
</blockquote>
<p>Illustrated below are two sets <code>s1</code> and <code>s2</code>. Each set has 5 elements. Both sets contain numbers 3, 4, and 5.</p>
<p><img src="img/4_sets.png" class="img-fluid"></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>s1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>s2 <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="cb31-3"><a href="#cb31-3"></a></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="fu">union</span>(s1, s2)</span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="fu">intersect</span>(s1, s2)</span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="fu">setdiff</span>(s1, s2)</span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="fu">setdiff</span>(s2, s1)</span>
<span id="cb31-8"><a href="#cb31-8"></a></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="fu">setequal</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="fu">setequal</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb31-11"><a href="#cb31-11"></a></span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="fu">is.element</span>(<span class="dv">5</span>, s1)</span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="fu">is.element</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">7</span>), s1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="search" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="search"><span class="header-section-number">11.4</span> Search</h2>
<p>Let’s take a closer look at <code>intersect</code>. (Typing the function name on the console returns the implementation of the function, just like a variable).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>intersect</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (x, y) 
{
    if (is.null(x) || is.null(y)) 
        return(NULL)
    if (.set_ops_need_as_vector(x, y)) {
        x &lt;- as.vector(x)
        y &lt;- as.vector(y)
    }
    x &lt;- unique(x)
    names(x) &lt;- NULL
    y &lt;- unique(y)
    names(y) &lt;- NULL
    c(x[match(x, y, 0L) &gt; 0L], y[0L])
}
&lt;bytecode: 0x114ecff60&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
</div>
<p>We see two other functions <code>unique</code> and <code>match</code> are used to achieve <code>intersect</code>.</p>
<section id="unique-duplicated" class="level3" data-number="11.4.1">
<h3 data-number="11.4.1" class="anchored" data-anchor-id="unique-duplicated"><span class="header-section-number">11.4.1</span> <code>unique</code>, <code>duplicated</code></h3>
<blockquote class="blockquote">
<p><code>?unique</code> - returns a vector, data frame or array like the input but with duplicate elements/rows removed.</p>
</blockquote>
<blockquote class="blockquote">
<p><code>?duplicated</code> - determines which elements of a vector or data frame are duplicates of elements with smaller subscripts, and returns a logical vector indicating which elements (rows) are duplicates.</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">unique</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="cn">NULL</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>))</span>
<span id="cb34-2"><a href="#cb34-2"></a></span>
<span id="cb34-3"><a href="#cb34-3"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="fu">duplicated</span>(x)</span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="fu">duplicated</span>(x, <span class="at">fromLast =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-6"><a href="#cb34-6"></a></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="fu">duplicated</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>))</span>
<span id="cb34-8"><a href="#cb34-8"></a></span>
<span id="cb34-9"><a href="#cb34-9"></a><span class="co"># multiple columns</span></span>
<span id="cb34-10"><a href="#cb34-10"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb34-11"><a href="#cb34-11"></a>df</span>
<span id="cb34-12"><a href="#cb34-12"></a><span class="fu">duplicated</span>(df[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb34-13"><a href="#cb34-13"></a></span>
<span id="cb34-14"><a href="#cb34-14"></a><span class="fu">anyDuplicated</span>(df[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="match-in" class="level3" data-number="11.4.2">
<h3 data-number="11.4.2" class="anchored" data-anchor-id="match-in"><span class="header-section-number">11.4.2</span> <code>match</code>, <code>%in%</code></h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">match</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">10</span>), <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="cn">NA</span>, <span class="cn">NaN</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code>match</code> is similar to <code>is.element</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">match</span>(<span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">is.element</span>(<span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="co"># the %in% operator is identical to `is.element`.</span></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="co"># `?match` - `%in%` is a more intuitive interface as a binary operator, which returns a logical vector indicating if there is a match or not for its left operand.</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="dv">3</span> <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="dv">9</span><span class="sc">:</span><span class="dv">11</span> <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="any-all" class="level3" data-number="11.4.3">
<h3 data-number="11.4.3" class="anchored" data-anchor-id="any-all"><span class="header-section-number">11.4.3</span> <code>any</code>, <code>all</code></h3>
<p><code>any</code> and <code>all</code> search for <code>TRUE</code> values in the given structure, and they can be used to summarise the result from <code>is.element</code> or <code>%in%</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>s1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>s2 <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="cb37-3"><a href="#cb37-3"></a></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="fu">any</span>(<span class="fu">is.element</span>(s1, s2))</span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="fu">all</span>(<span class="fu">is.element</span>(s1, s2))</span>
<span id="cb37-6"><a href="#cb37-6"></a></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="fu">any</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="st">"a"</span>, <span class="st">"bc"</span>) <span class="sc">%in%</span> letters)</span>
<span id="cb37-8"><a href="#cb37-8"></a><span class="fu">any</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="st">"a"</span>, <span class="st">"bc"</span>) <span class="sc">%in%</span> LETTERS)</span>
<span id="cb37-9"><a href="#cb37-9"></a><span class="fu">all</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="st">"a"</span>, <span class="st">"bc"</span>) <span class="sc">%in%</span> letters)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="which-arrayind" class="level3" data-number="11.4.4">
<h3 data-number="11.4.4" class="anchored" data-anchor-id="which-arrayind"><span class="header-section-number">11.4.4</span> <code>which</code>, <code>arrayInd</code></h3>
<p><code>which</code> is similar to <code>match</code>, but the condition is not restricted to equality:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">which</span>(LETTERS <span class="sc">==</span> <span class="st">"E"</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="fu">which</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb38-3"><a href="#cb38-3"></a></span>
<span id="cb38-4"><a href="#cb38-4"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">7</span>)</span>
<span id="cb38-5"><a href="#cb38-5"></a></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="fu">which.min</span>(v)</span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="fu">which.max</span>(v)</span>
<span id="cb38-8"><a href="#cb38-8"></a></span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="co"># ?which.min - If this extremum is unique (or empty), the results are the same as (but more efficient than)</span></span>
<span id="cb38-10"><a href="#cb38-10"></a><span class="co">#              which(x == min(x, na.rm = TRUE)) or which(x == max(x, na.rm = TRUE)) respectively.</span></span>
<span id="cb38-11"><a href="#cb38-11"></a></span>
<span id="cb38-12"><a href="#cb38-12"></a><span class="co"># what happens when the min / max is not unique?</span></span>
<span id="cb38-13"><a href="#cb38-13"></a><span class="fu">which.min</span>(<span class="fu">c</span>(v, <span class="dv">2</span>))</span>
<span id="cb38-14"><a href="#cb38-14"></a><span class="fu">which.max</span>(<span class="fu">c</span>(<span class="dv">7</span>, v))</span>
<span id="cb38-15"><a href="#cb38-15"></a></span>
<span id="cb38-16"><a href="#cb38-16"></a><span class="co"># what about matrices</span></span>
<span id="cb38-17"><a href="#cb38-17"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb38-18"><a href="#cb38-18"></a><span class="fu">which.max</span>(m)</span>
<span id="cb38-19"><a href="#cb38-19"></a><span class="co"># how to get the indecies?</span></span>
<span id="cb38-20"><a href="#cb38-20"></a><span class="co"># 1. with which</span></span>
<span id="cb38-21"><a href="#cb38-21"></a><span class="fu">which</span>(m <span class="sc">==</span> <span class="fu">max</span>(m), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-22"><a href="#cb38-22"></a><span class="co"># 2. with arrayInd</span></span>
<span id="cb38-23"><a href="#cb38-23"></a><span class="fu">arrayInd</span>(<span class="fu">which.max</span>(m), <span class="fu">dim</span>(m))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="sample" class="level3" data-number="11.4.5">
<h3 data-number="11.4.5" class="anchored" data-anchor-id="sample"><span class="header-section-number">11.4.5</span> <code>sample</code></h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">11</span>) <span class="co">#?</span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="merge" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="merge"><span class="header-section-number">11.5</span> Merge</h2>
<p><strong>Lookup</strong></p>
<p>One of the most frequently used functions in Excel is the <code>vlookup</code> function.</p>
<p><img src="img/4_vlookup.png" class="img-fluid"></p>
<p>How do we do this in R?</p>
<section id="lookup" class="level3" data-number="11.5.1">
<h3 data-number="11.5.1" class="anchored" data-anchor-id="lookup"><span class="header-section-number">11.5.1</span> Lookup</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># example with vectors</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"m"</span>, <span class="st">"f"</span>, <span class="st">"u"</span>, <span class="st">"f"</span>, <span class="st">"f"</span>, <span class="st">"m"</span>, <span class="st">"m"</span>, <span class="st">""</span>)</span>
<span id="cb40-3"><a href="#cb40-3"></a>lookup <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">m =</span> <span class="st">"Male"</span>, <span class="at">f =</span> <span class="st">"Female"</span>, <span class="at">u =</span> <span class="cn">NA</span>)</span>
<span id="cb40-4"><a href="#cb40-4"></a>lookup[x]</span>
<span id="cb40-5"><a href="#cb40-5"></a></span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="co"># example with data frame</span></span>
<span id="cb40-7"><a href="#cb40-7"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb40-8"><a href="#cb40-8"></a>  <span class="at">name =</span> <span class="fu">c</span>(</span>
<span id="cb40-9"><a href="#cb40-9"></a>    <span class="st">"robert"</span>, <span class="st">"catelyn"</span>, <span class="st">"theon"</span>, <span class="st">"cersei"</span>, <span class="st">"sansa"</span>,</span>
<span id="cb40-10"><a href="#cb40-10"></a>    <span class="st">"ned"</span>, <span class="st">"jaime"</span>, <span class="st">"sandor"</span>, <span class="st">"arya"</span>, <span class="st">"tyrion"</span></span>
<span id="cb40-11"><a href="#cb40-11"></a>  ),</span>
<span id="cb40-12"><a href="#cb40-12"></a>  <span class="at">gender =</span> <span class="fu">c</span>(</span>
<span id="cb40-13"><a href="#cb40-13"></a>    <span class="st">"m"</span>, <span class="st">"f"</span>, <span class="st">"u"</span>, <span class="st">"f"</span>, <span class="st">"f"</span>,</span>
<span id="cb40-14"><a href="#cb40-14"></a>    <span class="st">"m"</span>, <span class="st">"m"</span>,  <span class="st">""</span>, <span class="st">"f"</span>, <span class="st">"m"</span></span>
<span id="cb40-15"><a href="#cb40-15"></a>  )</span>
<span id="cb40-16"><a href="#cb40-16"></a>)</span>
<span id="cb40-17"><a href="#cb40-17"></a>lookup[df[[<span class="st">"gender"</span>]]]</span>
<span id="cb40-18"><a href="#cb40-18"></a>df_res <span class="ot">&lt;-</span> df</span>
<span id="cb40-19"><a href="#cb40-19"></a>df_res[[<span class="st">"gender_formatted"</span>]] <span class="ot">&lt;-</span> lookup[df[[<span class="st">"gender"</span>]]]</span>
<span id="cb40-20"><a href="#cb40-20"></a>df_res</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="match" class="level3" data-number="11.5.2">
<h3 data-number="11.5.2" class="anchored" data-anchor-id="match"><span class="header-section-number">11.5.2</span> <code>match</code></h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="at">birth_house =</span> <span class="fu">c</span>(</span>
<span id="cb41-3"><a href="#cb41-3"></a>    <span class="st">"baratheon"</span>, <span class="st">"stark"</span>, <span class="st">"stark"</span>, <span class="st">"stark"</span>, <span class="st">"stark"</span>,</span>
<span id="cb41-4"><a href="#cb41-4"></a>    <span class="st">"lannister"</span>, <span class="st">"lannister"</span>, <span class="st">"lannister"</span>, <span class="st">"greyjoy"</span>, <span class="st">"clegane"</span></span>
<span id="cb41-5"><a href="#cb41-5"></a>  ),</span>
<span id="cb41-6"><a href="#cb41-6"></a>  <span class="at">name =</span> <span class="fu">c</span>(</span>
<span id="cb41-7"><a href="#cb41-7"></a>    <span class="st">"robert"</span>, <span class="st">"catelyn"</span>, <span class="st">"sansa"</span>, <span class="st">"ned"</span>, <span class="st">"arya"</span>,</span>
<span id="cb41-8"><a href="#cb41-8"></a>    <span class="st">"cersei"</span>, <span class="st">"jaime"</span>, <span class="st">"tyrion"</span>, <span class="st">"theon"</span>, <span class="st">"sandor"</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>  )</span>
<span id="cb41-10"><a href="#cb41-10"></a>)</span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="fu">match</span>(df<span class="sc">$</span>name, df1<span class="sc">$</span>name)</span>
<span id="cb41-12"><a href="#cb41-12"></a>df_res <span class="ot">&lt;-</span> df</span>
<span id="cb41-13"><a href="#cb41-13"></a>df_res[[<span class="st">"birth_house"</span>]] <span class="ot">&lt;-</span> df1[<span class="fu">match</span>(df<span class="sc">$</span>name, df1<span class="sc">$</span>name), <span class="st">"birth_house"</span>]</span>
<span id="cb41-14"><a href="#cb41-14"></a>df_res</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="merge-1" class="level3" data-number="11.5.3">
<h3 data-number="11.5.3" class="anchored" data-anchor-id="merge-1"><span class="header-section-number">11.5.3</span> <code>merge</code></h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">merge</span>(df, df1, <span class="at">by =</span> <span class="st">"name"</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a>df3</span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="fu">merge</span>(df, df1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="built-in-datasets" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="built-in-datasets"><span class="header-section-number">11.6</span> Built-in datasets</h2>
<p>Base R comes with a few datasets built-in for demonstration purposes. We will use some of these to demonstrate how some of the data manipulation functions work.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">data</span>() <span class="co"># displays a list of all datasets</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="head-tail-summary" class="level3" data-number="11.6.1">
<h3 data-number="11.6.1" class="anchored" data-anchor-id="head-tail-summary"><span class="header-section-number">11.6.1</span> <code>head</code>, <code>tail</code>, <code>summary</code></h3>
<p>Quite often, the datasets are very long to read on one or even several screens. <code>head</code> and <code>tail</code> (as the identically named Linux/Unix commands) prints the beginning and end of the dataset.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>morley</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="fu">head</span>(morley)</span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="fu">tail</span>(morley)</span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="fu">summary</span>(morley)</span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="fu">dim</span>(morley)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="reshape" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="reshape"><span class="header-section-number">11.7</span> Reshape</h2>
<blockquote class="blockquote">
<p><code>?morley</code>: Michelson Speed of Light Data, A classical data of Michelson (but not this one with Morley) on measurements done in 1879 on the speed of light. The data consists of five experiments, each consisting of 20 consecutive ‘runs’. The response is the speed of light measurement, suitably coded (km/sec, with 299000 subtracted).</p>
</blockquote>
<p>There are many ways to reshape data between long and wide format:</p>
<ul>
<li><code>reshape</code>, R base</li>
<li><code>gather</code> and <code>spread</code>, part of the <code>tidyr</code> package</li>
<li><code>melt</code> and <code>dcast</code>, part of the <code>reshape2</code> package</li>
<li><code>stack</code> and <code>unstack</code>, R base</li>
</ul>
<p>We give introduction to the solution with the first two options.</p>
<section id="reshape-1" class="level3" data-number="11.7.1">
<h3 data-number="11.7.1" class="anchored" data-anchor-id="reshape-1"><span class="header-section-number">11.7.1</span> <code>reshape</code></h3>
<ul>
<li><code>reshape</code> is part of R base.</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>morley_wide <span class="ot">&lt;-</span> <span class="fu">reshape</span>(morley, <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">"Expt"</span>), <span class="at">timevar =</span> <span class="st">"Run"</span>, <span class="at">v.names =</span> <span class="st">"Speed"</span>, <span class="at">direction =</span> <span class="st">"wide"</span>, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="co">#morley_wide &lt;- reshape(morley, idvar = c("Expt"), timevar = "Run", v.names = c("Speed", "Run"), direction = "wide", sep = "_Run")</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>morley_wide</span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="fu">attributes</span>(morley_wide)</span>
<span id="cb45-5"><a href="#cb45-5"></a>morley_long <span class="ot">&lt;-</span> <span class="fu">reshape</span>(morley_wide, <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">"Expt"</span>), <span class="at">direction =</span> <span class="st">"long"</span>)</span>
<span id="cb45-6"><a href="#cb45-6"></a>morley_long</span>
<span id="cb45-7"><a href="#cb45-7"></a></span>
<span id="cb45-8"><a href="#cb45-8"></a><span class="fu">attributes</span>(morley_wide)<span class="sc">$</span>reshapeWide <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb45-9"><a href="#cb45-9"></a>morley_long <span class="ot">&lt;-</span> <span class="fu">reshape</span>(morley_wide, <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">"Expt"</span>), <span class="at">direction =</span> <span class="st">"long"</span>) <span class="co"># no 'reshapeWide' attribute, must specify 'varying'</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>morley_long <span class="ot">&lt;-</span> <span class="fu">reshape</span>(morley_wide, <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">"Expt"</span>), <span class="at">direction =</span> <span class="st">"long"</span>, <span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(morley_wide), <span class="at">v.names =</span> <span class="st">"Speed"</span>)</span>
<span id="cb45-11"><a href="#cb45-11"></a>morley_long <span class="ot">&lt;-</span> <span class="fu">reshape</span>(morley_wide, <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">"Expt"</span>), <span class="at">direction =</span> <span class="st">"long"</span>, <span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(morley_wide), <span class="at">timevar =</span> <span class="st">"Run"</span>, <span class="at">v.names =</span> <span class="st">"Speed"</span>)</span>
<span id="cb45-12"><a href="#cb45-12"></a>morley_long</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="tidyr" class="level3" data-number="11.7.2">
<h3 data-number="11.7.2" class="anchored" data-anchor-id="tidyr"><span class="header-section-number">11.7.2</span> <code>tidyr</code></h3>
<ul>
<li><code>gather</code> and <code>spread</code> are part of the <code>tidyr</code></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>morley_wide <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">spread</span>(morley, <span class="at">key =</span> Run, <span class="at">value =</span> Speed)</span>
<span id="cb46-2"><a href="#cb46-2"></a>morley_wide <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(morley, <span class="at">names_from =</span> Run, <span class="at">values_from =</span> Speed)</span>
<span id="cb46-3"><a href="#cb46-3"></a>morley_wide</span>
<span id="cb46-4"><a href="#cb46-4"></a></span>
<span id="cb46-5"><a href="#cb46-5"></a></span>
<span id="cb46-6"><a href="#cb46-6"></a>morley_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">gather</span>(morley_wide, <span class="at">key =</span> Run, <span class="at">value =</span> Speed, <span class="fu">names</span>(morley_wide)[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb46-7"><a href="#cb46-7"></a>morley_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(morley_wide, <span class="at">names_to =</span> <span class="st">"Run"</span>, <span class="at">values_to =</span> <span class="st">"Speed"</span>, <span class="sc">-</span>Expt)</span>
<span id="cb46-8"><a href="#cb46-8"></a>morley_long</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>ag <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(morley<span class="sc">$</span>Speed, <span class="at">by =</span> morley[<span class="dv">1</span>], <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.95</span>, <span class="fl">0.75</span>))</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="fu">head</span>(ag)</span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="fu">colnames</span>(ag)</span>
<span id="cb47-4"><a href="#cb47-4"></a></span>
<span id="cb47-5"><a href="#cb47-5"></a></span>
<span id="cb47-6"><a href="#cb47-6"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb47-7"><a href="#cb47-7"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id=</span><span class="dv">1</span>, <span class="at">mat=</span><span class="fu">I</span>(m))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="aggregate" class="level2" data-number="11.8">
<h2 data-number="11.8" class="anchored" data-anchor-id="aggregate"><span class="header-section-number">11.8</span> Aggregate</h2>
<section id="aggregate-1" class="level3" data-number="11.8.1">
<h3 data-number="11.8.1" class="anchored" data-anchor-id="aggregate-1"><span class="header-section-number">11.8.1</span> <code>aggregate</code></h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="at">p1 =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="at">p2 =</span> <span class="fu">rep</span>(letters[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">5</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="at">v1 =</span> <span class="fu">rnorm</span>(<span class="dv">9</span>, <span class="at">mean =</span> <span class="dv">10</span>),</span>
<span id="cb48-5"><a href="#cb48-5"></a>  <span class="at">v2 =</span> <span class="fu">rnorm</span>(<span class="dv">9</span>, <span class="at">mean =</span> <span class="dv">20</span>)</span>
<span id="cb48-6"><a href="#cb48-6"></a>)</span>
<span id="cb48-7"><a href="#cb48-7"></a>dtf</span>
<span id="cb48-8"><a href="#cb48-8"></a></span>
<span id="cb48-9"><a href="#cb48-9"></a><span class="fu">aggregate</span>(dtf<span class="sc">$</span>v1, <span class="at">by =</span> <span class="fu">list</span>(<span class="at">p1 =</span> dtf<span class="sc">$</span>p1, <span class="at">p2 =</span> dtf<span class="sc">$</span>p2), <span class="at">FUN =</span> mean)</span>
<span id="cb48-10"><a href="#cb48-10"></a><span class="fu">aggregate</span>(dtf[, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">by =</span> <span class="fu">list</span>(<span class="at">p1 =</span> dtf<span class="sc">$</span>p1, <span class="at">p2 =</span> dtf<span class="sc">$</span>p2), <span class="at">FUN =</span> mean)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>Formula method of aggregate</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># one value grouped by one variable</span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="fu">aggregate</span>( v1 <span class="sc">~</span> p1, <span class="at">data =</span> dtf, mean)</span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="fu">aggregate</span>( p2 <span class="sc">~</span> p1, <span class="at">data =</span> dtf, length)</span>
<span id="cb49-4"><a href="#cb49-4"></a></span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="co"># multiple values grouped by one variable</span></span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="fu">aggregate</span>(<span class="fu">cbind</span>(v1, v2) <span class="sc">~</span> p1, <span class="at">data =</span> dtf, max)</span>
<span id="cb49-7"><a href="#cb49-7"></a></span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="co"># one value grouped by multiple variables</span></span>
<span id="cb49-9"><a href="#cb49-9"></a><span class="fu">aggregate</span>(v1 <span class="sc">~</span> p1 <span class="sc">+</span> p2, <span class="at">data =</span> dtf, min)</span>
<span id="cb49-10"><a href="#cb49-10"></a></span>
<span id="cb49-11"><a href="#cb49-11"></a><span class="co"># multiple values grouped by multiple variables</span></span>
<span id="cb49-12"><a href="#cb49-12"></a><span class="fu">aggregate</span>(<span class="fu">cbind</span>(v1, v2) <span class="sc">~</span> p1 <span class="sc">+</span> p2, <span class="at">data =</span> dtf, mean)</span>
<span id="cb49-13"><a href="#cb49-13"></a><span class="fu">aggregate</span>(. <span class="sc">~</span> p1 <span class="sc">+</span> p2, <span class="at">data =</span> dtf, mean)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>with <code>dplyr</code></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>dtf2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(dtf, p1, p2)</span>
<span id="cb50-2"><a href="#cb50-2"></a>dplyr<span class="sc">::</span><span class="fu">summarise</span>(dtf2, <span class="at">v1.avg =</span> <span class="fu">mean</span>(v1), <span class="at">v2.max =</span> <span class="fu">max</span>(v2))</span>
<span id="cb50-3"><a href="#cb50-3"></a>dplyr<span class="sc">::</span><span class="fu">summarise</span>(dtf2, <span class="fu">quantile</span>(v1, <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.5</span>)))</span>
<span id="cb50-4"><a href="#cb50-4"></a></span>
<span id="cb50-5"><a href="#cb50-5"></a>my_quantile <span class="ot">&lt;-</span> <span class="cf">function</span>(x, probs) {</span>
<span id="cb50-6"><a href="#cb50-6"></a>  <span class="co"># dplyr::tibble(x = quantile(x, probs), probs = probs)</span></span>
<span id="cb50-7"><a href="#cb50-7"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">quantile</span>(x, probs), <span class="at">probs =</span> probs)</span>
<span id="cb50-8"><a href="#cb50-8"></a>}</span>
<span id="cb50-9"><a href="#cb50-9"></a>dplyr<span class="sc">::</span><span class="fu">summarise</span>(dtf2, <span class="fu">my_quantile</span>(v1, <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.5</span>)))</span>
<span id="cb50-10"><a href="#cb50-10"></a></span>
<span id="cb50-11"><a href="#cb50-11"></a>?dplyr<span class="sc">::</span>summarise_each <span class="co">#deprecated </span></span>
<span id="cb50-12"><a href="#cb50-12"></a></span>
<span id="cb50-13"><a href="#cb50-13"></a><span class="co"># </span></span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="co"># aggregate(df3, by = list(df3$birth_house), FUN = length)</span></span>
<span id="cb50-15"><a href="#cb50-15"></a><span class="co"># aggregate(df3$name, by = list(df3$birth_house), FUN = length)</span></span>
<span id="cb50-16"><a href="#cb50-16"></a><span class="co"># aggregate(df3, by = list(df3$birth_house, df3$gender), FUN = length)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="basic-stats-functions" class="level3" data-number="11.8.2">
<h3 data-number="11.8.2" class="anchored" data-anchor-id="basic-stats-functions"><span class="header-section-number">11.8.2</span> Basic stats functions</h3>
<p>Here are some R functions for basic descriptive statistic operations.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)             <span class="co"># mean</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="fu">mean</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cn">NA</span>, <span class="cn">NaN</span>)) <span class="co"># mean</span></span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="fu">mean</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cn">NA</span>, <span class="cn">NaN</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># mean</span></span>
<span id="cb51-4"><a href="#cb51-4"></a></span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="fu">sd</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)     <span class="co"># standard deviation</span></span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="fu">var</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)    <span class="co"># variance</span></span>
<span id="cb51-7"><a href="#cb51-7"></a><span class="fu">median</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="co"># median</span></span>
<span id="cb51-8"><a href="#cb51-8"></a></span>
<span id="cb51-9"><a href="#cb51-9"></a><span class="co"># ?median - The default method returns a length-one object of the same type as x,</span></span>
<span id="cb51-10"><a href="#cb51-10"></a><span class="co">#           except when x is logical or integer of even length, when the result will be double.</span></span>
<span id="cb51-11"><a href="#cb51-11"></a><span class="fu">median</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">10</span>))</span>
<span id="cb51-12"><a href="#cb51-12"></a></span>
<span id="cb51-13"><a href="#cb51-13"></a><span class="fu">quantile</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span>
<span id="cb51-14"><a href="#cb51-14"></a><span class="fu">quantile</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb51-15"><a href="#cb51-15"></a><span class="fu">range</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb51-16"><a href="#cb51-16"></a></span>
<span id="cb51-17"><a href="#cb51-17"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="cn">NaN</span>)</span>
<span id="cb51-18"><a href="#cb51-18"></a></span>
<span id="cb51-19"><a href="#cb51-19"></a><span class="fu">min</span>(v)</span>
<span id="cb51-20"><a href="#cb51-20"></a><span class="fu">min</span>(v, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-21"><a href="#cb51-21"></a><span class="fu">max</span>(v)</span>
<span id="cb51-22"><a href="#cb51-22"></a><span class="fu">max</span>(v, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-23"><a href="#cb51-23"></a><span class="fu">max</span>(<span class="fu">c</span>(v, <span class="cn">Inf</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-24"><a href="#cb51-24"></a></span>
<span id="cb51-25"><a href="#cb51-25"></a><span class="fu">which.min</span>(v) <span class="co"># na.rm = TRUE by default</span></span>
<span id="cb51-26"><a href="#cb51-26"></a><span class="fu">which.max</span>(v) <span class="co"># na.rm = TRUE by default</span></span>
<span id="cb51-27"><a href="#cb51-27"></a></span>
<span id="cb51-28"><a href="#cb51-28"></a><span class="co"># ?which.min - If this extremum is unique (or empty), the results are the same as (but more efficient than)</span></span>
<span id="cb51-29"><a href="#cb51-29"></a><span class="co">#              which(x == min(x, na.rm = TRUE)) or which(x == max(x, na.rm = TRUE)) respectively.</span></span>
<span id="cb51-30"><a href="#cb51-30"></a></span>
<span id="cb51-31"><a href="#cb51-31"></a><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb51-32"><a href="#cb51-32"></a></span>
<span id="cb51-33"><a href="#cb51-33"></a><span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">10</span>))</span>
<span id="cb51-34"><a href="#cb51-34"></a><span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">10</span>), <span class="at">lag =</span> <span class="dv">3</span>)</span>
<span id="cb51-35"><a href="#cb51-35"></a></span>
<span id="cb51-36"><a href="#cb51-36"></a><span class="co"># cumulatives</span></span>
<span id="cb51-37"><a href="#cb51-37"></a><span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">10</span>))</span>
<span id="cb51-38"><a href="#cb51-38"></a><span class="fu">cumprod</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">10</span>))</span>
<span id="cb51-39"><a href="#cb51-39"></a><span class="fu">cummax</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">10</span>))</span>
<span id="cb51-40"><a href="#cb51-40"></a><span class="fu">cummin</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">10</span>))</span>
<span id="cb51-41"><a href="#cb51-41"></a><span class="fu">cummin</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="expand" class="level3" data-number="11.8.3">
<h3 data-number="11.8.3" class="anchored" data-anchor-id="expand"><span class="header-section-number">11.8.3</span> Expand</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># n gives the aggregated counts of x, y pairs</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">6</span>), <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">1</span>))</span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df), df[[<span class="st">"n"</span>]])</span>
<span id="cb52-4"><a href="#cb52-4"></a></span>
<span id="cb52-5"><a href="#cb52-5"></a>df[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df), df[[<span class="st">"n"</span>]]), ]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="sorting" class="level2" data-number="11.9">
<h2 data-number="11.9" class="anchored" data-anchor-id="sorting"><span class="header-section-number">11.9</span> Sorting</h2>
<p><code>sort(x, decreasing = FALSE, ...)</code> sort a vector or factor into ascending or descending order.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="cn">NaN</span>, <span class="cn">NULL</span>, <span class="dv">7</span>, <span class="dv">13</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="fu">sort</span>(v)</span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="fu">sort</span>(v, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code>order</code> returns a permutation which rearranges its argument into ascending or descending order.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="cn">NaN</span>, <span class="cn">NULL</span>, <span class="dv">7</span>, <span class="dv">13</span>)</span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="fu">order</span>(v)</span>
<span id="cb54-3"><a href="#cb54-3"></a>v[<span class="fu">order</span>(v)]</span>
<span id="cb54-4"><a href="#cb54-4"></a>v[<span class="fu">order</span>(v, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb54-5"><a href="#cb54-5"></a></span>
<span id="cb54-6"><a href="#cb54-6"></a></span>
<span id="cb54-7"><a href="#cb54-7"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-8"><a href="#cb54-8"></a>  <span class="at">name  =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb54-9"><a href="#cb54-9"></a>  <span class="at">age   =</span> <span class="fu">c</span>(<span class="dv">25</span>,  <span class="dv">25</span>, <span class="dv">25</span>,  <span class="dv">20</span>, <span class="dv">20</span>,  <span class="dv">15</span>, <span class="dv">47</span>, <span class="dv">33</span>),</span>
<span id="cb54-10"><a href="#cb54-10"></a>  <span class="at">score =</span> <span class="fu">c</span>(<span class="dv">97</span>, <span class="dv">100</span>, <span class="dv">90</span>, <span class="dv">100</span>, <span class="dv">95</span>, <span class="dv">100</span>, <span class="dv">90</span>, <span class="dv">90</span>)</span>
<span id="cb54-11"><a href="#cb54-11"></a>)</span>
<span id="cb54-12"><a href="#cb54-12"></a>df</span>
<span id="cb54-13"><a href="#cb54-13"></a>df[<span class="fu">order</span>(df[[<span class="st">"age"</span>]]),]</span>
<span id="cb54-14"><a href="#cb54-14"></a>df[<span class="fu">order</span>(df[[<span class="st">"age"</span>]], <span class="sc">-</span>df[[<span class="st">"score"</span>]]),]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Sorting methods <code>method = c("auto", "shell", "quick", "radix")</code> can be specified for both <code>sort</code> and <code>order</code>.</p>
<ul>
<li>Reorder columns</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb55-2"><a href="#cb55-2"></a>df</span>
<span id="cb55-3"><a href="#cb55-3"></a>df <span class="ot">&lt;-</span> df[, <span class="fu">c</span>(<span class="st">"y"</span>, <span class="st">"x"</span>)]</span>
<span id="cb55-4"><a href="#cb55-4"></a>df <span class="ot">&lt;-</span> df[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)]</span>
<span id="cb55-5"><a href="#cb55-5"></a>df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="exercises" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="exercises">Exercises</h2>
<p>See <a href="../exercises/exercises_all_2.html#sec-exercises-4" class="quarto-xref"><span>Section 15.2</span></a> for exercises on usages of <code>data.frame</code>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chap_02/containers_02.html" class="pagination-link" aria-label="Heterogeneous Types">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Heterogeneous Types</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chap_02/vis_base.html" class="pagination-link" aria-label="Data Visualisation I">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Visualisation I</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2021 - 2025, Bo Gao</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/bg-intro-r/bg-intro-r.github.io" class="toc-action"><i class="bi bi-chat-right"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bogaotory">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/bogaowarwick/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>