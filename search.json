[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Introduction to R for Modellers",
    "section": "",
    "text": "Preface\nThis book is a collection of lecture notes prepared for the Introduction to R for Modellers module which takes place at the beginning of the MSc Modelling for Global Health (MGH) course. The course makes no assumption on its students’ computer coding experiences, so this book is suitable for readers with minimum knowledge of the R language and to coding in general.\n\nThe MGH course has been running annually since autumn 2021, and so has the module. With each iteration of the course, we updated the module’s content to match the abilities of our students and also to incorporate new developments on the R platform. New contents have been added to this book over the years as a result. Some contents are also now omitted from the module due to time constraints. The module now covers most but not all materials written in this book.\nIncoming cohorts of the MGH course are highly encouraged to read this book before enrolment.\nMaterials from this book has also been used in training programmes such as the Strategic Modelling for Public Health Policy Training Programme organised by CoMo.\n\nI would like to thank all that took part in the past teaching sessions of this module for their feedback. - Dr. Bo Gao",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "mgh.html",
    "href": "mgh.html",
    "title": "MGH module matters",
    "section": "",
    "text": "R will start to make more sense as the week goes on.\nDon’t just listen and read. Type and execute all the code you see in the lectures at least once on your own computer.\nModule Schedule",
    "crumbs": [
      "MGH module matters"
    ]
  },
  {
    "objectID": "mgh.html#footnotes",
    "href": "mgh.html#footnotes",
    "title": "MGH module matters",
    "section": "",
    "text": "If your answer is a = 1 for Python, or int a = 1; for C/C++, then you should not skip this module.↩︎",
    "crumbs": [
      "MGH module matters"
    ]
  },
  {
    "objectID": "chap_01/get_started.html",
    "href": "chap_01/get_started.html",
    "title": "1  Get Started",
    "section": "",
    "text": "1.1 Install Base R\nOutline\nWe begin by introducing key elements of an R software development environment (Figure 1.1), and the key questions we want to answer in this chapter are:\nR is a cross-platform open-source software environment for statistical computing and graphics. R is primarily written in C, Fortran, and R itself. The R software environment is a GNU package, and is freely available under the GNU General Public License. (The R Foundation 2025)\nPrecompiled binary distributions of the base system of R (also referred to as Base R) are available for download and install from https://cloud.r-project.org/ for different operating systems (OS). For MGH students with course-issued laptops, on that page:\nOpen the downloaded file and follow the instructions on screen to complete the installation of Base R.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Get Started</span>"
    ]
  },
  {
    "objectID": "chap_01/get_started.html#sec-install-r",
    "href": "chap_01/get_started.html#sec-install-r",
    "title": "1  Get Started",
    "section": "",
    "text": "Tip\n\n\n\nWhen you travel to a foreign country where you don’t speak the local dialogue, in order to communicate with the local people, you will need to employ an interpreter. We are in a similar situation here: in order for you to talk to your computer in the R language, we need to equip it with an interpreter, and this interpreter comes in the form of a software package that you can install on your computer, and is referred to as Base R.\n\n\n\n\n\nMacBook Air laptops: Select “Download R for macOS”, then click the “R-4.x.x-arm64.pkg” link on the page (Apple silicon)\nDell (Windows) laptops: Select “Download R for Windows”, then click the “Download R-4.x.x for Windows (xx megabytes, 64 bit)” link on the top of the page\n\n\n\n\n1.1.1 Where is R now on my computer?\nOnce the installation process has completed, you are now ready to talk to your computer in the language R. First, you need to find the R interpretor that was installed on your computer as a result of the installation process. This interpretor comes in different names and is saved at different locations on your hard drive depending on which OS you have:\n\n\ncat /etc/paths\n\nmacOSWindows\n\n\nOn macOS (and other Unix-based OSes such as Ubuntu), chances are that you can open a terminal (see Section B.2) and execute the R command without further configuration, as shown in the video below.\n\nWhat you can see in this video is that we:\n\nOpened a new (OS-level) terminal by searching and selecting for the “terminal” application through the “Spotlight search” functionality on macOS (function on the F4 key of your keyboard).\nTyped the command R on the command line (prompted by the $ character) and pressed the Enter key.\nWe are now in an interactive R session. The terminal-like interface (with &gt; being the prompt character) we are looking at is referred to as the R terminal or R REPL which is our gateway to talk to the computer via the R interpreter which we just installed on this laptop.\nIn this R session, we typed a couple of R commands creating and displaying a vector named a, before exiting the R terminal by calling the q() function.\n\nIf everything works fine up to this step, then well done, you’ve installed R correctly. If you wish to find out more about exactly where R is installed on your hard drive:\n\nHaving exited the R session, we are now back in the (OS-level) terminal prompted by the $ character. Here we can issue the which R command that tells us what file is the R command associated with. In the output from this which command, we can see that the file is located at /usr/local/bin/R.\nWe looked further into this file with the ls command which tells us that the /usr/local/bin/R file is linked (see Symbolic link) to the file at /Library/Frameworks/R.framework/Resources/bin/R which where the R base package and all associated files are installed.\nIf you navigate to that location, you will find executable files such as R and Rscript. See screenshot below showing the contents of the bin directory, and note that the directory actually further links to the /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/bin directory.\n\n\n\n\nScreenshot: R location on macOS\n\n\nIf at step 2, you get R: command not found in return, that means R’s bin directory is not included on the PATH (see PATH (variable) ).\n\n\nTo run R code on Windows,\n\nLocate R.exe\n\nBy default, the R base package is installed at C:\\Program Files\\R\\R-4.x.y for version 4.x.y on Windows. Open your file explorer to that location, and you will find an executable file named R.exe in the bin directory.\n\n\n\nScreenshot: R.exe location\n\n\n\nOpen R.exe\n\nDouble click on R.exe will open a window named Rterm which is an [REPL] for the R environment.\n\n\n\nScreenshot: Rterm\n\n\n\nUpdate Path\n\nIn order to access R.exe quickly on the command line, we add C:\\Program Files\\R\\R-4.x.y\\bin to the operating system (OS)’s PATH environment variable. On Windows,\n\n\nClick the Windows key and type “environment”\nSelect “Edit the system environment variables”\nClick the “Environment Variables” button\nDouble-click “Path” from the “User variables for ***” list\nClick “New”, and type “C:\\Program Files\\R\\R-4.x.y\\bin”\n\n\n\n\nScreenshot: Edit Path environment variable\n\n\n\nCommand line access\n\nNow, when you type R and press ENTER on the command line prompt, you will be in R’s REPL straightaway. \n\n\n\n\n\n1.1.2 What is Base R?\nThe process that you just executed completed your installation of what we refer to as Base R. Base R is synonymous with “R’s standard library” as given by (The R Core Team 2025). It is a collection of core packages of the R programming language. Authored by the R Core Team, it defines the R language and includes functions that perform tasks that are essential for a statistical data processing system.\nA full list of packages included in Base R is given by (The R Core Team 2025). This list can be considered to be of two parts:\n\nThe package called base, which is the R Base Package. A full list of what functions are defined in base is available on this page.\nOther packages that extends the base package in various fields of application. Examples include packages such as graphics, datasets and stats which are frequently referenced in R projects.\n\nIn this book, we give example on the use of:\n\nBasic (vector) data types such as double, integer, character, and logical type values\nArithmetic, relational, and logical operations\nControl flow constructs such as if-else and for-loop\nHeterogeneous data containers such as data.frame\nPlotting with functions such as plot(), lines(), and boxplot()\nStatistical processes such as runif(), approx(), and lm()\n\nBase R is comprehensive in functionalities. However, over the years, many non-Base packages has emerged as superstars of the R ecosystem. A collection of these packages is now known under the umbrella of tidyverse. This book is limited in length to cover all non-base packages. We give examples on packages such as ggplot2 from tidyverse. And students are encouraged to read more on tidyverse in their own time, and from other modules of the course.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Get Started</span>"
    ]
  },
  {
    "objectID": "chap_01/get_started.html#use-r-as-a-calculator",
    "href": "chap_01/get_started.html#use-r-as-a-calculator",
    "title": "1  Get Started",
    "section": "1.2 Use R as a calculator",
    "text": "1.2 Use R as a calculator\nWhen you come across complex mathematical expressions such as 7461 + 72945 x (5763 - 986) = ?, do you feel the urge to find a pen and a paper? Do you double check with a calculator? or simply read the question to Siri? Or, perhaps, let the mighty R solve it for you?\n\n\n\n\n\nImage credit: The Art of R Programming: A Tour of Statistical Software Design, Norman Matloff\n\n\nComputers are invented to do calculations, and programming languages are a means for us (the user) to talk to the computer. So, can we ask the computer (by speaking R) to do some calculations for us? If you type in “1 + 2” on your calculator and hit “=” you will get “3” displayed on the screen, can we do that in R too?\nIn our first encounter with R, we start with the most basic operations you can perform in R. Let’s start from the beginning and dump your calculator for the mighty Rrr!\n\n1.2.1 REPL / Console\nA REPL (read-eval-print loop) is an environment within which a programmer may interact with the computer using a programming language associated with that REPL. It is a feature often provided with interpreted languages ([Compiled vs Interpreted]) such as R, Python, and Perl for fast and direct interaction. Command line terminals/shells are the most common examples of REPL. A common calculator can also be considered as a REPL.\nAll commands included in this session can be executed on R’s REPL. In RStudio, the REPL is given under the “Console” tab.\n\n\n\nLeft: R REPL, Right: Calculator REPL\n\n\n\n\n1.2.2 Assignment operator &lt;-\nThe purpose of the assignment operator &lt;- is to assign a value/function definition at its right hand side (RHS) to a name which sits to its left hand side (LHS). This is similar to the function of the MS (memory save) key on a calculator. The value assigned to this name can then be recalled by calling the name.\n\n\n\nMS key on a calculator\n\n\n\na &lt;- 65 # a value 65 is saved in the computer's memory, and that piece of memory is given a name \"a\"\na + 31  # recalls the value by referring to its name\na       # typing the name in the REPL get its value printed\n\n# you can also use `print` or `cat` to find out the value of a name/variable\nprint(a)\ncat(a)\n\n# note the difference between print and cat\nprint(\"ab\\ncd\")\ncat(\"ab\\ncd\")\n\n# format your output to be more meaningful\nprint(paste0(\"a=\", a))\n\nPractically speaking, you can use = for assignment in R, but the &lt;- operator is more commonly used in the R community. The use of &lt;- is a convention that helps to distinguish between assignment and declaring the association between function arguments and their values. For example, in the function call mean(x = c(1, 2, 3)), the x = c(1, 2, 3) part is not an assignment but rather an argument specification for the mean function. Using &lt;- for assignment and = for argument specification helps to avoid confusion and improve code readability.\n\n\n\n\n\nAssignment operator\n\n\n\n\n1.2.3 .R script\nOn a calculator, all the memories are exclusively used by the calculator. In contrast, R has to share the computer’s memory with other applications that are also running on that computer.\nWhen we start a new R session (on macOS: execute /usr/local/bin/R; on Windows: double click the R.exe file), a new application session is started and a new environment is created in the computer’s memory (the RAM module on your laptop) by the operating system (OS) to serve this new application session. Rterm/REPL gives the user an interface through which we can interact with this environment. An assignment operator let us name a section in the computer’s main memory (RAM) to hold any work we are doing.\nAs soon as the session is closed, the OS assumes everything needed doing has been done and free up all the memories used during the session for use by other applications. Therefore, everything we typed in the REPL is lost from the RAM. The next time we open the REPL, if we want to use reproduce the work we did in the previous session, we will need to type all the codes that we executed in that session. This is when we want to create a .R file (a.k.a an R script) to keep a record of all the codes we created.\nTo help make the process easier, you may use a function named source that runs everything saved in an R script and try to recreate the same environment that the previous session was in.\n\nsource(\"script.R\")\n\nThis is equivalent to opening the script in an IDE like RStudio and running everything in the script. In RStudio, you can use the following shortcuts to run everything in a script:\n\nmacOS:\nCMD + A, Run, run everything, ignores error.\nCMD + A, Source, run everything, stops at error.\nWindows:\nCTRL + A, Run, run everything, ignores error.\nCTRL + A, Source, run everything, stops at error.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Get Started</span>"
    ]
  },
  {
    "objectID": "chap_01/get_started.html#install-an-ide",
    "href": "chap_01/get_started.html#install-an-ide",
    "title": "1  Get Started",
    "section": "1.3 Install an IDE",
    "text": "1.3 Install an IDE\nAn integrated development environment (IDE) is an essential tool to develop and maintain software projects. For R developers, there are several good options available:\n\nRStudio is perhaps the most well-known IDE for R developers. It works out-of-the-box and has an interface arrangement that’s optimised for R showing plots and the global environment alongside to the code. It now also works with Python.\nVisual Studio Code (VS Code) is language-agnostic, meaning that you can use it to manage projects written in pretty much any programming language there is. According to (Stack Overflow 2025), it is by far the most popular IDE used by developers anywhere on planet Earth. Some extensions are needed to customise behaviours required for R projects.\nPositron’s objective is to combine the best of RStudio and VS Code, in that it is developed and maintained by posit which made RStudio, and is technically a variant (fork) of VS Code.\nOther IDEs are available.\n\nWe recommend RStudio to those new to programming, i.e. R is your first computer programming language, as it has a panel arrangement that displays everything at the same time.\nFor those who has previous experiences with programming languages, especially those who used VS Code for other projects, we recommend that they stick to VS Code for it does everything RStudio does and lets the user focus more on the code.\nWe have tried Positron ourselves from 2024-25 in a couple of projects of our own. It fixes issues that VS Code have at times with displaying plots and shiny apps. However, to our experience, it can be a bit laggy when more data is being worked on. It is a promising project that we are keeping an eye on and may adapt for future developments.\n\n\n\n\n\n\nNote\n\n\n\nOn the MGH module, our demonstrations are done using RStudio. The students may find lecturers from other modules of the course demonstrating with VS Code later on in the course. So some familiarity with both RStudio and VS Code are recommended.\n\n\n\n1.3.1 RStudio\nRStudio is an IDE that’s designed to provide a user-friendly interface to the features and tools for projects using R. A free desktop version can be downloaded from here. Click the DOWNLOAD RSTUDIO DESKTOP FOR xxx button under “2: Install RStudio” section on the right-hand side of the page. You’ve already completed the steps needed for “1: Install R” in Section 1.1.\nNote that R and RStudio refer to different things. RStudio is one of the tools available for managing an R project. Alternative code editors such as Sublime Text and Visual Studio Code are also available.\nThe default layout of RStudio has four sections:\n\nTop-left: Code editor\nTop-right: Run time tools\nBottom-left: REPL, system terminal\nBottom-right: File explorer, plot viewer, etc.\n\n\n\n\nScreenshot: RStudio IDE\n\n\n\n5 minutes: Find out how to switch between panels in RStudio using only your keyboard.\n\n\n\n1.3.2 VS Code\nVisual Studio Code (VS Code) is a free, open-source code editor developed by Microsoft. It is a powerful and versatile tool that supports a wide range of programming languages, including R. To use VS Code for R development, you will need to install the R extension for VS Code, which provides features such as syntax highlighting, code completion, and debugging support for R. You can download VS Code from here, and install the R extension from the Extensions Marketplace within VS Code.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Get Started</span>"
    ]
  },
  {
    "objectID": "chap_01/get_started.html#recommended-readings",
    "href": "chap_01/get_started.html#recommended-readings",
    "title": "1  Get Started",
    "section": "Recommended readings",
    "text": "Recommended readings\n\nChapter 1, Advanced R, Hadley\nIntroduction and preliminaries, An Introduction to R, R manual\nBase R Cheat Sheet\nR Reference Card\n\n\n\n\n\nStack Overflow. 2025. “Most Popular Development Environments / 2025 Developer Survey.” 2025. https://survey.stackoverflow.co/2025/technology#most-popular-technologies-dev-envs.\n\n\nThe R Core Team. 2025. “Packages in the Standard Library.” 2025. https://stat.ethz.ch/R-manual/R-devel/doc/html/packages.html.\n\n\nThe R Foundation. 2025. “What Is R?” 2025. https://www.r-project.org/about.html.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Get Started</span>"
    ]
  },
  {
    "objectID": "chap_01/operators.html",
    "href": "chap_01/operators.html",
    "title": "2  Operators",
    "section": "",
    "text": "2.1 Arithmetic operators\nThere are many operators in R. Type ?Syntax and then press the ENTER key on your keyboard will take you to the documentation on “Operator Syntax and Precedence”. In this session, we introduce three groups of commonly used operators in R.\nJust like a calculator, R understands basic arithmetic operators. Try these following commands and see if the printed value is what you are expecting:\n1 + 2         # addition\n25 - 17       # subtraction\n3 * 2.3       # multiplication\n13 / 7        # division\n10 + 20 * 2   # is equivalent to 10 + (20 * 2)\n(10 + 20) * 2 # use \"( )\" to control operator precedence\n2 ^ 3         # exponentiation\n2 ** 3        # exponentiation\n15 %% 10      # modulus\n15 %/% 10     # integer division\nWant to know more about these operators? Type ?Arithmetic in your REPL",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Operators</span>"
    ]
  },
  {
    "objectID": "chap_01/operators.html#relational-operators",
    "href": "chap_01/operators.html#relational-operators",
    "title": "2  Operators",
    "section": "2.2 Relational operators",
    "text": "2.2 Relational operators\nRelational operators compares values on its left and right.\n\n6 &gt; 5\n10 + 1 &gt; 10         # + evaluated before &gt;\n234 * 76 &gt; 938 * 43 # * evaluated before &gt;\n5 &lt;= 5\n5 &lt;= 4\n12 == 12\n12 != 12\n1 == TRUE  # 1 is the numerical presentation of TRUE\n2 == TRUE\n0 == FALSE # 0 is the numerical presentation of FALSE\n2 == FALSE\n2 != FALSE\n\nUse == only when comparing integers. We will revisit this issue when we introduce how real numbers are represented in the computer memory.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Operators</span>"
    ]
  },
  {
    "objectID": "chap_01/operators.html#logical-operators",
    "href": "chap_01/operators.html#logical-operators",
    "title": "2  Operators",
    "section": "2.3 Logical operators",
    "text": "2.3 Logical operators\nTruth table for R’s element-wise logical operators:\n\n\n\nx\ny\nx & y\nx | y\nxor(x, y)\n\n\n\n\nTRUE\nTRUE\nTRUE\nTRUE\nFALSE\n\n\nTRUE\nFALSE\nFALSE\nTRUE\nTRUE\n\n\nFALSE\nTRUE\nFALSE\nTRUE\nTRUE\n\n\nFALSE\nFALSE\nFALSE\nFALSE\nFALSE\n\n\n\n\n8 &gt; 7 & 9 &gt; 8           # TRUE and TRUE\n6 &lt; 8 & 6 &gt; 8           # TRUE and FALSE\n6 &lt; 8 | 6 &gt; 8           # TRUE or FALSE\n1 & TRUE                # TRUE and TRUE\n0 & TRUE                # FALSE and TRUE\n\nxor(TRUE, FALSE)        # exclusive or, TRUE if and only if the arguments differ\nxor(TRUE, TRUE)\n\n[1] TRUE\n[1] FALSE\n[1] TRUE\n[1] TRUE\n[1] FALSE\n[1] TRUE\n[1] FALSE\n\n\n\n2.3.1 Difference between & and &&, and between | and ||\nThe & and | operators are vectorized, meaning they operate element-wise on vectors. The && and || operators, on the other hand, are not vectorized and only evaluate the first element of each vector. This means that if you use && or || with vectors, an error will be given. For example:\n\nc(TRUE, FALSE) & c(FALSE, TRUE)   # this is okay, element-wise AND\nc(TRUE, FALSE) && c(FALSE, TRUE)  # error!",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Operators</span>"
    ]
  },
  {
    "objectID": "chap_01/operators.html#operator-precedence",
    "href": "chap_01/operators.html#operator-precedence",
    "title": "2  Operators",
    "section": "2.4 Operator precedence",
    "text": "2.4 Operator precedence\nIn a mathematical equation, we know that multiplication and division take precedence over addition and subtraction. This precedence may be altered with the use of ().\n\n1 + 3 * 4 # 13\n(1 + 3) * 4 # 16\n\n[1] 13\n[1] 16\n\n\n\n\n\n\n\nimg source\n\n\nOperators in R are also governed by an order of precedence, which may be altered with the use of (). Type ?Syntax will show you the precedence of all R operators many of which we have not introduced. It is important to note that when mixing multiple operators in the same line of code, some operations takes precedence before others.\nBetween the three groups of operators we introduced, arithmetic operators takes precedence over relational operators which takes precedence over logical operators.\nTry and work out the values of the following expressions without running them in R, and verify your results in R.\n\n9 - 10 &gt; 0 & 9 &gt; 0      # Operator precedence (arithmetic &gt; relational &gt; logical)\n9 - (10 &gt; 0 & 9 &gt; 0)    # Alter operator precedence with brackets\n9 - (10 &gt; 0) & 9 &gt; 0    # Alter operator precedence with brackets\nTRUE | FALSE & FALSE    # & takes precedence before |\n(TRUE | FALSE ) & FALSE # Alter operator precedence with brackets",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Operators</span>"
    ]
  },
  {
    "objectID": "chap_01/operators.html#summary",
    "href": "chap_01/operators.html#summary",
    "title": "2  Operators",
    "section": "2.5 Summary",
    "text": "2.5 Summary\nQuick reference for the three operator families we have covered:\n\n\n\n\n\n\n\n\nType\nCommon symbols\nTypical purpose\n\n\n\n\nArithmetic\n+ - * / ^ %% %/%\nPerform numeric calculations; highest precedence of the three.\n\n\nRelational\n&gt; &lt; &gt;= &lt;= == !=\nCompare two values and return TRUE or FALSE.\n\n\nLogical\n! & && | || xor()\nCombine logical (TRUE, FALSE) results; use &/| for element-wise checks in vectors and &&/|| for single values; lowest precedence of the three.\n\n\n\nType ?Syntax for more detailed documentation on operators in R.\nThese operators are also referred to as binary operators for they take two objects (x and y) as inputs to produce one output object. x and y are also referred to as operands of the operation. + and - are unary operators when used to indicate the sign of numeric values.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Operators</span>"
    ]
  },
  {
    "objectID": "chap_01/function.html",
    "href": "chap_01/function.html",
    "title": "3  Function",
    "section": "",
    "text": "3.1 Syntactic names\nNoticed how xor is written differently to the other operators? R is much more than a simple calculator and the number of operations offered by R far exceeds the number of readable symbols available on the keyboard, and so, most operations are called as functions (see [R built-in numeric functions] for a few more functions, e.g. abs, sqrt, sin).\nTo the R interpreter, xor(x, y) issues one call to a function named xor with two arguments x, and y. The same applies to all the other operators. All of the operators we studied so far are functions.\nTry these:\nRecommended readings:\nNoticed how we had to wrap symbols such as + and &gt; in backticks “`”, and without them, expressions such as +(2, 3) evaluates to an error. At the same time, xor works just fine without the backtick wrapper. In both cases + and xor are both names of functions, but + had to be wrapped within backticks because the symbol + is not a syntactic name whereas xor is a perfectly fine syntactic name.\nIn order to use a non-syntactic name to identify things in R, you have to wrap it between backticks.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Function</span>"
    ]
  },
  {
    "objectID": "chap_01/function.html#syntactic-names",
    "href": "chap_01/function.html#syntactic-names",
    "title": "3  Function",
    "section": "",
    "text": "In R, a syntactic name must only consist of letters, digits, ., and _, and it cannot begin with _ or a digit. Reserved words such as TRUE, FALSE, and function (?Reserved) also can’t be used as syntactic names.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Function</span>"
    ]
  },
  {
    "objectID": "chap_01/function.html#nearly-everything-that-happens-in-r-results-from-a-function-call",
    "href": "chap_01/function.html#nearly-everything-that-happens-in-r-results-from-a-function-call",
    "title": "3  Function",
    "section": "3.2 Nearly everything that happens in R results from a function call",
    "text": "3.2 Nearly everything that happens in R results from a function call\nA function can be as simple as xor providing the result of one operation, but more often multiple operations are combined and organised in a specific way and encapsulated in a custom-named function. These functions are then combined to make a script that forms a piece of computer program.\n\nNearly everything that happens in R results from a function call. Therefore, basic programming centers on creating and refining functions. - John Chambers\n\nFunctions in R are first class objects.\nSee all functions in the base package with ls(\"package:base\").",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Function</span>"
    ]
  },
  {
    "objectID": "chap_01/function.html#write-your-own-function",
    "href": "chap_01/function.html#write-your-own-function",
    "title": "3  Function",
    "section": "3.3 Write your own function",
    "text": "3.3 Write your own function\nWrite a function IsEven which takes a single numerical value as input and returns TRUE if and only if that given value is even.\n\nIsEven &lt;- function (x) {\n  return(x %% 2 == 0)\n}\nIsEven(10)\nIsEven(9)\n\nIsEven # type the function's name to see its implementation\n`xor`\n`+`\n\n\n\n\nIllustration: Syntax of a function\n\n\nNote that some functions are designed to encapsulate a group of statements rather than work out a value. In such case, a return statement is not necessary. Otherwise, an explicit return is required. Note that this is not the same as the implicit return we describe in Avoid implicit return.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Function</span>"
    ]
  },
  {
    "objectID": "chap_01/function.html#avoid-implicit-return",
    "href": "chap_01/function.html#avoid-implicit-return",
    "title": "3  Function",
    "section": "3.4 Avoid implicit return",
    "text": "3.4 Avoid implicit return\n\nDon’t do this: When a return statements is missing from the end of the function. R assumes that the evaluation of the last statement of the function is the return value. This is referred to as implicit return. This makes the code difficult to read, and should be avoided. The good practice is to always explicit return (i.e. use return() explicitly at the endo of the function)\n\nThroughout the module, we will give note to bad programming practices which should be avoid. For a more comprehensive read on good programming styles in R, we follow these two guides:\n\nGoogle’s R style guide\nThe tidyverse style guide\n\nWhere contrasting opinions are present, we follow Google’s R Style Guide over that of tidyverse.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Function</span>"
    ]
  },
  {
    "objectID": "chap_01/function.html#components",
    "href": "chap_01/function.html#components",
    "title": "3  Function",
    "section": "3.5 Components",
    "text": "3.5 Components\nAn R function has three parts\n\nformals, the list of arguments used by the function\nbody, the implementation of the function logic\nenvironment, the environment that encapsulate the function\n\n\nExcept the primitive and internal functions that are written in C. e.g. abs, sum, +, etc.\n\n\nformals(xor)\nbody(xor)\nenvironment(xor)\n\nAlso, user-defined functions:\n\nBmi &lt;- function(weight, height) {\n  return(weight / height^2)\n}\nformals(Bmi)\nbody(Bmi)\nenvironment(Bmi)",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Function</span>"
    ]
  },
  {
    "objectID": "chap_01/function.html#formals",
    "href": "chap_01/function.html#formals",
    "title": "3  Function",
    "section": "3.6 Formals",
    "text": "3.6 Formals\nDefining a function in R is similar to defining a variable. A function object defined by the function function is assigned a name by the &lt;- operator.\nThe formals / signature / interface of the function is defined by the list of argument it takes.\n\nBmi &lt;- function(weight, height) {\n  return(weight / height^2)\n}\n\n# arguments can be of any order when they are named\nBmi(weight = 90, height = 1.75)\nBmi(height = 1.75, weight = 90)\n# otherwise the order is implicitly implied\nBmi(90, 1.75)\n\n\n3.6.1 Default values\n\n# an argument may have a default value\nBmi &lt;- function(weight = 90, height = 1.75) {\n  return(weight / height^2)\n}\nBmi(90)\nBmi(70)\nidentical(\n  Bmi(, 1.75),\n  Bmi(height = 1.75)\n)\n\n\n\n3.6.2 ...\nThe construct is referred to as “ellipsis” / “dot-dot-dot”.\nWhen you want to pass arguments only used in a nested function:\n\nf1 &lt;- function(x, y) {\n  print(paste0(\"f1: x=\", x, \", y=\", y))\n}\nf2 &lt;- function(z, ...) {\n  print(paste0(\"f2: z=\", z))\n  f1(...)\n}\nf2(z = 55, x = 10, y = 9)\n\nLook at how the function save uses ellipsis:\n\nsave\n\nfunction (..., list = character(), file = stop(\"'file' must be specified\"), \n    ascii = FALSE, version = NULL, envir = parent.frame(), compress = isTRUE(!ascii), \n    compression_level, eval.promises = TRUE, precheck = TRUE) \n{\n    opts &lt;- getOption(\"save.defaults\")\n    if (missing(compress) && !is.null(opts$compress)) \n        compress &lt;- opts$compress\n    if (missing(compression_level) && !is.null(opts$compression_level)) \n        compression_level &lt;- opts$compression_level\n    if (missing(ascii) && !is.null(opts$ascii)) \n        ascii &lt;- opts$ascii\n    if (missing(version)) \n        version &lt;- opts$version\n    if (!is.null(version) && version &lt; 2) \n        warning(\"Use of save versions prior to 2 is deprecated\", \n            domain = NA)\n    names &lt;- as.character(substitute(list(...)))[-1L]\n    if (missing(list) && !length(names)) \n        warning(\"nothing specified to be save()d\")\n    list &lt;- c(list, names)\n    if (!is.null(version) && version == 1) \n        .Internal(save(list, file, ascii, version, envir, eval.promises))\n    else {\n        if (precheck) {\n            ok &lt;- vapply(list, exists, NA, envir = envir)\n            if (!all(ok)) {\n                n &lt;- sum(!ok)\n                stop(sprintf(ngettext(n, \"object %s not found\", \n                  \"objects %s not found\"), paste(sQuote(list[!ok]), \n                  collapse = \", \")), domain = NA)\n            }\n        }\n        if (is.character(file)) {\n            if (!nzchar(file)) \n                stop(gettextf(\"'%s' must be a non-empty character string\", \n                  \"file\"), domain = NA)\n            if (!is.character(compress)) {\n                if (!is.logical(compress)) \n                  stop(\"'compress' must be logical or character\")\n                compress &lt;- if (compress) \n                  \"gzip\"\n                else \"no compression\"\n            }\n            con &lt;- switch(compress, bzip2 = {\n                if (!missing(compression_level)) bzfile(file, \n                  \"wb\", compression = compression_level) else bzfile(file, \n                  \"wb\")\n            }, xz = {\n                if (!missing(compression_level)) xzfile(file, \n                  \"wb\", compression = compression_level) else xzfile(file, \n                  \"wb\", compression = 9)\n            }, gzip = {\n                if (!missing(compression_level)) gzfile(file, \n                  \"wb\", compression = compression_level) else gzfile(file, \n                  \"wb\")\n            }, zstd = {\n                if (!missing(compression_level)) zstdfile(file, \n                  \"wb\", compression = compression_level) else zstdfile(file, \n                  \"wb\")\n            }, `no compression` = file(file, \"wb\"), stop(gettextf(\"'compress = \\\"%s\\\"' is invalid\", \n                compress)))\n            on.exit(close(con))\n        }\n        else if (inherits(file, \"connection\")) \n            con &lt;- file\n        else stop(\"bad file argument\")\n        if (isOpen(con) && !ascii && summary(con)$text != \"binary\") \n            stop(\"can only save to a binary connection\")\n        .Internal(saveToConn(list, con, ascii, version, envir, \n            eval.promises))\n    }\n}\n&lt;bytecode: 0x13cc428f0&gt;\n&lt;environment: namespace:base&gt;",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Function</span>"
    ]
  },
  {
    "objectID": "chap_01/function.html#scoping",
    "href": "chap_01/function.html#scoping",
    "title": "3  Function",
    "section": "3.7 Scoping",
    "text": "3.7 Scoping\n\nx &lt;- 1\ny &lt;- 2\nf &lt;- function() {\n  x &lt;- 10 # 1. Overwrites the x outside the function\n  print(paste0(\"f: 1. x=\", x, \", y=\", y)) # 2. Look for y from one level up\n  x &lt;- 30\n  y &lt;- 20\n  print(paste0(\"f: 2. x=\", x, \", y=\", y)) # 3. The closest y is used\n}\nf()\nf() # 4. calling second time gives the same result\ny &lt;- 3\nf() # 5. y updated just before the call",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Function</span>"
    ]
  },
  {
    "objectID": "chap_01/function.html#lazy-evaluation",
    "href": "chap_01/function.html#lazy-evaluation",
    "title": "3  Function",
    "section": "3.8 Lazy evaluation",
    "text": "3.8 Lazy evaluation\n\nAn argument is not evaluated until its evaluation is needed.\nShort-circuit evaluation\n\n\nTRUE || stop(\"ERROR\")\n\nf &lt;- function(x) {\n  print(paste0(\"f called\"))\n  return(x)\n}\n\nFALSE && f()\nTRUE && f(FALSE) && f()\nTRUE && f(TRUE) && f()\n\nThe R language definition: Promise objects:\n\nPromise objects are part of R’s lazy evaluation mechanism. They contain three slots: a value, an expression, and an environment. When a function is called the arguments are matched and then each of the formal arguments is bound to a promise. The expression that was given for that formal argument and a pointer to the environment the function was called from are stored in the promise.\n\n\nUntil that argument is accessed there is no value associated with the promise. When the argument is accessed, the stored expression is evaluated in the stored environment, and the result is returned. The result is also saved by the promise. The substitute function will extract the content of the expression slot. This allows the programmer to access either the value or the expression associated with the promise.\n\n\nf &lt;- function(x = 1, y = x * 10) {\n  x &lt;- x*3\n  return(c(x, y))\n}\nf()\n\n\nA promise is only evaluated once\n\n\nf1 &lt;- function(x) {\n  print(\"f1 called\")\n  return(x + 10)\n}\n\nf2 &lt;- function(y) {\n  return(c(y, y))\n}\n\nf3 &lt;- function(y) {\n  return(c(f1(y), f1(y))) # 2 promises\n}\n\nf2(f1(100)) # 1 promise\nf3(100)\n\nTake a look at the save function again to see how it prompts an error when no file name is specified by the user.\n?save",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Function</span>"
    ]
  },
  {
    "objectID": "chap_01/function.html#base-r-functions",
    "href": "chap_01/function.html#base-r-functions",
    "title": "3  Function",
    "section": "3.9 Base R functions",
    "text": "3.9 Base R functions\n\n3.9.1 Math functions\n\nabs(-1)    # absolute value\nsqrt(2)    # squre root\n\npi         # the number pi\n\nround(pi, digit = 3) # ?round\nceiling(pi)\nfloor(pi)\ntrunc(pi)\nsignif(pi)\n\ncos(pi/3)   # ?trig\nsin(pi/6)\ntan(pi/4)\n\nexp(pi)     # ?log\nlog(1)\nlog(exp(1))\nlog10(10)\n\nchoose(n = 10, k = 2)\nfactorial(4)\n\n\n\n3.9.2 String functions\n\n# concatenation\npaste(\"a\", \"b\", \"c\")\npaste(\"a\", \"b\", \"c\", sep = \"-\")\npaste0(\"a\", \"b\", \"c\")\n\n# sub string\nsubstr(\"abcdefg\", start = 2, stop = 4)\n\n# pattern matching\ngrep(\"cd\", c(\"iii\", \"abcde\", \"ooo\"), fixed = TRUE)\ngrepl(\"cd\", c(\"iii\", \"abcde\", \"ooo\"), fixed = TRUE)\n\n# substitution\ngsub(\"[c,o]\", \"-\", c(\"iii\", \"abcde\", \"ooo\"))\n\n# case\ntolower(\"ApPle\")\ntoupper(\"ApPle\")\n\n# number of characters\nnchar(\"apple\")",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Function</span>"
    ]
  },
  {
    "objectID": "chap_01/function.html#exercises",
    "href": "chap_01/function.html#exercises",
    "title": "3  Function",
    "section": "Exercises",
    "text": "Exercises\nSee Section 8.1 for exercises on writing simple functions.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Function</span>"
    ]
  },
  {
    "objectID": "chap_01/control_flow.html",
    "href": "chap_01/control_flow.html",
    "title": "4  Control Flows",
    "section": "",
    "text": "4.1 Choice\nSo far, the functions we wrote (IsEven, IsMonth, IsLeapYear) are simple enough in that their return values are straightforward logical combinations of arithmetic operations. Therefore, we are able to implement all three functions with a sequence of operators. In reality, the logic required of a function is often more complex, and control flow statements are needed.\nControl flow statements defines the order in which functions are executed. Each programming language differs slightly in its implementation of control flows. We give introduction to the commonly used control flow statements used in R.\nRecommended readings:\nWe have IsLeapYear which identifies a leap year. Based on the return value from IsLeapYear, we need to choose between 365 and 366 as the return value for DaysInYear. Its logic can be illustrated with a flow chart:",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Control Flows</span>"
    ]
  },
  {
    "objectID": "chap_01/control_flow.html#choice",
    "href": "chap_01/control_flow.html#choice",
    "title": "4  Control Flows",
    "section": "",
    "text": "Example: Implement a function DaysInYear that returns the number of days in a given year. (A year has 365 days except for when it is a leap year when it has 366 days)\n\n\n\n\n\nFlow chart for DaysInYear\n\n\n\n4.1.1 if, else, else if\n\nDaysInYear &lt;- function(x) {\n  if (IsLeapYear(x)) {\n    return(366)\n  } else {\n    return(365)\n  }\n}\nDaysInYear(2000)\nDaysInYear(1999)\n\nThe use of if…else statement creates two branches of code that are selectively executed upon the evaluation of a condition. i.e. A choice is made between two options.\nWhat if we have more than two options to choose from?\n\nExample: A customer gives a score between 0 and 10 as to rate a service received. And the following function GradeServiceScore translates the score to 3 levels of grades:\n\n\nGradeServiceScore &lt;- function (score) {\n  if (score &gt;=7) {\n    return(\"Satisfied\")\n  } else if (score &gt;= 4) {\n    return(\"Neutral\")\n  } else {\n    return(\"Dissatisfied\")\n  }\n}\nGradeServiceScore(10)\nGradeServiceScore(4.5)\nGradeServiceScore(-100)\n\nNote the last else can be omitted:\n\nGradeServiceScore &lt;- function (score) {\n  if (score &gt;=7) {\n    return(\"Satisfied\")\n  } else if (score &gt;= 4) {\n    return(\"Neutral\")\n  }\n  #\n  return(\"Dissatisfied\")\n}\nGradeServiceScore(10)\nGradeServiceScore(4.5)\nGradeServiceScore(-100)\n\n\n\n4.1.2 Revisit IsLeapYear\nLet’s have a look back at our implementation of IsLeapYear:\n\nIsLeapYear &lt;- function (x) {\n    return (x %% 400 == 0 || (x %% 4 == 0 && x %% 100 != 0))\n}\n\nThe return value is dependent on the evaluation of these 3 conditions:\n\nx %% 400 == 0\nx %% 4 == 0\nx %% 100 != 0\n\nInstead of using logical operators (&&, ||), we can use if, else, and else if statements to branch the code instead:\n\n# One of the following two implementations is incorrect. Can you spot the bug?\n\nIsLeapYear &lt;- function (x) { # implementation A\n  if (x %% 400 == 0) {\n    return(TRUE)\n  } else if (x %% 4 == 0) {\n    if (x %% 100 != 0) {\n      return(TRUE)\n    } \n  }\n  return(FALSE)\n}\n\nIsLeapYear &lt;- function (x) { # implementation B\n  if (x %% 400 == 0) {\n    return(TRUE)\n  } else if (x %% 4 == 0) {\n    if (x %% 100 != 0) {\n      return(TRUE)\n    } else {\n      return(FALSE)\n    }\n  }\n}\n\n\nQuestion: What is the difference between these two implementations, and which one is better? How would you update our implementation of DaysInYear based on the same philosophy?",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Control Flows</span>"
    ]
  },
  {
    "objectID": "chap_01/control_flow.html#loops",
    "href": "chap_01/control_flow.html#loops",
    "title": "4  Control Flows",
    "section": "4.2 Loops",
    "text": "4.2 Loops\n\n4.2.1 :\nBefore we start using loops, let’s introduce the colon operator :. The colon operator is used to generate a regular sequence of numbers.\n\n1:5\n4.3:10.7\n10:4\n\n[1] 1 2 3 4 5\n[1]  4.3  5.3  6.3  7.3  8.3  9.3 10.3\n[1] 10  9  8  7  6  5  4\n\n\n\n\n4.2.2 for\n\nExample: Print all leap years between two given years.\n\n\nPrintLeapYearsBetween &lt;- function (from_year, to_year) {\n  for (year in from_year:to_year) {\n    if(IsLeapYear(year)) {\n      print(year)\n    }\n  }\n}\nPrintLeapYearsBetween(1990, 2018)\n\n?print - prints its argument\n\n\n4.2.3 next, break\n\nPrintLeapYearsBetween &lt;- function (from_year, to_year) {\n  for (year in from_year : to_year) {\n    if(!IsLeapYear(year)) {\n      next\n    }\n    print(year)\n  }\n}\nPrintLeapYearsBetween(1990, 2018)\n\n\nPrintNextLeapYear &lt;- function (from_year) {\n  for (year in from_year : (from_year + 10)) { # search the next 10 years max\n    if(IsLeapYear(year)) {\n      print(year)\n      break\n    }\n  }\n}\nPrintNextLeapYear(1993)\n\n\n\n4.2.4 while\n\nExample: Write a function that print a number (default 5) of leap years from a given year.\n\n\nPrintNextLeapYears &lt;- function(from_year, num_wanted = 5) {\n  num_printed &lt;- 0\n  year &lt;- from_year\n  while (num_printed &lt; num_wanted) {\n    if (IsLeapYear(year)) {\n      print(year)\n      num_printed &lt;- num_printed + 1\n    }\n    year &lt;- year + 1\n  }\n}\nPrintNextLeapYears(1990)\nPrintNextLeapYears(1990, 3)",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Control Flows</span>"
    ]
  },
  {
    "objectID": "chap_01/control_flow.html#exception-handling",
    "href": "chap_01/control_flow.html#exception-handling",
    "title": "4  Control Flows",
    "section": "4.3 Exception handling",
    "text": "4.3 Exception handling\n\n4.3.1 stop(\"mesg.\")\n\nf &lt;- function() g()\ng &lt;- function() h()\nh &lt;- function() stop(\"This is an error!\")\nf()\n\n\n?stopifnot - if any of the expressions is not TRUE, then stop is called.\n\n\na &lt;- 5\nstopifnot(a &lt; 10, \"c\" &gt; \"a\", a^2 &lt; 30)\na &lt;- 15\nstopifnot(a &lt; 10, \"c\" &gt; \"a\", a^2 &lt; 30) # note the lazy evaluation\n\n\n\n4.3.2 warning(\"mesg.\")\n\nfw &lt;- function() {\n  cat(\"1\\n\")\n  warning(\"W1\")\n  cat(\"2\\n\")\n  warning(\"W2\")\n  cat(\"3\\n\")\n  warning(\"W3\")\n}\nfw()\n\n1\n2\n3\nWarning messages:\n1: In fw() : W1\n2: In fw() : W2\n3: In fw() : W3\n\n\n\n4.3.3 message(\"mesg.\")\n\nprint(\"message printed\")\ncat(\"message cat-ed\\n\")\nmessage(\"message message\")\n\n\n\n\nScreenshot: different outputs from print, cat, and message\n\n\nYou should use print and cat for messages that you, the writer of the code, want to read deliberately. message is for reminding the user, not the developer, that the program has done something. Logs of a web application is a good example of things better printed with message. After all, message is the brother of stop and warning to react and indicate the conditions of the system.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Control Flows</span>"
    ]
  },
  {
    "objectID": "chap_01/control_flow.html#exercises",
    "href": "chap_01/control_flow.html#exercises",
    "title": "4  Control Flows",
    "section": "Exercises",
    "text": "Exercises\nSee Section 8.2 for more exercises on writing functions using control flows.",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Control Flows</span>"
    ]
  },
  {
    "objectID": "chap_01/environments.html",
    "href": "chap_01/environments.html",
    "title": "5  Environments",
    "section": "",
    "text": "5.1 .GlobalEnv\nEnvironments consist of a frame, or collection of named objects, and a pointer to an enclosing environment. The most common example is the frame of variables local to a function call; its enclosure is the environment where the function was defined (unless changed subsequently). The enclosing environment is distinguished from the parent frame: the latter (returned by parent.frame) refers to the environment of the caller of a function.\nRecommended readings:\nThe global environment is the workspace where you interact with R. When you type an expression in the console, it is evaluated in the global environment. When you create a variable or a function, it is stored in the global environment. The global environment is also the top-level environment of the search path.\nf &lt;- function(x) { #\"top level function\"\n  return(x * 2)\n}\n\n##-- all five give the same:\nenvironment()   # current environment\nenvironment(f)\n\n.GlobalEnv\nglobalenv()\nsys.frame()\n\nidentical(environment(), globalenv())\n\nis.environment(.GlobalEnv) # TRUE\nWhen a function is called, the R interpreter searches the implementation of the function along the search path\nsearch()\nOnce a new package is attached, it is added to the top of the search path, just behind GlobalEnv:\nlibrary(\"ggplot2\")\nsearch()",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Environments</span>"
    ]
  },
  {
    "objectID": "chap_01/environments.html#globalenv",
    "href": "chap_01/environments.html#globalenv",
    "title": "5  Environments",
    "section": "",
    "text": "image source",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Environments</span>"
    ]
  },
  {
    "objectID": "chap_01/environments.html#create-an-environment",
    "href": "chap_01/environments.html#create-an-environment",
    "title": "5  Environments",
    "section": "5.2 Create an environment",
    "text": "5.2 Create an environment\n\nnew.env, creates a new environment\nls, returns a vector of all object (function and variable) names in an environment.\nrm, removes objects from a specified environment\n\n\ne &lt;- new.env()\nparent.env(e)\n\ne$x &lt;- 5\nassign(\"y\", 3, envir = e)\nls(e)\nis.null(e$x)\nis.null(e$y)\nis.null(e$z)\n\ne$y &lt;- NULL\nls(e)\n\nrm(y, envir = e)\nls(e)\n\nrm(list = ls()) # clear all in current environment\n\nls gives information about what’s available in a package\n\nls(\"package:graphics\")",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Environments</span>"
    ]
  },
  {
    "objectID": "chap_01/environments.html#parent",
    "href": "chap_01/environments.html#parent",
    "title": "5  Environments",
    "section": "5.3 Parent",
    "text": "5.3 Parent\nDifferent environments can be linked together by setting the parent environment of one environment to another. When looking for an object, R will first look in the current environment, and if it doesn’t find it, it will look in the parent environment, and so on until it reaches the empty environment.\n\nftl &lt;- function(x) { #\"top level function\"\n  return(x * 2)\n}\n\ne1 &lt;- new.env()\ne2 &lt;- new.env(parent = e1)\nassign(\"a\", 3, envir = e1)\nls(e1)\nls(e2)\nexists(\"a\", envir = e2)   # this succeeds by inheritance\nexists(\"a\", envir = e2, inherits = FALSE)\nis.null(e2$a)\nexists(\"ftl\", envir = e2) # this succeeds by inheritance\nexists(\"ftl\", envir = e2, inherits = FALSE)",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Environments</span>"
    ]
  },
  {
    "objectID": "chap_01/environments.html#with",
    "href": "chap_01/environments.html#with",
    "title": "5  Environments",
    "section": "5.4 .with",
    "text": "5.4 .with\n\na &lt;- 10\ne &lt;- new.env()\ne$a &lt;- 5\nr &lt;- with(e, {\n  print(paste(\"a =\", a, \"(with-e)\"))\n  a &lt;- 55\n  a + 500\n})\nprint(paste(\"e$a =\", e$a))\nprint(paste(\"a =\", a))\nprint(paste(\"r =\", r))\n\n\nwith can be used with both environments and list data structures that we will see in the next lecture\n\n\nx &lt;- 11\nl &lt;- list(x = 1, y = 2)\nwith(l, {\n  print(x)\n})\nprint(x)",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Environments</span>"
    ]
  },
  {
    "objectID": "chap_01/packages.html",
    "href": "chap_01/packages.html",
    "title": "6  Packages",
    "section": "",
    "text": "When it comes to sharing your code with others, you may:\n\nShare an .R script\nShare an .RData image\nBuild and share a package\nPackages we used already: dplyr, tidyr, lubridate, foreign\n\n\nA package bundles together code, data, documentation, and tests, and is easy to share with others. As of June 2019, there were over 14,000 packages available on the Comprehensive R Archive Network, or CRAN, the public clearing house for R packages. This huge variety of packages is one of the reasons that R is so successful: the chances are that someone has already solved a problem that you’re working on, and you can benefit from their work by downloading their package. - Chapter 1 Introduction, R Packages\n\n\nsessionInfo()\n\nSO: In R, what does “loaded via a namespace (and not attached)” mean?\n\nCRAN - R\n\nCPAN - Perl\nPyPI, Conda - Python\nnpm - JavaScript\nAs of Sep. 2021:\n\nthere are over 18,000 packages indexed on MetaCRAN.\nggplot2 is the most downloaded package\nknir is the most depended upon package\n\n\nMany more packages are available on Github\n\n\n\nTidyverse is a collection of R packages\n\ntibble, tidyverse’s data frame\nggplot2, graphics\ndplyr, data manipulation\ntidyr, data tidying\n…\nsimilar to pandas for Python\n\nTo see where your packages are saved on the computer: .libPaths()\nTo list all packages available on the computers: lapply(.libPaths(), dir)\nWith package x:\n\ninstall.packages(\"x\") to install from CRAN\nlibrary(\"x\") to use the package\npackage?x to get help\n\npackage?graphics\npackage?ggplot2\n\nUse cheat sheets\n\nTo create a package ?devtools::create\nA package has its own environment (see Fundamentals II)\n\nls(\"package:x\") lists all objects in that package\ne.g. ls(\"package:graphics\")",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Packages</span>"
    ]
  },
  {
    "objectID": "chap_01/code_style.html",
    "href": "chap_01/code_style.html",
    "title": "7  Coding Style",
    "section": "",
    "text": "A good coding style is essential for ensuring the correctness of the program, and its maintainability. It is one of the elements included in the assessment of the technical work attached to essays and the dissertation on the MGH course.\nWe recommend that you read follow two style guides:\n\nTidyverse style guide https://style.tidyverse.org/\nGoogle’s R Style Guide https://google.github.io/styleguide/Rguide.html\n\nYou will see that Google’s guide is essentially a note on top of the Tidyverse guide. We agree with Google when there is a conflict between the two guides.\nOne place that our advice differ from Google’s guide is the convention for naming functions. We use the func_name_of_my_function format when naming our R functions. i.e. a function’s name should always begin with func_ as a prefix, and the whole name is in small_snake_case.\nThe file that contains the definition of the function should have identical name as the function. i.e. definition of a function named func_abc should be given in a file named func_abc.R.\nCase styles\n\ncamelCase, lowerCamelCase\nBigCamelCase, PascalCase\nsnake_case",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Coding Style</span>"
    ]
  },
  {
    "objectID": "exercises/exercises_all_1.html",
    "href": "exercises/exercises_all_1.html",
    "title": "8  Exercises I",
    "section": "",
    "text": "8.1 Exercises 1: Writing functions",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Exercises I</span>"
    ]
  },
  {
    "objectID": "exercises/exercises_all_1.html#sec-exercises-1",
    "href": "exercises/exercises_all_1.html#sec-exercises-1",
    "title": "8  Exercises I",
    "section": "",
    "text": "E1.1 IsMonth\nWrite a function IsMonth which takes a single numerical value as input and returns TRUE iff that value may represent a month of the year.\n\nIsMonth &lt;- function (x) {\n    # your code goes here\n}\n# Check if your implementation is correct with the followings\nIsMonth(12.9) # FALSE\nIsMonth(12)   # TRUE\nIsMonth(1)    # TRUE\nIsMonth(-10)  # FALSE\n\n\n\nE1.2 IsLeapYear\nWrite a function IsLeapYear which takes a single numerical value as input and returns TRUE iff that value may represent a leap year. A leap year occurs on any year evenly divisible by 4, but not on a century unless it is divisible by 400.\n\nIsLeapYear &lt;- function (x) {\n    # your code goes here\n}\n# Check if your implementation is correct with the followings\nIsLeapYear(2000) # TRUE\nIsLeapYear(1900) # FALSE\n\n\n\nE1.3 Bmi\nWrite a function Bmi which calculates the Body Mass Index (BMI) given weight (in kilograms) and height (in meters) as inputs.\n\\[bmi =\\frac{weight}{height^2}\\]\n\nBmi &lt;- function(weight, height) {\n  # your code goes here\n}\n# Check if your implementation is correct with the followings\nBmi(weight = 90, height = 1.75) # 29.38776\n\n\n\nE1.4 FeetToMeters\nWrite a function FeetToMeters which converts a numeric value in feet to meters. Given \\[1 ~ feet = 0.3048 ~ meters\\]\n\nFeetToMeters &lt;- function(ft) {\n  # your code goes here\n}\n# if your code is correct, this expression should evaluate to TRUE\nall.equal(FeetToMeters(10), 3.048) \n\n\n\nE1.5 SqFeetToSqMeters\nUse your implementation of FeetToMeters to convert a numeric value from square feet to square meters.\n\nSqFeetToSqMeters &lt;- function(sq_ft) {\n  # your code goes here\n}\n# if your code is correct, this expression should evaluate to TRUE\nall.equal(SqFeetToSqMeters(100), 9.290304)",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Exercises I</span>"
    ]
  },
  {
    "objectID": "exercises/exercises_all_1.html#sec-exercises-2",
    "href": "exercises/exercises_all_1.html#sec-exercises-2",
    "title": "8  Exercises I",
    "section": "8.2 Exercises 2: Control flow",
    "text": "8.2 Exercises 2: Control flow\n\nE2.1 SumMultiples\nProblem 1, Project Euler: If we list all the natural numbers below 10 that are multiples of 3 or 5, we get 3, 5, 6 and 9. The sum of these multiples is 23. Write a function SumMultiples to find the sum of all the multiples of 3 or 5 below 1000.\n\nSumMultiples &lt;- function(factor_1 = 3, factor_2 = 5, threshold = 1000) {\n  # your code goes here\n}\n# test your code with the following calls\nSumMultiples(threshold = 10) # 23\nSumMultiples() # 233168\n\n\n\nE2.2 SumEvenFib\nProblem 2, Project Euler: Each new term in the Fibonacci sequence is generated by adding the previous two terms. By starting with 1 and 2, the first 10 terms will be:\n\\[1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...\\]\nBy considering the terms in the Fibonacci sequence whose values do not exceed four million, find the sum of the even-valued terms.\n\nSumEvenFib &lt;- function(max_fib) {\n  # your code goes here\n}\n# test your code with the following calls\nSumEvenFib(4e6) # 4613732\n\n\n\nE2.3 Hadley, 6.6.1.1\nHadley, 6.6.1.1: Explain the following results:\n\nsum(1, 2, 3)  # 6\nmean(1, 2, 3) # 1\n\nsum(1, 2, 3, na.omit = TRUE)  # 7\nmean(1, 2, 3, na.omit = TRUE) # 1\n\n\n\nE2.4 Hadley, 6.5.4.3\nHadley, 6.5.4.3: Without running the following code, answer the questions in the comment:\n\ny &lt;- 10\nf1 &lt;- function(x = {y &lt;- 1; 2}, y = 0) {\n  return(x + y)\n}\nx &lt;- f1() # 1. what is the value of x here?\ny         # 2. what is the value of y here?\n\n\n\nE2.5 IsPalindrome\nA palindrome is a sequence of characters which reads the same backward as forward. A number is a palindrome if its value is the same if it were written backwards. For example, 121, 53935, 11 are all palindrome numbers.\nWrite a function IsPalindrome which takes an integer x as input and returns TRUE iff it is a palindrome.\n\nIsPalindrome &lt;- function(x) {\n  # your code\n}\nstopifnot(\n  IsPalindrome(0)    &&\n  IsPalindrome(1)    &&\n  IsPalindrome(11)   &&\n  IsPalindrome(121)  &&\n  IsPalindrome(5412145)  &&\n  !IsPalindrome(-121) &&\n  !IsPalindrome(1231) &&\n  !IsPalindrome(123)\n)\nprint(\"Passed all tests\")\n\n\n\nE2.6 MaxPalindrome\nProblem 4, Project Euler The largest palindrome made from the product of two 2-digit numbers is 9009 = 91 × 99. Find the largest palindrome made from the product of two 3-digit numbers.\n\nMaxPalindrome &lt;- function() {\n  # your code\n}\nprint(MaxPalindrome()) # 906609",
    "crumbs": [
      "Language Basics",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Exercises I</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html",
    "href": "chap_02/containers_01.html",
    "title": "9  Homogeneous Types",
    "section": "",
    "text": "9.1 Overview\nIf you have experiences in programming languages such as C/C++, Java, you are probably wondering why we have not said anything about primitive types such as int, float, and boolean yet? And how are we going to introduce data structures, such as vectors, without defining scalar types first?\nRecommended readings:",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#overview",
    "href": "chap_02/containers_01.html#overview",
    "title": "9  Homogeneous Types",
    "section": "",
    "text": "Atomic vectors are the primitive types in R\nData of different types may be coerced into another type\nAttributes add context to atomic vectors\nMatrices are atomic vectors with dim attribute\nClass is attribute of atomic vectors\nAll values in vectors are of the same type\nLists are collections of vectors of varying type and length\n\n\n\n\nDiagram: data structures in R",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#atomic-vectors",
    "href": "chap_02/containers_01.html#atomic-vectors",
    "title": "9  Homogeneous Types",
    "section": "9.2 Atomic vectors",
    "text": "9.2 Atomic vectors\nThe most basic data type in R is the atomic vector, also referred to as the basic vector or simply as vector. Atomic vector is the primary data type of R. This is different from other programming languages such as C and Java who has scalar types. (See SEXP if you want to dig deeper under the hood of R.)\n\nThere are no 0-dimensional types in R. Individual numbers or strings, which appear to be scalars, are vectors of length one.\n\nSee Scalar and vectors if you are not sure of these terms.\n\na &lt;- 1.0     # a appears to be a scalar\nis.vector(a) # a is a vector of length 1\n\n\n\"abc\"[1]   # first element of a character vector of length 1\n100[1]   # first element of a numerical vector of length 1",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#c-function",
    "href": "chap_02/containers_01.html#c-function",
    "title": "9  Homogeneous Types",
    "section": "9.3 c function",
    "text": "9.3 c function\nFunction c combines values to form a new (atomic) vector.\n\na &lt;- c(1, 2, 3)\nb &lt;- c(a, 4, 5, 6)\nc &lt;- c(a, 10, 10, a)\nd &lt;- c(c(11, 12, 13), 10, a)\nd\n\n[1] 11 12 13 10  1  2  3\n\n\n\nHave you noticed the [1] which is always at the beginning of the output? Have you asked yourself what it is for? This next example will give you the answer.\n\nLet’s practice using the for loop\n\nb &lt;- 1 \nfor (ii in 1:100) {\n  b &lt;- c(b, ii)\n}\nb\n\nWhen only one element is given to c, the resulting value is the same as if a scalar value is given:\n\na &lt;- c(1)\nb &lt;- 1\nidentical(a, b)\n\nWhen no inputs are given, c() returns NULL (see [Examples of missing values]).\n\na &lt;- c()\nis.null(a)\n\nThe length of the vector can be obtained and set by the length function:\n\na &lt;- c(1, 2, 3)\nd &lt;- c(c(11, 12, 13), 10, a)\nlength(d)\nprint(d)\nlength(d) &lt;- length(d) - 3 # remove the last 3 elements from the vector\nprint(d)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#base-types",
    "href": "chap_02/containers_01.html#base-types",
    "title": "9  Homogeneous Types",
    "section": "9.4 Base types",
    "text": "9.4 Base types\nAs the primary data structure of R, an atomic vector is an ordered collection of values of the same kind (as opposed to [Lists]). There are 4 commonly used atomic vector types in R:\n\ndouble, the default type R use to store (real) numeric values. 10, 3.6, 2.67e5\ninteger, whole numbers. 10L, 2.67e5L, from:to\ncharacter, texts \"abc\", \"column_a\"\nlogical, TRUE, FALSE\n\n\nd &lt;- 2.9\ni &lt;- 4L\ns &lt;- \"abc\"\nb &lt;- TRUE\ntypeof(d) # typeof prints the type of an object. Type `?typeof` for documentation\ntypeof(i)\ntypeof(s)\ntypeof(b)\n\n\n9.4.1 double\n\n?double - R has no single precision data type. All real numbers are stored in double precision format.\n\n\nx &lt;- 10   # double is the default numeric type\ntypeof(x)\n\nNumeric literals can be written in decimal, scientific, or hexadecimal formats:\nDecimal format\n\nx &lt;- 2.9  # decimal format\ntypeof(x)\ntypeof(10)\ntypeof(10.0)\n\nScientific notation format\n\nx &lt;- 7.82e5 # scientific notation\nx\nx &lt;- 7.82e-10\nx # printed in scientific notation\noptions(scipen = 999) # switch off printing in scientific notation\nx # see how all the zeros are now printed, how many zeros do you see behind the decimal point?\noptions(scipen = 0) # reset scipen to default\nx # printed in scientific notation again\n\nHexadecimal format\n\nx &lt;- 0xb # 0x - hexadecimal numeric constants (base 16)\nx\nprint(0xA) # not case sensitive\n\nWhy are hexadecimal numbers prefixed with 0x?\n\n\n9.4.2 integer\n\n?integer - integer (vectors) exist so that data can be passed to C or Fortran code which expects them, and so that small integer data can be represented exactly and compactly. Note that  current implementations of R use 32-bit integers for integer vectors , so the range of representable integers is restricted to about +/-2*10^9 (2 billion)\n\n\nx &lt;- 5L # add L to the end to use integer\nx\ntypeof(x)\nx &lt;- 3.9e3L # also works with scientific notation\nx\ntypeof(x)\nx &lt;- 1:3 # &gt; ?`:`\nx # a sequence of integers from 1 to 3\ntypeof(x)\nlength(x)\n.Machine$integer.max # biggest integer that can be stored\n2^31\n\nFor more on the limitation of integers in R: R in a 64 bit world\n\n\n9.4.3 character\nA character vector is for storing text-based values. Each element of the vector is a string of characters.\n\ns &lt;- \"R\"      # s is a character vector of length 1\ns &lt;- \"Rrrr\"   # s is a character vector of length 1\ns &lt;- c(\"R\", \"is great\", \"!\") # s is a character vector of length 3\ns &lt;- \"\\\"abc\"\nprint(s)\ncat(s)\ncat(\"\\n\")\nnchar(s)      # number of characters\ntypeof(s)\ns &lt;- '\"abc'\ns\ns &lt;- \"'abc\"\ns\n\n\nConcatenate, sub-string, substitution\n\n\npaste(\"R\", \"is great\", \"!\")\npaste0(\"R\", \"is great\", \"!\")\n\n\nsubstr(\"Mary has a little lamb.\", start = 3, stop = 12)\nsub(\"little\", \"big\", \"Mary has a little lamb.\") \n\n\n\n9.4.4 logical\n\nl1 &lt;- c(TRUE, FALSE, FALSE)\nl2 &lt;- c(T, F, F)\nidentical(l1, l2)\n\nsum(c(T, F, F, T, T))\n\n\n\n9.4.5 Other types\nOther less commonly used data types also exist in R:\n\ncomplex, complex numbers in the form “a+bi”, 3+8i\nraw, raw bytes\n\n\na &lt;- raw(3) # a raw vector of length 3\na           # 00 00 00\na[1] &lt;- as.raw(11) # 0b 00 00 hexadecimal (base 16)\na[2] &lt;- as.raw(16)\na",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#type-test",
    "href": "chap_02/containers_01.html#type-test",
    "title": "9  Homogeneous Types",
    "section": "9.5 Type test",
    "text": "9.5 Type test\nTo get a logical value to indicate whether the value is of the desired type, we call on the following functions:\n\na &lt;- c(1L, 3, 10L)\nis.atomic(a)\nis.logical(a)\nis.integer(a)\nis.double(a)\nis.character(a)\nis.numeric(a)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#coercion",
    "href": "chap_02/containers_01.html#coercion",
    "title": "9  Homogeneous Types",
    "section": "9.6 Coercion",
    "text": "9.6 Coercion\n\nImplicit coercion (type promotion)\nExplicit coercion\n\n\n9.6.1 Implicit coercion\nRecall that all elements of a vector must share the same type. What happens when you put different types in the same c function?\n\nv &lt;- c(TRUE, 100L) # combine logical value with integer\nv\ntypeof(v)\nv &lt;- c(100, 100L) # combine double with integer\ntypeof(v)\nv &lt;- c(TRUE, \"abc\") # combine logical value with character string\ntypeof(v)\n\nWe can see that values from the more strict type is always coerced to the less strict type. For instance, when TRUE and 100L are combined, the logical TRUE is coerced to the integer value of 1L. This is because the integer type in this instance is able to present TRUE in its entirety, whereas the opposite is not possible. Following the same logic, we can rank the four atomic types as illustrated:\n\n\n\nCoercion ranks of atomic types\n\n\nValues of lower ranked type is coerced to the higher ranked type to preserve its value. This behaviour is similar to the implicit type casting in other languages such as C.\nImplicit coercion also happens in arithmetic operations\n\ntypeof(100L * 3.875)\ntypeof(15L + 15L * FALSE)\n\n\n\n9.6.2 Explicit coercion\nSometimes, we want to explicitly change the type of a vector from one type to another:\n\nas.character(54L)\nas.logical(6.5)\nas.logical(-6.5)\nas.logical(0)\nas.integer(\"100.10\")\nas.integer(100.1)\nas.character(NaN)\nas.double(\"481.9\")\nas.double(\"abc\")\n\ndouble and integer are referred to as numeric types in R.\n\ntypeof(as.numeric(\"101\"))\ntypeof(as.numeric(\"101L\"))",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#built-in-constants",
    "href": "chap_02/containers_01.html#built-in-constants",
    "title": "9  Homogeneous Types",
    "section": "9.7 Built-in constants",
    "text": "9.7 Built-in constants\nR has a few built-in constants:\n\nLETTERS\nletters\nmonth.abb\nmonth.name\npi\ntypeof(pi)\n\nThe names of these constants are not reserved words (see ?reserved) in R. The user can overwrite their values.\n\npi &lt;- 3",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#inf-and-nan",
    "href": "chap_02/containers_01.html#inf-and-nan",
    "title": "9  Homogeneous Types",
    "section": "9.8 Inf and NaN",
    "text": "9.8 Inf and NaN\nBoth Inf and NaN are of type double, both are reserved words (see ?reserved) in R.\n\n4 / 0             # infinity\n-4 / 0            # negative infinity\ntypeof(Inf)\nis.infinite(4)\nis.infinite(4 / 0)\nis.numeric(Inf)\n10 &lt; Inf\n10 &lt; -Inf\n\n0 / 0             # NaN, not a number\nInf - Inf         # NaN\nis.nan(4)\nis.nan(NaN)\ntypeof(NaN)\n\n\nNon-measurable vs Not-measured\n“You know it, I know it, everyone knows it.” - Inf, NaN\n“I don’t know”\n\nNA - (going crazy face), “I don’t know why I don’t know.”\nNULL - (calm face), “I know that I don’t know.”",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#na-and-null",
    "href": "chap_02/containers_01.html#na-and-null",
    "title": "9  Homogeneous Types",
    "section": "9.9 NA and NULL",
    "text": "9.9 NA and NULL\nIn R, NA and NULL are the two keywords that are used in relation to the null problem (See null in computers).\n\nBoth NA and NULL are used to represent nothing ( missing or undefined values).\nNA is the logical constant representing the indeterminate logic state.\n\nSee documentation:\n\n?NA - “Not Available” / Missing Values, NA is a logical constant of length 1 which contains a missing value indicator. NA can be coerced to any other vector type except raw. There are also constants NA_integer_, NA_real_, NA_complex_ and NA_character_ of the other atomic vector types which support missing values: all of these are reserved words in the R language.\n\n\n?NULL - The Null Object, NULL represents the null object in R: it is a reserved word. NULL is often returned by expressions and functions whose value is undefined.\n\n\ntypeof(NA)            # the third logic state (not TRUE, and not FALSE)\ntypeof(NA_integer_)   # NA is designed to fit-in with all atomic types\ntypeof(NA_real_)\ntypeof(NA_character_)\n\ntypeof(NULL)          # NULL is its own thing (SEXPTYPE # 0 NILSXP)\n# others\ntypeof(NaN)           # double\ntypeof(Inf)           # double\n\nTesting for NA and NULL:\n\nis.na(NA)\nis.null(NULL)\n\n\n9.9.1 Missing values\nWith NA:\n\nc(1,2,3)[4] # index out of range\n\n[1] NA\n\na &lt;- c(1, 2, 3)\nlength(a) &lt;- 100\na # positions 4 ~ 100 undefined\n\n  [1]  1  2  3 NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA\n [26] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA\n [51] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA\n [76] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA\n\n\nWith NULL\nNULL represents - undefined values, declare a name that’s yet to be defined\n\nx &lt;- 1:6\ndim(x)  # try to get the dim attribute of x\n\n\nx &lt;- c(a = 1, b = 2, c = 3)\nx\nnames(x) &lt;- NULL # remove the names attribute of x\nx\n\n\nf &lt;- function(){if(FALSE){1}}\na &lt;- f()\na\n\nNULL can be useful as a placeholder:\n\nv1 &lt;- c(1, 2, 3)\n# v2 &lt;- NULL # same as v2 &lt;- c()\nfor (ii in 1:10) {\n  v2 &lt;- c(v2, v1)\n}\n\n\n\n9.9.2 Indeterminate state\nNA represents logical indeterminacy, a third state that is neither TRUE nor FALSE\n\nNA * 11\nsum(c(NA, 1, 2, 3))\nNA && TRUE\nNA || FALSE\nNA &gt; 1\nNA == NA\nNA != NA\nis.na(NA)\n\nNaN == NaN\nNA == NaN\n\nOperations on NA does not necessarily produce NA:\n\nNA || TRUE\nNA && FALSE\nlength(c(NA, NA))",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#attributes",
    "href": "chap_02/containers_01.html#attributes",
    "title": "9  Homogeneous Types",
    "section": "9.10 Attributes",
    "text": "9.10 Attributes\n\n9.10.1 Context matters\nAtomic vectors are linear 1-dimensional data structures. As the primitive types of the language, atomic vectors are designed to hold units of data of different type. However, data by itself doesn’t tell the full story. Take this definition of a numeric vector as an example:\n\nd &lt;- c(10, 22, 35)\n\nWhat does the values in d represent? The number of students in three classes? The age of three patients in a clinic? The number of flu cases in three clinics?\nThe description of data (meta data) gives meaning to the data, it transforms data to information. The same piece of data can be interpreted completely differently given different meta descriptions (i.e. context).\nContext matters, just as in human language:\n\n\n\n\n\nIllustration: context matters\n\n\n\n\n9.10.2 Add attributes\nIn R, attributes may be added to the data structure to provide the context. More complex data structures such as matrices are defined by adding attributes to atomic vectors.\nWe start by adding arbitrary attributes with attr:\n\nd &lt;- c(10, 22, 35)\nattr(d, \"city\") &lt;- \"oxford\" # set attribute city to the value of oxford\nattr(d, \"country\") &lt;- \"uk\"\nattr(d, \"data\") &lt;- \"flu cases\"\nstr(d)  # ?str - compactly display the structure of an arbitrary R object\n\n num [1:3] 10 22 35\n - attr(*, \"city\")= chr \"oxford\"\n - attr(*, \"country\")= chr \"uk\"\n - attr(*, \"data\")= chr \"flu cases\"\n\nattr(d, \"city\") # get the city attribute of object d\n\n[1] \"oxford\"\n\n\nTo retrieve all attributes of an object:\n\nattributes(d)\n\n$city\n[1] \"oxford\"\n\n$country\n[1] \"uk\"\n\n$data\n[1] \"flu cases\"\n\n\nIn R, two attributes are commonly used to structure vectors.\n\nnames - a character vector naming each element of the data vector.\ndim - an integer vector specifying the size of each dimension\n\n\n\n9.10.3 Names\nYou can name each of the data element with the names attribute:\n\nd &lt;- c(10, 22, 35)\nattr(d, \"names\") &lt;- c(\"class_a\", \"class_b\", \"class_c\")\nstr(d)\n\nBecause names is a special attribute that R understands, there are a few quicker ways to set it:\n\n# Set the names attribute when creating the vector:\nd &lt;- c(class_a = 10, class_b = 22, class_c = 35)\n\n# With the names function:\nd &lt;- c(10, 22, 35)\nnames(d) &lt;- c(\"class_a\", \"class_b\", \"class_c\")\n\n# With `setNames`\nd &lt;- setNames(c(10, 22, 35), c(\"class_a\", \"class_b\", \"class_c\"))\n\nOnce the data elements are named, you can retrieve elements using the name assigned to it.\n\nd[[\"class_a\"]]\n\nNames can be removed by unname or set names as NULL\n\nunname(d)\n\nd &lt;- c(class_a = 10, class_b = 22, class_c = 35)\nnames(d) &lt;- NULL\nd\n\n\n\n9.10.4 Dimensions (Matrix)\nMatrices are vectors with dim attributes\n\nd &lt;- c(1, 2, 3, 4, 5, 6)\nattr(d, \"dim\") &lt;- c(2, 3)\nd\nattr(d, \"dim\") &lt;- c(3, 2)\nd\n\nSame as names, there are quicker ways to construct matrices:\n\n# With the `matrix` function\nd &lt;- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, ncol = 3)\n\n# With the `dim` function\nd &lt;- c(1, 2, 3, 4, 5, 6)\ndim(d) &lt;- c(2, 3)\nd\n\nAs you can see, the default ordering in R is column-major:\n\n\n\nimage source\n\n\nThe byrow argument let you populate rows first:\n\nd &lt;- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, ncol = 3, byrow = TRUE )\nd\n\nWhat happens if you supply fewer elements than the matrix’s capacity?\n\nd &lt;- matrix(c(1, 2, 3, 4), nrow = 2, ncol = 3)\n\nWhat about now?\n\nd &lt;- matrix(c(1, 2, 3), nrow = 2, ncol = 3)\n\nWhat happens if you supply more elements than the matrix’s capacity?\n\nd &lt;- matrix(c(1, 2, 3, 4, 5, 6, 7, 8), nrow = 2, ncol = 3)\n\nWhat about now?\n\nd &lt;- matrix(c(1, 2, 3, 4, 5, 6, 7, 8), nrow = 1, ncol = 4)\n\n\nDon’t ignore warnings!\nDon’t rely on warnings!\n\n\n\n\n\n\nimage source\n\n\nThere are a few functions related to matrix operations (these also work with data frames).\n\nd &lt;- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, ncol = 3)\nt(d)       # transpose\ndiag(d)    # diagonal\nd * d      # element-wise multiplication (inner product)\nd %*% t(d) # matrix multiplication\n\nouter(1:10, 1:4) # outer product of two vectors\n1:10 %o% 1:4\n\nnrow(d) # get the number of rows\nncol(d) # get the number of columns\n\nrownames(d) &lt;- c(\"a\", \"b\")         # set row names\ncolnames(d) &lt;- c(\"c1\", \"c2\", \"c2\") # set column names, duplicates allowed\nd\n\nd[, \"c2\"] # only the first match is returned when dubplicates exist\n\n\nrownames(d) # get row names\ncolnames(d) # get column names\n\nd\nd1 &lt;- rbind(d, c(11, 12, 13)) # add a row\nd2 &lt;- cbind(d, c(21, 22))     # add a column\n\nrownames(d1)\ncolnames(d2)\n\nis.matrix(d)            # if the object is a matrix\n\nd3 &lt;- c(1, 2, 3)\nattr(d3, \"dim\") &lt;- c(3)\nis.matrix(d3)\nattr(d3, \"dim\") &lt;- c(1, 3)\nis.matrix(d3)\n\nOuter product of two vectors \\(v_1\\otimes v_2\\) is very useful to vectorise functions that require two inputs:\n\nv1 &lt;- 1:10\nv2 &lt;- 1:3\nouter(v1, v2, FUN = function(x, y){x + 2*y} )\n\nStructures with higher dimensions are referred to as array ()\n\nd1 &lt;- 1:12\nattr(d1, \"dim\") &lt;- c(2, 2, 3)\n\nd2 &lt;- array(1:12, c(2, 2, 3))\nidentical(d1, d2)\n\nis.matrix(d2)\nis.array(d2)\n\n\n\n9.10.5 Class\nFrom an implementation point of view, class is simply another attribute that can be added to vectors:\n\nv &lt;- c(1, 2, 3)\nattr(v, \"class\") &lt;- \"abc\"\n\nWhat makes the class attribute different from other attributes, is that a set of behaviours are associated with certain built-in classes that R recognises. This is similar to when setting the dim attribute to a vector:\n\na &lt;- 1:10\nattr(a, \"dim\") &lt;- c(2, 6) # R checks length of object against given dimensions\n\nWe give introduction to two built-in classes\n\nfactor - for categorical data\nDate - for date data\n\n\n9.10.5.1 Factor\nA factor is a vector of data that takes a small number of distinct values (i.e. categorical data).\n\nf &lt;- factor(c(\"apple\", \"banana\", \"coconut\", \"apple\", \"apple\", \"banana\"))\nstr(f)\ntypeof(f)\nattributes(f)\nlevels(f)\nclass(f)\n\nAs you can see, the underlying atomic type is integer, and it has levels attribute in addition to the class attribute. You can manually construct a vector of factors too:\n\nf2 &lt;- c(1L, 2L, 3L, 1L, 1L, 2L)\nattr(f2, \"levels\") &lt;- c(\"apple\", \"banana\", \"coconut\")\nattr(f2, \"class\") &lt;- \"factor\"\n\nidentical(f, f2)\n\ngl(n, k, length = n*k, labels = seq_len(n)) generate n factors (levels) each is repeated k times.\n\ngl(n = 4, k = 2, labels = c(\"apple\", \"banana\", \"coconut\", \"durian\"))\ngl(4, 1)\n\nA useful function that works well with factors is table which gives a summary of a vector of categorical values:\n\ntable(c(\"apple\", \"banana\", \"coconut\", \"apple\", \"apple\", \"banana\"))\ntable(rpois(100, 5))\n\ncut divides the range of x into intervals. Each interval is designated with a level.\n\ncut(1:10, breaks = 2)\ntable(cut(1:10, breaks = 2))\n\n\n\n9.10.5.2 Date\n\nd &lt;- Sys.Date()\ntypeof(d)\nattributes(d)\nas.numeric(d) # the numeric value represents the number of days since 1970-Jan-01 (Unix Epoch)\n\n\nd &lt;- as.Date(\"2021-01-12\")\nstr(d)\nd + 30\n\nd &lt;- as.Date(\"2021-01-12\", format = \"%Y-%d-%m\")\nd + 30\n\n\nd1 &lt;- as.Date(\"2020-02-25\", format = \"%Y-%m-%d\")\nd2 &lt;- as.Date(\"2020-03-25\", format = \"%Y-%m-%d\")\nl &lt;- d2 - d1\nl\ntypeof(l)\nattributes(l)\n\nDate format code\n\n\n\nCode\nValue\n\n\n\n\n%d\nDay of the month (decimal numeric)\n\n\n%m\nMonth (decimal numeric)\n\n\n%b\nMonth (abbreviated)\n\n\n%B\nMonth (full name)\n\n\n%y\nYear (2 digits)\n\n\n%Y\nYear (4 digits)\n\n\n\n\nweekdays(Sys.Date())\nmonths(Sys.Date())\nquarters(Sys.Date())\nformat(Sys.Date(), format = \"%d\")\n\n\nd &lt;- Sys.Date()\ntypeof(d)\nattributes(d)\nt &lt;- Sys.time()\ntypeof(t)\nattributes(t)\nas.POSIXct()",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#vector-arithmetic",
    "href": "chap_02/containers_01.html#vector-arithmetic",
    "title": "9  Homogeneous Types",
    "section": "9.11 Vector arithmetic",
    "text": "9.11 Vector arithmetic\nWhen we introduced operators earlier in the module, we were\n\nUsing numbers as if they were scalars\nLooping over values as if they were separate entities\n\nHaving learnt new things about R from this session, knowing that data structures of R are built on vectors, what do you think is the implication of this design?\nNow you know that 1 is actually a vector of length 1 the first and only element of which is the value 1, what does the expression 1 + 2 mean? Yes, you added two vectors (both of length 1) together. Therefore, all the operators in R operate assume input as vectors and gives vectors as outputs:\n\na &lt;- c(1, 3, 7, 9)\nb &lt;- c(2, 4, 6, 8)\n\na + b\na * b\nb %% a\na &lt; b\n\nAnd our Bmi function works with vectors too.\n\nBmi &lt;- function(weight, height) {\n  return(weight / height^2)\n}\nBmi(c(60:70), seq(1.7, 1.9, length.out = 11 ))\nBmi(60:70, 1.7)\n\nMeaning that when you have a list of inputs, you don’t need a for loop calling Bmi iteratively to get a list of outputs.\nNote the difference between the longer and shorter forms of & and |\n\nc(TRUE, TRUE) & c(TRUE, FALSE)\nc(TRUE, TRUE) && c(TRUE, FALSE)\n\nc(FALSE, TRUE) | c(FALSE, FALSE)\nc(FALSE, TRUE) || c(FALSE, FALSE)\n\n##ß Vectorize\n\nSome functions do not account for vector input.\nVectorize creates a function wrapper that vectorizes the action of its argument function.\n\n\n# We want to generate 15 random numbers from 3 poisson distributions\nrpois(5, c(7, 70, 700)) # rpois is not vectorised\n\nVrpois &lt;- Vectorize(rpois, c(\"n\", \"lambda\"))\nVrpois(5, c(7, 70, 700))\n# same as mapply(rpois, 5, c(7, 70, 700))",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#functional-programming",
    "href": "chap_02/containers_01.html#functional-programming",
    "title": "9  Homogeneous Types",
    "section": "9.12 Functional programming",
    "text": "9.12 Functional programming\nFunctions are first class objects in R:\n\nFunctions are printed just like a variable is\n\n\na &lt;- 1\na # value of a printed\n\nf &lt;- function(x, y) {\n  return(sum(x + y))\n}\nf # implementation of f printed\n\n\nFunctions can be passed on to another function like a variable:\n\n\nf &lt;- function(x, y, func) {\n  return(func(x + y))\n}\nf(1:2, 3:4, sum)\nf(1:2, 3:4, mean)\n\n\n9.12.1 The apply family\n\nm &lt;- matrix(1:20, nrow = 4)\nm\napply(m, MARGIN = 1, max)\napply(m, MARGIN = 2, max)\n\n\napply - Like its name suggests, apply applies a given function over a data structure, more specifically according to ?apply: it applies functions over array margins.\n\n\n\n\n\n\nimage source\n\n\n\nlapply loops the top level dimension and returns a list\nsapply simplifies the returned list from lapply if all elements in that list is of the same length\n\n\nlapply(1:10, sqrt)\nl &lt;- list( e1 = 1:10, e2 = 11:15, e3 = c(\"a\", \"b\"))\nlapply(l, FUN = max)\nunlist(lapply(l, FUN = max))\nsapply(l, FUN = max)\nidentical(unlist(lapply(l, FUN = max)), sapply(l, FUN = max))\n\n\nmapply is a multivariate version of sapply. mapply applies the function to the first elements of each argument, the second elements, the third elements, and so on. Arguments are recycled if necessary.\n\n\n# We want to generate 15 random numbers from 3 poisson distributions\nrpois(5, c(7, 70, 700)) # rpois is not vectorised\n\nmapply(rpois, 5, c(7, 70, 700))   # matrix is returned if possible\nmapply(rpois, 5:7, c(7, 70, 700)) # otherwise a list is returned\n\nOuter product of two vectors \\(v_1\\otimes v_2\\) is very useful to vectorise functions that require two inputs:\n\nv1 &lt;- 1:10\nv2 &lt;- 1:3\nouter(v1, v2, FUN = function(x, y){x + 2*y} )",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#arithmetic-precision",
    "href": "chap_02/containers_01.html#arithmetic-precision",
    "title": "9  Homogeneous Types",
    "section": "9.13 Arithmetic precision",
    "text": "9.13 Arithmetic precision\ndouble and integer are referred to as numeric types in R.\n\nis.numeric(123L)\nis.numeric(.123)\n\nMany experienced R users are able to write perfectly functioning R codes without knowing that there are two numeric types in R. R’s dynamic typing system (see Typing systems), and use of implicit conversion (see Coercion) make this possible. But knowing the difference between the two types and their implementation will help you diagnose your code when it is not working as intended. Take a look at the following example:\n\n(0.1 + 0.2) == 0.3 # what is the value of this expression? Is it what you are expecting?\n(.1 + .2) - .3\n\nRecall when we introduced relational operators (==, !=,…), we emphasized that only use these operators for integer values. What if we convert the doubles to integers?\n\n(0.1 + 0.2) * 10 == 0.3 * 10\nas.integer((0.1 + 0.2) * 10) == as.integer(0.3 * 10)\n\nAs stated in Why doesn’t R think these numbers are equal?, R FAQ :\n\nThe only numbers that can be represented exactly in R’s numeric type are integers and fractions whose denominator is a power of 2.\n\n\n?all.equal - The function all.equal() compares two objects using a numeric tolerance of .Machine$double.eps ^ 0.5. If you want much greater accuracy than this you will need to consider error propagation carefully.\n\n\nall.equal((0.1 + 0.2), 0.3)\n\nThe short answer to this question is precision. More precisely, the precision of the representation of fractions is limited in a computer.\n\nsprintf(\"%.30f\", 0.1 + 0.2) # sprintf is a wrapper for the identically named C function. see `?sprintf`\nsprintf(\"%.30f\", 0.3)\n\nYou can also use this website Decimal to binary converter IEEE 754 to see the binary representation of double typed values.\nFor the long answer, see 0.300…004.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#exercises",
    "href": "chap_02/containers_01.html#exercises",
    "title": "9  Homogeneous Types",
    "section": "Exercises",
    "text": "Exercises\nSee Section 15.1 for more exercises on usages of vectors.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_01.html#further-topics",
    "href": "chap_02/containers_01.html#further-topics",
    "title": "9  Homogeneous Types",
    "section": "9.14 Further Topics",
    "text": "9.14 Further Topics\nEvaluating the Design of the R Language, Objects and Functions For Data Analysis\n\n9.14.1 Scalar and vectors\n(More details on this topic will be provided in the “Mathematics for Modellers” module taking place in week 2.)\nWe illustrate the difference between scalars and vectors with this simple example in a 2-dimensional space:\n\n\n\nimage source\n\n\nIn the x-y space (2-dimensional) illustrated above, when considered independently, x and y are two scalar values. When combined, (x, y) defines the direction of the vector v in respect to the origin (where the two axis intersect).\nAnd of course, you can imagine in a 3-dimensional space (an x-y-z space), a vector is defined as v = (x, y, z). The list of values inside the parentheses gets longer as the number of dimensions of the space gets higher.\nIn some programming languages, vectors are referred to as arrays.\n\nDid you know that mosquitos are referred to as vectors in infectious disease modelling?\n\n\n\n9.14.2 Statement terminator\nThe code snippet below has three lines of code.\n\na &lt;- 1\nb &lt;- 2\nprint(a + b)\n\nIf we add ; at the end of each statement, we can write all three statements in one line of code:\n\na &lt;- 1; b &lt;- 2; print(a + b) # not good practice, don't do this\n\nIn programming languages, a syntax like ; is referred to as a statement terminator (or delimiter). As the name suggests, it indicates the end of a statement. In languages such as C and Java, ; is the only statement terminator, thus the use of ; is mandatory. In R (and Python, Javascript, Matlab …), additional to semicolons, a new line may indicate the end of a statement, therefore ; can be omitted in most cases.\n\n3.2 Control structures, R Language Definition: Both semicolons and new lines can be used to separate statements. A semicolon always indicates the end of a statement while a new line may indicate the end of a statement. If the current statement is not syntactically complete new lines are simply ignored by the evaluator. If the session is interactive the prompt changes from ‘&gt;’ to ‘+’.\n\nThe difference between a new line and a semicolon is that it only “may” be the end of a statement. This is why we can split a long statement into multiple lines without getting an error:\n\nl &lt;- list(\n  c(1, 2, 3),\n  1.2,\n  \"age\"\n)\n\nThis is good, but if you are used to program in a language in which a semicolon is mandatory, you need to be aware that a statement may end before you think it does:\n\na &lt;- 1 + 2 + 3 + 4\n   + 5 + 6 + 7 + 8    # what is the value of a?\n\n\n\n\n\n\nHave you found it yet?\n\n\n\n\n9.14.3 null in computers\nComputer programs have the tendency to frame everything in binary forms: the power is either on or off, a key on the keyboard is either pressed or not, a website is either online or offline. With a sequence of binary switches, all real numbers can be represented by their corresponding binary form. Surely, there is nothing left to cover, right?\nHold on, what about nothing ? What represents nothing?\nProgramming languages often refer to this nothing-ness using the word “null”. Unix systems have the dev/null device for dumping outputs, SQL uses NULL to indicate values missing from a database, a null pointer indicates that the target is not a valid object in languages such as C++.\n\n\n\n\n\nIllustration: Pointer and Null pointer\n\n\nIn the case of null pointer, its definition requires the guarantee that a null pointer does not compare equal to any pointer that point to a valid object. This is an example of the next layer of issue caused by this nothing-ness:\nMixing null value with other values often produces ambiguous results. This state is indeterminate, neither TRUE or FALSE. See Three-valued logic\nIn summary, to understand the use of NA and NULL, it is important to note the distinction between the two null-related issues computer programs have to deal with:\n\nMissing or undefined values\nIndeterminate logic state\n\nMore on this topic:\n\nR : NA vs. NULL\nThree-valued logic\nMissing Values in R\n\n\n\n9.14.4 Typing systems\nWiki: Type system\nSO: What is the difference between statically typed and dynamically typed languages?\nNote that in dynamically typed languages, values have types, not variables.\n\n\n9.14.5 SEXP\nR is primarily written in C, Fortran, and R itself. (R source code) The R software environment is a GNU package, and is freely available under the GNU General Public License. It is necessary to know something about how R objects are handled in C code. All the R objects you will deal with will be handled with the type SEXP, which is a pointer to a structure with typedef SEXREC.\nSymbolic-expression (SEXP) record (REC) structure, is a C structure underlying every R object, accessible via a pointer of type SEXP.\n\nSEXP is common in LISP-like language syntaxes it is a way to represent a nested list of data. For example, the simple mathematical expression “five times the sum of seven and three” can be written as a s-expression with prefix notation. In Lisp, the s-expression might look like (* 5 (+ 7 3)).\n\nSEXPREC is a variant type that can handle all the usual types of R objects, that is vectors of various modes, function, environments, language objects, etc.\nThe four atomic vector types correspond to four SEXP types:\n\nINTSXP : integer vectors\nREALSXP : double vectors\nCPLXSXP : complex vectors\nSTRSXP : character vectors\n\nNULL is defined with SEXPTYPE #0 NILSXP\nTo learn more on this topic:\n\n1.1.1 SEXPTYPEs, R Internals\nS-expression\nRcpp: Seamless R and C++ Integration. Matt P. Dziubinski, CppCon 2015\nramiromagno/c3po: From C to R and back again\n\n\n\n9.14.6 0.300…004\nSo you want to know more about this:\n\n(0.1 + 0.2) == 0.3\n\n[1] FALSE\n\n\nWhat is a floating point number and how is it different from an integer?\n\nFloating point numbers\nDecimal to IEEE 754 Floating Point Representation\nIEEE 754 Standard for Floating Point Binary Arithmetic\nDecimal to binary converter IEEE 754\n\nPrecision issue with floating point numbers:\n\nIs floating point math broken?\nFloating point math\nWhat Every Computer Scientist Should Know About Floating-Point Arithmetic\nR in a 64 bit world\n\nThe only numbers that can be represented exactly in R’s numeric type are integers and fractions whose denominator is a power of 2. :\n\nWhy doesn’t R think these numbers are equal?, R FAQ\nAppendix G “Computational Precision and Floating Point Arithmetic”, pages 753–771 of Statistical Analysis and Data Display: An Intermediate Course with Examples in R, Richard M. Heiberger and Burt Holland (Springer 2015, second edition)\n\nRelax … everything is working as intended :)\n\n\n\nxkcd 217 explained",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Homogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_02.html",
    "href": "chap_02/containers_02.html",
    "title": "10  Heterogeneous Types",
    "section": "",
    "text": "10.1 Lists\nlist, as.list, is.list, unlist",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Heterogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_02.html#lists",
    "href": "chap_02/containers_02.html#lists",
    "title": "10  Heterogeneous Types",
    "section": "",
    "text": "Atomic vectors are collections of values of the same type.\nLists are collections of vectors and lists. The vectors within this collection may be of any type, and of any length.\nLists are recursive, meaning a list can be an element of a list.\n\n\n\n\n\n\nimage source",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Heterogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_02.html#creation",
    "href": "chap_02/containers_02.html#creation",
    "title": "10  Heterogeneous Types",
    "section": "10.2 Creation",
    "text": "10.2 Creation\nTo create a list, we use the list function:\n\nl1 &lt;- list(    # l is a list of 3 elements\n  1:3,            # 1. an integer vector of length 3\n  \"abc\",          # 2. a character string vector of length 1\n  c(1.2, 3.8)     # 3. a double vector of length 2\n)\nl1\ntypeof(l1)\n\nA list can be an element of a list:\n\nl2 &lt;- list(    # l is a list of 2 elements\n  list(           # 1. a list of 2 elements\n    c(1, 2),           # 1.1 a double vector of length 2\n    list(\"w\")          # 1.2 a list of 1 element (which is a char vector of length 1)\n  ),\n  \"a\"             # 2. a character vector of length 1\n)\n\nThe c function (implicitly) coerce vectors to lists of vectors before combining them into a list\n\nl3 &lt;- c(list(1, 2), c(\"3\", \"4\"), list(5, 6))\nl3\n\n\n\n\nIllustration: list construction\n\n\nExplicit coercion from other structures to lists is done via as.list.\n\nv &lt;- c(1, 2, 3)\n# Are these two commands equivalent?\nlist(v)\nas.list(v)\n\nA list can be flatten-ed with unlist\n\nv &lt;- c(1, 2, 3)\n# Are these two commands equivalent?\nunlist(list(v))\nunlist(as.list(v))",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Heterogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_02.html#names-attributes",
    "href": "chap_02/containers_02.html#names-attributes",
    "title": "10  Heterogeneous Types",
    "section": "10.3 names attributes",
    "text": "10.3 names attributes\nLike in vectors, you can add attributes such as names to lists\n\nl &lt;- list(\n  a = factor(c(\"apple\", \"apple\", \"banana\")),\n  b = c(1:10)\n)\ntypeof(l[[\"a\"]])\ntypeof(l)\nnames(l)\nattributes(l)\n\nOne common usage of named lists is to return multiple values from a function:\n\n# recall p1.3:\nBmi &lt;- function(weight, height) {\n  return(weight / height^2)\n}\n\n# now we want to know the value of bmi as well as if the bmi is showing a need to reduce weight:\nBmi2 &lt;- function(weight, height) {\n  bmi_value &lt;- weight / height^2\n  return(list(\n    value = bmi_value,\n    reduce_weight = bmi_value &gt;= 25\n  ))\n}\nbb &lt;- Bmi2(weight = 90, height = 1.75)\nbb[[\"value\"]]\nbb[[\"reduce_weight\"]]",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Heterogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_02.html#class-attribute",
    "href": "chap_02/containers_02.html#class-attribute",
    "title": "10  Heterogeneous Types",
    "section": "10.4 class attribute",
    "text": "10.4 class attribute\nThe class attribute of a list determines how the list is printed, and which methods are used when we apply generic functions to the list. We will talk about generic functions and methods in [Object-oriented programming]. Examples of classes of lists include data.frame, tibble, lm, and glm:\n\ndf &lt;- data.frame(x = 1:3, y = letters[1:3])\ntb &lt;- tibble::tibble(x = 1:3, y = letters[1:3])\nlm1 &lt;- lm(mpg ~ wt, data = mtcars)\nglm1 &lt;- glm(vs ~ wt, data = mtcars, family = binomial)\nclass(df)\nclass(tb)\nclass(lm1)\nclass(glm1)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Heterogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/containers_02.html#data.frame-and-tibble",
    "href": "chap_02/containers_02.html#data.frame-and-tibble",
    "title": "10  Heterogeneous Types",
    "section": "10.5 data.frame and tibble",
    "text": "10.5 data.frame and tibble\ndata.frame and tibble are two classes of the list data structure used in R:\n\ndata.frame - Data frames are tightly coupled collections of variables. Data frame is a fundamental data structure used by most of R’s modelling functions.\ntibble - The data frames of tidyverse\n\n\n10.5.1 data.frame\nA data frame is a named list of vectors with attributes names, row.names, and class of “data.frame”. In contrast to regular lists, all vectors inside the collection of a data frame are required to have the same length. Thus a data frame is always rectangular shaped.\nBecause data frame shares the same shape with matrix, the same functions applicable to matrix also work on data frame: nrow, ncol, rownames, colnames, rbind, cbind, t\n\ndf &lt;- data.frame(x = 1:3, y = letters[1:3])\ndf\nattributes(df)\n\nrownames(df)\ncolnames(df)\nnames(df)\n\nnrow(df)   # same as matrix\nncol(df)\nlength(df) # same as ncol\n\nt(df)\n\nrbind(df, df)\ncbind(df, df)\n\nNoticed the column names are also duplicated? (See [Duplicated names])\nTo prove data frames are just lists with fancy attributes, we manually construct a data.frame object by adding attributes to a list:\n\nl &lt;- list(x = 1:3, y = letters[1:3])\nattr(l, \"class\") &lt;- \"data.frame\"\nattr(l, \"row.names\") &lt;- 1:3\nidentical(df, l)\n\nExplicit coercion: as.data.frame\n\ndf1 &lt;- as.data.frame(list(x = 1:3, y = letters[1:3]))\nidentical(df, df1)\nis.data.frame(df1)\n\n\n\n10.5.2 tibble\ntibble is tidyverse’s version of data frame\n\nlibrary(tibble)\ntb &lt;- tibble(x = 1:3, y = letters[1:3])\ntypeof(tb)\nattributes(tb)\n\nis.data.frame(tb)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Heterogeneous Types</span>"
    ]
  },
  {
    "objectID": "chap_02/data_manipulation.html",
    "href": "chap_02/data_manipulation.html",
    "title": "11  Data manipulation",
    "section": "",
    "text": "11.1 Extraction\nPre-requisites\nOutline\nRecommended readings:\nExtraction, also known as “subsetting” or “indexing”, is the first step of data manipulation. It refers to the step to specify a sub-section of the data structure to operate on.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Data manipulation</span>"
    ]
  },
  {
    "objectID": "chap_02/data_manipulation.html#extraction",
    "href": "chap_02/data_manipulation.html#extraction",
    "title": "11  Data manipulation",
    "section": "",
    "text": "11.1.1 Operators\n[, [[, and $\nExtraction operators act on vectors, matrices, arrays and lists to extract or replace parts of the data structure. Indexing can occur on the right-hand-side (RHS) of an expression for extraction, or on the left-hand-side (LHS) for replacement.\n\nThere are three extraction operators, [, [[, and $. (see ?Extract)\n[ can select more than one element whereas the other two select a single element.\n[ returns the same type\nExtraction operators interact differently with different data structure.\nFor vector structures, we only need [.\n[[ and $ are only needed for list structures (recursive).\n$ requires column names.\nPartial matching is the default behaviour of $, whereas [[ applies exact matching by default.\nValues of different types may be used as indices.\n\n\n\n11.1.2 [, [[\n\n11.1.2.1 from vectors\natomic vectors\n\na &lt;- c(11, 22, 33, 44, 55, 10)\n\n# different value types may be used as indices\n# 1. positive integers\na[4]\na[2:3]\na[c(3, 1)]\na[c(2, 2, 3)] # repeat the extracted element\n\na[4.9]        # implicit coercion\na[1.2:3.2]\n\na[length(a)]  # last element\n\n# 2. negative integers\na[-4]\na[c(-4, -3)]\na[-c(4, 3)]\n# a[c(-4, 3)]\n\n# 3. logical values\na[c(TRUE, FALSE, TRUE, FALSE, FALSE, FALSE)] # selector vector is of same size\na[c(TRUE, FALSE)] # selector vector is shorter than data vector\na[c(TRUE, FALSE, FALSE, FALSE)]\na[c(TRUE, FALSE, TRUE, FALSE, FALSE, FALSE, TRUE)] # selector vector longer than data vector\na &gt; 35\na[a &gt; 35]\na[a &gt; 20 & a &lt; 50]\n\na[c(FALSE, TRUE, NA)]\n\n# 4. empty\na[]\nidentical(a, a[]) # remember that [ is just a function?\na[NULL]\ntypeof(a[NULL])\na[NA]\n\n# 5. zero\na[0]\na[c(0, 1)]\n\n# 6. characters\nb &lt;- setNames(c(11, 22, 33), letters[1:3]) # named vector\nb[\"a\"]\nb[c(\"a\", \"a\", \"c\")]\n\n[[ is not very useful for vectors.\n\nidentical(a[[1]], a[1])\na[[c(1,2)]] #?\n\nmatrix\n\nm &lt;- matrix(11:22, nrow = 4)\nm\n# single element\nm[2, 3]\n\n# multiple elements\nm[2:3, 3]   # vector\nm[2:3, 2:3] # matrix\n\nRemember that matrices are just vectors with attributes, so you can index it with vectors. Note the difference a comma makes:\n\nm[2:3]\nm[2:3,]\n\nm[2]\nm[2, ]\n\n\n\n\n\n\nimage source\n\n\n\n# with logical vectors\nm[m &gt; 5]\n\n# with names character\ncolnames(m) &lt;- c(\"col1\", \"col2\", \"col3\")\nm[2, c(\"col1\", \"col3\")]\ntypeof(m[2, c(\"col1\", \"col3\")])\n\nm[]\nidentical(m, m[])\n\nAgain, [[ is not very useful for matrices (which are vectors).\n\nm[[1]]\nm[[1:2]] # ?\n\n\n\n11.1.2.2 from lists\nlists\n\nl &lt;- list(1:5, letters[1:3], c(1.4, 3.1, 6.4, 6.2))\nl[1] # returns a list\nl[-1]\nl[2:3]\nidentical(l[-1], l[2:3])\nl[1][2] # ?\n\nTo go deeper, use [[. (The clue is in the print.)\n\nl[[1]]     # [[ lets you go one level deeper\nl[1]       # can you see the difference?\n\nl[[3]]\nl[[3:4]]   # don't do this\nl[3:4]     # this is what you wanted, probably\n\nWhat about a list of lists?\n\nll &lt;- list(list(11:14), list(21:24), list(31:34))\nll[1]\nlength(ll[1])\nll[[1]]\n\n\n\n\nEach bag of pepper is a list. image source\n\n\nWhat about this? Can you point out where this is on the pepper photo?\n\nll[[1]][[1]][1]\n\nData frame\n\ndf &lt;- data.frame(x = 1:10, y = letters[1:10])\ndf\ndf[1]      # data frame\ndf[, 1]    # character vector (comma matters)\ndf[1, ]    # data frame\ndf[, 1:2]  # data frame\n\ndf[3:5, ]  # data frame\ndf[3:5, 2] # character vector\n\ndf[, c(\"y\", \"x\", \"x\")] # reorder columns in data frame\ndf[, c(\"x\", \"x\")]      # duplicate columns in data frame\ndf[, c(2, 1, 1)]\n\n# What is the difference between these pairs of statements:\ndf[2]\ndf[[2]]\n\ndf[\"y\"]\ndf[[\"y\"]]\n\ndf[c(TRUE, FALSE), ]\ndf[, c(TRUE, FALSE)]\ndf[c(TRUE, FALSE)]\ndf[df[, \"x\"] &gt; 5, ]\n\ndf[df[, \"x\"] &gt; 5, ]\ndf[df[[\"x\"]] &gt; 5, ]\n\n\n\n\n11.1.3 $\n\n$ is not valid for vectors\n$ precedes column names of lists\n\n\n?Extract - Both [[ and $ select a single element of the list. The main difference is that $ does not allow computed indices (see Dynamic name), whereas [[ does. x$name is equivalent to x[[\"name\", exact = FALSE]]. Also, the partial matching behavior of [[ can be controlled using the exact argument.\n\n\n# $ is not useful for vectors\nm &lt;- matrix(1:9, nrow = 3, ncol = 3)\ncolnames(m) &lt;- c(\"a\", \"b\", \"c\")\nm\nm[\"a\"]\nm[, \"a\"]\nm$\"a\"\n\ndf &lt;- data.frame(age = 1:10, initial = letters[1:10])\n\ndf[\"age\"]\ndf[[\"age\"]]\ndf$age\ndf$\"age\"\ndf$`age`\ndf$'age'\n\ndf$a\ndf$\"a\"\ndf$'a'\ndf$`a`\n\ndf[[\"a\"]]\n\n# what if both column names start with \"a\"\ndf2 &lt;- data.frame(age = 1:10, account = letters[1:10])\n\ndf2$a\ndf2$g\ndf2$ag\n\n\n\n11.1.4 Dynamic name\n\ndf &lt;- data.frame(age = 1:10, initial = letters[1:10])\ndf$age # we know this works\ndf$a   # this also works\n\n# What if the name of the wanted column is in a variable?\nwanted_col &lt;- \"a\"\ndf$wanted_col # would this work?\n# if it does, why does df$age work?\n\ndf[[wanted_col]] # would this work?\n\nwanted_col &lt;- \"age\"\ndf[[wanted_col]] # feel better now?\n\nRemember “Everything that happens in R is a function call”.\n\n`$`(df, a)           # works\n`$`(df, \"a\")         # works\n`$`(df, wanted_col)  # doesn't work\n\n`[[`(df, wanted_col) # works\n`[[`(df, \"age\")      # works\n`[[`(df, age)        # doesn't work\n\nCompare the comment for $ and [[. How do they each handle the second argument?\nR source code on $:\n/* The $ subset operator.\n   We need to be sure to only evaluate the first argument.\n   The second will be a symbol that needs to be matched, not evaluated.\n*/\nR source code on [[:\n/* The [[ subset operator.  It needs to be fast. */\n/* The arguments to this call are evaluated on entry. */\n\n\n11.1.5 Duplicated names\n\ndf &lt;- data.frame(x = 11:13, y = letters[11:13])\nrownames(df) &lt;- c(\"r1\", \"r2\", \"r3\")\n\n# double the rows\ndf_rdbl &lt;- rbind(df, df)\ndf_rdbl\nrownames(df_rdbl) # row names are not duplicated\n\n# double the columns\ndf_cdbl &lt;- cbind(df, df)\nnames(df_cdbl)    # column names are duplicated\n\ndf3 &lt;- df_cdbl[1, 1:4]\nnames(df3)        # further operation distinguishes the duplicated columns\n\nduplicated(names(df_cdbl))\ndf_cdbl[!duplicated(names(df_cdbl))] # extract only the not duplicated columns\n\n\nType ?subset and you will see that there is a built-in function called subset in R. Do you think we should include it in the lecture and why?",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Data manipulation</span>"
    ]
  },
  {
    "objectID": "chap_02/data_manipulation.html#sequences",
    "href": "chap_02/data_manipulation.html#sequences",
    "title": "11  Data manipulation",
    "section": "11.2 Sequences",
    "text": "11.2 Sequences\nFrom the previous section, we see that sequences of numbers are useful for specifying a section of a data structure. In this section, we take a look at different ways to generate sequences of values.\n\n11.2.1 :\nThe colon (:) operator is a quick way to generate a sequence of numbers. Recall that we also used it to control for loops:\n\nIsLeapYear &lt;- function (x) {\n    return (x %% 400 == 0 | (x %% 4 == 0 & x %% 100 != 0))\n}\nPrintLeapYearsBetween &lt;- function (from_year, to_year) {\n  for (year in from_year : to_year) {\n    if(!IsLeapYear(year)) {\n      next\n    }\n    print(year)\n  }\n}\nPrintLeapYearsBetween(1990, 2018)\n\nAnd that integers are the default type returned by ::\n\ntypeof(1:10) # the `:` operator generate a range of integer values\n\nYou can also generate a sequence of doubles:\n\n# \n1.5:10\n1.5:10.5\n\n# note the difference\ntypeof(1.5:10)\ntypeof(1:10.5)\n\n# and implicit coercion happens\na &lt;- 11:20\na[1.5:3.5]\n\nWhat if we swap the bigger value to the LHS?\n\n10:1\n10.6:-1.1\n\n: returns a specific type of sequence of numbers that are 1 apart in numeric value. What if we want the interval to be more than 1?\n\n\n11.2.2 seq\n\n# well, you can always do this\n(1:10) * 2\n\n# but seriously, let's leave the maths to the computer\n# and do this in a safer manner with `seq`\nseq(from = 0, to = 20, by = 2)\nseq(from = 20, to = 0, by = 2) #?\n\nseq(from = 20.5, to = -5.30, by = -3)\n\nseq(from = 1.6, to = 2.8, length.out = 14)\n\n# sequence of length\nseq_len(10)\n\n\nseq is a generalised version of :.\nseq_along is the preferred method where possible.\n\n\n\n\n11.2.3 seq_along\nIt is common to want to iterate through a data structure and perform a set of operations on each of its elements with a for loop. In which case we need to define a sequence to represent the indices of that structure. There are many ways to generate this sequence and we give a comparison between these methods and demonstrate why seq_along is the safest way to generate this sequence.\nseq_along is the function to use when you want to iterate a structure with a for loop\n\n# Assuming v0, v1, v2, v3 are the vectors you want to iterate over\nv3 &lt;- c(-11.1, -22.2, -33.3)\nv2 &lt;- c(-11.1, -22.2)\nv1 &lt;- c(-11.1)\nv0 &lt;- c()\n\n# Three versions of looping over the vector\nprint_all_seq_along &lt;- function(vv) {\n  for (ii in seq_along(vv)) {\n    print(vv[ii])\n  }\n}\n\nprint_all_seq &lt;- function(vv) {\n  for (ii in seq(vv)) {\n    print(vv[ii])\n  }\n}\n\nprint_all_length &lt;- function(vv) {\n  for (ii in 1:length(vv)) {\n    print(vv[ii])\n  }\n}\n\n# when this vector of at least length 2\nprint_all_seq_along(v3) # works\nprint_all_seq(v3)       # works\nprint_all_length(v3)    # works\n\n# vector is of length 1\nprint_all_seq_along(v1) # works\nprint_all_seq(v1)       # ?\nprint_all_length(v1)    # works \n\n# vector is empty\nprint_all_seq_along(v0) # works\nprint_all_seq(v0)       # works\nprint_all_length(v0)    # ?\n\n\n\n\n11.2.4 rep\nrep (replicate) is another useful function to generate sequences of certain patterns.\n\n# replicate one value\nrep(TRUE, 10)\n# replicate a vector\nrep(1:4, 2)\n# replicate per element\nrep(1:4, each = 2)\nrep(1:4, c(2, 2, 2, 2))\n\nrep(1:4, c(4, 3, 2, 1))\n\n\n\n11.2.5 expand.grid\nGenerate pairs of values from two sets of values, with all combinations of value pairs.\n\nexpand.grid(x = 1:5, y = 2:4)\n\n\n\n\n11.2.6 Dates\nTo create a sequence of dates\n\n# know the start date and the length of the sequence\nd &lt;- as.Date(\"2020-02-25\", format = \"%Y-%m-%d\")\nd + 1:5\n\n# know start date and end date\nd1 &lt;- as.Date(\"2020-02-25\", format = \"%Y-%m-%d\")\nd2 &lt;- as.Date(\"2020-03-25\", format = \"%Y-%m-%d\")\nd1 + 1:(d2 - d1)\n\n# with seq\nseq(d1, d2, by = \"days\")\nseq(d1, d2, by = \"2 days\")\nseq(d1, d2 + 365 * 3, by = \"years\")\nseq(d1, d2 + 365 * 3, by = \"quarter\")\n\nIt is worth noting the lubridate package which provides a more intuitive way to define dates and times.\n\nlibrary(lubridate)\nseq(ymd(\"2020-02-25\"), ymd(\"2020-03-25\"), by = \"2 days\")\n\n\n\n\n11.2.7 Random sequences\n\n11.2.7.1 runif and rnorm\n\nrunif(n, min = 0, max = 1), get n random numbers uniformly-distributed between min and max (runif will not generate either of the extreme values unless max == min or max-min is small compared to min)\nrnorm(n, mean = 0, sd = 1), get n random numbers normally-distributed around mean\n\n\nrunif(10) # 10 random numbers between `0` and `1`\n\n\nn &lt;- 1000\nplot(x = runif(n), y = rnorm(n), pch = 20)\n\n\n\n\n\n\n\n\n\n\n11.2.7.2 Reproducibility\nseed - ?.Random.seed\n\nset.seed(1); runif(10)\nset.seed(1); runif(10) # reset seed and same sequence of random number is generated \n\n\n\n11.2.7.3 Distributions\nDetails of these functions will be covered in the Mathematics and Statistics module later in the term.\n\n\n\n\n\n\n\n\n\n\nDistribution\nRandom numbers\nProbability density function (PDF)\nCumulative Distribution function (CDF)\nQuantile function\n\n\n\n\nUniform\nrunif\ndunif\npunif\nqunif\n\n\nNormal\nrnorm\ndnorm\npnorm\nqnorm\n\n\nPoisson\nrpois\ndpois\nppois\nqpois\n\n\nBinomial\nrbinom\ndbinom\npbinom\nqbinom\n\n\nExponential\nrexp\ndexp\npexp\nqexp\n\n\nGamma\nrgamma\ndgamma\npgamma\nqgamma\n\n\n\nSee ?Distributions for more details.\n\n\n\nProbability distributionsimage source",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Data manipulation</span>"
    ]
  },
  {
    "objectID": "chap_02/data_manipulation.html#sets",
    "href": "chap_02/data_manipulation.html#sets",
    "title": "11  Data manipulation",
    "section": "11.3 Sets",
    "text": "11.3 Sets\nIn this section, we take a look at when two groups of values are involved in the operation.\nBasic set operations\nA key property of sets, as compared to vectors, is that it does not contain duplicated values. R has a set of functions to perform basic set operations.\n\n?union - Performs set union, intersection, (asymmetric!) difference, equality and membership on two vectors. Each of union, intersect, setdiff and setequal will discard any duplicated values in the arguments, and they apply as.vector to their arguments (and so in particular coerce factors to character vectors).\n\nIllustrated below are two sets s1 and s2. Each set has 5 elements. Both sets contain numbers 3, 4, and 5.\n\n\ns1 &lt;- 1:5\ns2 &lt;- 3:7\n\nunion(s1, s2)\nintersect(s1, s2)\nsetdiff(s1, s2)\nsetdiff(s2, s1)\n\nsetequal(1:5, 5:1)\nsetequal(c(1, 2, 2, 3), c(3, 3, 2, 1, 1))\n\nis.element(5, s1)\nis.element(c(1, 3, 7), s1)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Data manipulation</span>"
    ]
  },
  {
    "objectID": "chap_02/data_manipulation.html#search",
    "href": "chap_02/data_manipulation.html#search",
    "title": "11  Data manipulation",
    "section": "11.4 Search",
    "text": "11.4 Search\nLet’s take a closer look at intersect. (Typing the function name on the console returns the implementation of the function, just like a variable).\n\nintersect\n\nfunction (x, y) \n{\n    if (is.null(x) || is.null(y)) \n        return(NULL)\n    if (.set_ops_need_as_vector(x, y)) {\n        x &lt;- as.vector(x)\n        y &lt;- as.vector(y)\n    }\n    x &lt;- unique(x)\n    names(x) &lt;- NULL\n    y &lt;- unique(y)\n    names(y) &lt;- NULL\n    c(x[match(x, y, 0L) &gt; 0L], y[0L])\n}\n&lt;bytecode: 0x114ecff60&gt;\n&lt;environment: namespace:base&gt;\n\n\nWe see two other functions unique and match are used to achieve intersect.\n\n11.4.1 unique, duplicated\n\n?unique - returns a vector, data frame or array like the input but with duplicate elements/rows removed.\n\n\n?duplicated - determines which elements of a vector or data frame are duplicates of elements with smaller subscripts, and returns a logical vector indicating which elements (rows) are duplicates.\n\n\nunique(c(NA, 1, 1, 10, NULL, NaN, NaN))\n\nx &lt;- c(4, 1:5, 3:6)\nduplicated(x)\nduplicated(x, fromLast = TRUE)\n\nduplicated(c(NA, 1, NA, NaN, NaN, NULL, NULL))\n\n# multiple columns\ndf &lt;- data.frame(c(1, 2, 1, 4, 2, 2), c(2, 3, 2, 6, 2, 3))\ndf\nduplicated(df[,1:2])\n\nanyDuplicated(df[,1:2])\n\n\n\n11.4.2 match, %in%\n\nmatch(c(1, NA, 10), c(1:4, NA, NaN))\n\nmatch is similar to is.element.\n\nmatch(3, 1:10)\nis.element(3, 1:10)\n\n# the %in% operator is identical to `is.element`.\n# `?match` - `%in%` is a more intuitive interface as a binary operator, which returns a logical vector indicating if there is a match or not for its left operand.\n3 %in% 1:10\n9:11 %in% 1:10\n\n\n\n11.4.3 any, all\nany and all search for TRUE values in the given structure, and they can be used to summarise the result from is.element or %in%\n\ns1 &lt;- 1:5\ns2 &lt;- 3:7\n\nany(is.element(s1, s2))\nall(is.element(s1, s2))\n\nany(c(1, \"a\", \"bc\") %in% letters)\nany(c(1, \"a\", \"bc\") %in% LETTERS)\nall(c(1, \"a\", \"bc\") %in% letters)\n\n\n\n11.4.4 which, arrayInd\nwhich is similar to match, but the condition is not restricted to equality:\n\nwhich(LETTERS == \"E\")\nwhich(1:10 &gt; 3)\n\nv &lt;- c(5, 3, 5, 2, 7)\n\nwhich.min(v)\nwhich.max(v)\n\n# ?which.min - If this extremum is unique (or empty), the results are the same as (but more efficient than)\n#              which(x == min(x, na.rm = TRUE)) or which(x == max(x, na.rm = TRUE)) respectively.\n\n# what happens when the min / max is not unique?\nwhich.min(c(v, 2))\nwhich.max(c(7, v))\n\n# what about matrices\nm &lt;- matrix(1:15, nrow = 3, ncol = 5)\nwhich.max(m)\n# how to get the indecies?\n# 1. with which\nwhich(m == max(m), arr.ind = TRUE)\n# 2. with arrayInd\narrayInd(which.max(m), dim(m))\n\n\n\n11.4.5 sample\n\nsample(1:10, size = 3)\nsample(1:10, size = 10)\nsample(1:10, size = 11) #?\nsample(1:10, size = 20, replace = TRUE)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Data manipulation</span>"
    ]
  },
  {
    "objectID": "chap_02/data_manipulation.html#merge",
    "href": "chap_02/data_manipulation.html#merge",
    "title": "11  Data manipulation",
    "section": "11.5 Merge",
    "text": "11.5 Merge\nLookup\nOne of the most frequently used functions in Excel is the vlookup function.\n\nHow do we do this in R?\n\n11.5.1 Lookup\n\n# example with vectors\nx &lt;- c(\"m\", \"f\", \"u\", \"f\", \"f\", \"m\", \"m\", \"\")\nlookup &lt;- c(m = \"Male\", f = \"Female\", u = NA)\nlookup[x]\n\n# example with data frame\ndf &lt;- data.frame(\n  name = c(\n    \"robert\", \"catelyn\", \"theon\", \"cersei\", \"sansa\",\n    \"ned\", \"jaime\", \"sandor\", \"arya\", \"tyrion\"\n  ),\n  gender = c(\n    \"m\", \"f\", \"u\", \"f\", \"f\",\n    \"m\", \"m\",  \"\", \"f\", \"m\"\n  )\n)\nlookup[df[[\"gender\"]]]\ndf_res &lt;- df\ndf_res[[\"gender_formatted\"]] &lt;- lookup[df[[\"gender\"]]]\ndf_res\n\n\n\n11.5.2 match\n\ndf1 &lt;- data.frame(\n  birth_house = c(\n    \"baratheon\", \"stark\", \"stark\", \"stark\", \"stark\",\n    \"lannister\", \"lannister\", \"lannister\", \"greyjoy\", \"clegane\"\n  ),\n  name = c(\n    \"robert\", \"catelyn\", \"sansa\", \"ned\", \"arya\",\n    \"cersei\", \"jaime\", \"tyrion\", \"theon\", \"sandor\"\n  )\n)\nmatch(df$name, df1$name)\ndf_res &lt;- df\ndf_res[[\"birth_house\"]] &lt;- df1[match(df$name, df1$name), \"birth_house\"]\ndf_res\n\n\n\n11.5.3 merge\n\ndf3 &lt;- merge(df, df1, by = \"name\")\ndf3\nmerge(df, df1)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Data manipulation</span>"
    ]
  },
  {
    "objectID": "chap_02/data_manipulation.html#built-in-datasets",
    "href": "chap_02/data_manipulation.html#built-in-datasets",
    "title": "11  Data manipulation",
    "section": "11.6 Built-in datasets",
    "text": "11.6 Built-in datasets\nBase R comes with a few datasets built-in for demonstration purposes. We will use some of these to demonstrate how some of the data manipulation functions work.\n\ndata() # displays a list of all datasets\n\n\n11.6.1 head, tail, summary\nQuite often, the datasets are very long to read on one or even several screens. head and tail (as the identically named Linux/Unix commands) prints the beginning and end of the dataset.\n\nmorley\nhead(morley)\ntail(morley)\nsummary(morley)\ndim(morley)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Data manipulation</span>"
    ]
  },
  {
    "objectID": "chap_02/data_manipulation.html#reshape",
    "href": "chap_02/data_manipulation.html#reshape",
    "title": "11  Data manipulation",
    "section": "11.7 Reshape",
    "text": "11.7 Reshape\n\n?morley: Michelson Speed of Light Data, A classical data of Michelson (but not this one with Morley) on measurements done in 1879 on the speed of light. The data consists of five experiments, each consisting of 20 consecutive ‘runs’. The response is the speed of light measurement, suitably coded (km/sec, with 299000 subtracted).\n\nThere are many ways to reshape data between long and wide format:\n\nreshape, R base\ngather and spread, part of the tidyr package\nmelt and dcast, part of the reshape2 package\nstack and unstack, R base\n\nWe give introduction to the solution with the first two options.\n\n11.7.1 reshape\n\nreshape is part of R base.\n\n\nmorley_wide &lt;- reshape(morley, idvar = c(\"Expt\"), timevar = \"Run\", v.names = \"Speed\", direction = \"wide\", sep = \"_\")\n#morley_wide &lt;- reshape(morley, idvar = c(\"Expt\"), timevar = \"Run\", v.names = c(\"Speed\", \"Run\"), direction = \"wide\", sep = \"_Run\")\nmorley_wide\nattributes(morley_wide)\nmorley_long &lt;- reshape(morley_wide, idvar = c(\"Expt\"), direction = \"long\")\nmorley_long\n\nattributes(morley_wide)$reshapeWide &lt;- NULL\nmorley_long &lt;- reshape(morley_wide, idvar = c(\"Expt\"), direction = \"long\") # no 'reshapeWide' attribute, must specify 'varying'\nmorley_long &lt;- reshape(morley_wide, idvar = c(\"Expt\"), direction = \"long\", varying = 2:ncol(morley_wide), v.names = \"Speed\")\nmorley_long &lt;- reshape(morley_wide, idvar = c(\"Expt\"), direction = \"long\", varying = 2:ncol(morley_wide), timevar = \"Run\", v.names = \"Speed\")\nmorley_long\n\n\n\n11.7.2 tidyr\n\ngather and spread are part of the tidyr\n\n\nmorley_wide &lt;- tidyr::spread(morley, key = Run, value = Speed)\nmorley_wide &lt;- tidyr::pivot_wider(morley, names_from = Run, values_from = Speed)\nmorley_wide\n\n\nmorley_long &lt;- tidyr::gather(morley_wide, key = Run, value = Speed, names(morley_wide)[-1])\nmorley_long &lt;- tidyr::pivot_longer(morley_wide, names_to = \"Run\", values_to = \"Speed\", -Expt)\nmorley_long\n\n\nag &lt;- aggregate(morley$Speed, by = morley[1], FUN = quantile, probs = c(0.99, 0.95, 0.75))\nhead(ag)\ncolnames(ag)\n\n\nm &lt;- matrix(c(1,2,3,4), nrow=2, ncol=2)\ndf &lt;- data.frame(id=1, mat=I(m))",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Data manipulation</span>"
    ]
  },
  {
    "objectID": "chap_02/data_manipulation.html#aggregate",
    "href": "chap_02/data_manipulation.html#aggregate",
    "title": "11  Data manipulation",
    "section": "11.8 Aggregate",
    "text": "11.8 Aggregate\n\n11.8.1 aggregate\n\ndtf &lt;- data.frame(\n  p1 = rep(1:2, 4:5),\n  p2 = rep(letters[2:3], 5:4),\n  v1 = rnorm(9, mean = 10),\n  v2 = rnorm(9, mean = 20)\n)\ndtf\n\naggregate(dtf$v1, by = list(p1 = dtf$p1, p2 = dtf$p2), FUN = mean)\naggregate(dtf[, 3:4], by = list(p1 = dtf$p1, p2 = dtf$p2), FUN = mean)\n\n\nFormula method of aggregate\n\n\n# one value grouped by one variable\naggregate( v1 ~ p1, data = dtf, mean)\naggregate( p2 ~ p1, data = dtf, length)\n\n# multiple values grouped by one variable\naggregate(cbind(v1, v2) ~ p1, data = dtf, max)\n\n# one value grouped by multiple variables\naggregate(v1 ~ p1 + p2, data = dtf, min)\n\n# multiple values grouped by multiple variables\naggregate(cbind(v1, v2) ~ p1 + p2, data = dtf, mean)\naggregate(. ~ p1 + p2, data = dtf, mean)\n\n\nwith dplyr\n\n\ndtf2 &lt;- dplyr::group_by(dtf, p1, p2)\ndplyr::summarise(dtf2, v1.avg = mean(v1), v2.max = max(v2))\ndplyr::summarise(dtf2, quantile(v1, c(0.01, 0.5)))\n\nmy_quantile &lt;- function(x, probs) {\n  # dplyr::tibble(x = quantile(x, probs), probs = probs)\n  data.frame(x = quantile(x, probs), probs = probs)\n}\ndplyr::summarise(dtf2, my_quantile(v1, c(0.01, 0.5)))\n\n?dplyr::summarise_each #deprecated \n\n# \n# aggregate(df3, by = list(df3$birth_house), FUN = length)\n# aggregate(df3$name, by = list(df3$birth_house), FUN = length)\n# aggregate(df3, by = list(df3$birth_house, df3$gender), FUN = length)\n\n\n\n11.8.2 Basic stats functions\nHere are some R functions for basic descriptive statistic operations.\n\nmean(1:10)             # mean\nmean(c(1:10, NA, NaN)) # mean\nmean(c(1:10, NA, NaN), na.rm = TRUE) # mean\n\nsd(1:10)     # standard deviation\nvar(1:10)    # variance\nmedian(1:10) # median\n\n# ?median - The default method returns a length-one object of the same type as x,\n#           except when x is logical or integer of even length, when the result will be double.\nmedian(c(1, 2, 2, 10))\n\nquantile(1:100, probs = c(0.05, 0.95))\nquantile(1:100, probs = c(0, 1))\nrange(1:100)\n\nv &lt;- c(1, 3, 8, 2, NA, NaN)\n\nmin(v)\nmin(v, na.rm = TRUE)\nmax(v)\nmax(v, na.rm = TRUE)\nmax(c(v, Inf), na.rm = TRUE)\n\nwhich.min(v) # na.rm = TRUE by default\nwhich.max(v) # na.rm = TRUE by default\n\n# ?which.min - If this extremum is unique (or empty), the results are the same as (but more efficient than)\n#              which(x == min(x, na.rm = TRUE)) or which(x == max(x, na.rm = TRUE)) respectively.\n\nsum(1:100)\n\ndiff(c(1, 3, 5, 2, 10))\ndiff(c(1, 3, 5, 2, 10), lag = 3)\n\n# cumulatives\ncumsum(c(1, 3, 5, 2, 10))\ncumprod(c(1, 3, 5, 2, 10))\ncummax(c(1, 3, 5, 2, 10))\ncummin(c(1, 3, 5, 2, 10))\ncummin(c(10, 3, 5, 2, 10))\n\n\n\n11.8.3 Expand\n\n# n gives the aggregated counts of x, y pairs\ndf &lt;- data.frame(x = c(2, 4, 1), y = c(9, 11, 6), n = c(3, 5, 1))\nrep(1:nrow(df), df[[\"n\"]])\n\ndf[rep(1:nrow(df), df[[\"n\"]]), ]",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Data manipulation</span>"
    ]
  },
  {
    "objectID": "chap_02/data_manipulation.html#sorting",
    "href": "chap_02/data_manipulation.html#sorting",
    "title": "11  Data manipulation",
    "section": "11.9 Sorting",
    "text": "11.9 Sorting\nsort(x, decreasing = FALSE, ...) sort a vector or factor into ascending or descending order.\n\nv &lt;- c(NA, 10, 8, 4, 4, NaN, NULL, 7, 13)\nsort(v)\nsort(v, decreasing = TRUE)\n\norder returns a permutation which rearranges its argument into ascending or descending order.\n\nv &lt;- c(NA, 10, 8, 4, 4, NaN, NULL, 7, 13)\norder(v)\nv[order(v)]\nv[order(v, decreasing = TRUE)]\n\n\ndf &lt;- data.frame(\n  name  = letters[1:8],\n  age   = c(25,  25, 25,  20, 20,  15, 47, 33),\n  score = c(97, 100, 90, 100, 95, 100, 90, 90)\n)\ndf\ndf[order(df[[\"age\"]]),]\ndf[order(df[[\"age\"]], -df[[\"score\"]]),]\n\nSorting methods method = c(\"auto\", \"shell\", \"quick\", \"radix\") can be specified for both sort and order.\n\nReorder columns\n\n\ndf &lt;- data.frame(x = 1:3, y = 3:5)\ndf\ndf &lt;- df[, c(\"y\", \"x\")]\ndf &lt;- df[, c(2, 2, 1)]\ndf",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Data manipulation</span>"
    ]
  },
  {
    "objectID": "chap_02/data_manipulation.html#exercises",
    "href": "chap_02/data_manipulation.html#exercises",
    "title": "11  Data manipulation",
    "section": "Exercises",
    "text": "Exercises\nSee Section 15.2 for exercises on usages of data.frame.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Data manipulation</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_base.html",
    "href": "chap_02/vis_base.html",
    "title": "12  Data Visualisation I",
    "section": "",
    "text": "12.1 Anscombe’s quartet\nData visualisation serves two purposes:\nRecommended readings\nAmong the many datasets included in R, there is one named anscombe. This dataset comes from the journal article authored by the F. J. Anscombe published on The American Statistician journal in 1973, titled Graphs in Statistical Analysis.\nThere are eight columns in anscombe giving four pairs of x and y values:\nLet’s take a look at some of the descriptive statistics of the dataset:\nhead(anscombe)\n\n  x1 x2 x3 x4   y1   y2    y3   y4\n1 10 10 10  8 8.04 9.14  7.46 6.58\n2  8  8  8  8 6.95 8.14  6.77 5.76\n3 13 13 13  8 7.58 8.74 12.74 7.71\n4  9  9  9  8 8.81 8.77  7.11 8.84\n5 11 11 11  8 8.33 9.26  7.81 8.47\n6 14 14 14  8 9.96 8.10  8.84 7.04\n\nattributes(anscombe)\n\n$names\n[1] \"x1\" \"x2\" \"x3\" \"x4\" \"y1\" \"y2\" \"y3\" \"y4\"\n\n$class\n[1] \"data.frame\"\n\n$row.names\n [1]  1  2  3  4  5  6  7  8  9 10 11\n\nsummary(anscombe)\n\n       x1             x2             x3             x4           y1        \n Min.   : 4.0   Min.   : 4.0   Min.   : 4.0   Min.   : 8   Min.   : 4.260  \n 1st Qu.: 6.5   1st Qu.: 6.5   1st Qu.: 6.5   1st Qu.: 8   1st Qu.: 6.315  \n Median : 9.0   Median : 9.0   Median : 9.0   Median : 8   Median : 7.580  \n Mean   : 9.0   Mean   : 9.0   Mean   : 9.0   Mean   : 9   Mean   : 7.501  \n 3rd Qu.:11.5   3rd Qu.:11.5   3rd Qu.:11.5   3rd Qu.: 8   3rd Qu.: 8.570  \n Max.   :14.0   Max.   :14.0   Max.   :14.0   Max.   :19   Max.   :10.840  \n       y2              y3              y4        \n Min.   :3.100   Min.   : 5.39   Min.   : 5.250  \n 1st Qu.:6.695   1st Qu.: 6.25   1st Qu.: 6.170  \n Median :8.140   Median : 7.11   Median : 7.040  \n Mean   :7.501   Mean   : 7.50   Mean   : 7.501  \n 3rd Qu.:8.950   3rd Qu.: 7.98   3rd Qu.: 8.190  \n Max.   :9.260   Max.   :12.74   Max.   :12.500  \n\nsapply(anscombe, var)    # variance\n\n       x1        x2        x3        x4        y1        y2        y3        y4 \n11.000000 11.000000 11.000000 11.000000  4.127269  4.127629  4.122620  4.123249 \n\nsapply(anscombe, median) # median\n\n  x1   x2   x3   x4   y1   y2   y3   y4 \n9.00 9.00 9.00 8.00 7.58 8.14 7.11 7.04 \n\n# correlation\ncor(anscombe[[\"x1\"]], anscombe[[\"y1\"]])\n\n[1] 0.8164205\n\ncor(anscombe[[\"x2\"]], anscombe[[\"y2\"]])\n\n[1] 0.8162365\n\ncor(anscombe[[\"x3\"]], anscombe[[\"y3\"]])\n\n[1] 0.8162867\n\ncor(anscombe[[\"x4\"]], anscombe[[\"y4\"]])\n\n[1] 0.8165214\nThe four sets of x-y pairs don’t seem to be different according to the statistical values. So we should expect to see four very similar shapes once they are plotted:\n#?anscombe\n# PAR_DEFAULTS &lt;- par(no.readonly = TRUE)\n\nff &lt;- y ~ x\npar(mfrow = c(2, 2), mar = 0.1 + c(4, 4, 1, 1), oma =  c(0, 0, 2, 0))\nfor(i in 1:4) {\n  ff[2:3] &lt;- lapply(paste0(c(\"y\", \"x\"), i), as.name)\n  plot(ff, data = anscombe, col = \"red\", pch = 21, bg = \"orange\", cex = 1.2,\n       xlim = c(3, 19), ylim = c(3, 13))\n}\nmtext(\"Anscombe's quartet\", outer = TRUE, cex = 1.5)\n\n\n\n\n\n\n\n# par(PAR_DEFAULTS)\nThis dataset, published in 1973, demonstrates the importance of data visualisation. Graphics is not only useful for presenting results, but also for data analysis and discovery.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Data Visualisation I</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_base.html#anscombes-quartet",
    "href": "chap_02/vis_base.html#anscombes-quartet",
    "title": "12  Data Visualisation I",
    "section": "",
    "text": "(x1, y1)\n(x2, y2)\n(x3, y3)\n(x4, y4)\n\n\n\n\n\n\n\nOriginal publication: F. J. Anscombe, Graphs in Statistical Analysis. The American Statistician\nWiki: Anscombe’s quartet\nDatasaurus is a modern iteration of Anscombe’s quartet.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Data Visualisation I</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_base.html#formulae-y-x",
    "href": "chap_02/vis_base.html#formulae-y-x",
    "title": "12  Data Visualisation I",
    "section": "12.2 Formulae, y ~ x",
    "text": "12.2 Formulae, y ~ x\n\n?formula - An expression of the form y ~ model is interpreted as a specification that the response y is modelled by a linear predictor specified symbolically by model.\n\nFamiliarity with statistical concepts and terms is needed to understand formulae definition in R. We will talk about statistical models in the following sessions, but more details will be given in the Statistics module later in the term. We give brief introduction in this session, which is sufficient for the purpose of this module.\nSuppose x1 and x2 are independent variables, y is the response / dependent variable, a formula fm may be defined as follows:\n\nfm &lt;- y ~ x1 + x2 # y is a function of x1 and x2\nterms(fm)\ntypeof(fm)\nclass(fm)\nattributes(fm)\nstr(fm)\nlength(fm)\nfm[[1]]\nfm[[2]]\nfm[[3]]\n\n#fm &lt;- ~ x1 + x2 # one-sided formula\n\n\nFormula expresses a relationship between variables\n~, tilde is used to separate the left- and right-hand sides in a model formula\nLHS of ~ are the dependent variable (a.k.a response, outcome, label)\nRHS of ~ are the independent variables (a.k.a predictor, controlled variable, feature)\n\n\n\n+, join variables\n-, remove variable\n*, crossing\n%in%, nesting\n^, to the specified degree\n., all other variables that have not been included in the formula\npoly(x, degree = d), the orthogonal polynomials of degree d over x\nI(x), x is treated as is, i.e. poly(x, 2) is equivalent to 1 + x + I(x^2)\n\n\nfm &lt;- as.formula(\"y ~ x1 + x2\") # string to formula\ntypeof(fm)\nterms(fm)\nall.vars(fm)\n\nfm &lt;- update(fm, ~. + x3)\nfm\n\nfm &lt;- y ~ x + I(x^2)  # I(), as-is operator\nfm",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Data Visualisation I</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_base.html#base-r-graphics",
    "href": "chap_02/vis_base.html#base-r-graphics",
    "title": "12  Data Visualisation I",
    "section": "12.3 Base R graphics",
    "text": "12.3 Base R graphics\nPart of base R is the graphics package (?graphics) which contains functions for base graphics. The graphic functions are divided into three groups:\n\nHigh-level commands - create a new plot\n\nplot\nbarplot\nhist\ncurve\ncoplot\n…\n\nLow-level commands - add information / graphics to existing plot\n\npoints\nlines\ntext\nabline\npolygon\narrows\nlegend\ntitle(main, sub)\naxis\n…\n\nInteractive - reactive to mouse clicks on the graph\n\nlocator\nidentify\n\n\nThese commands are all well documented, e.g. ?curve. In this session, we give a few example of commonly used plotting commands.\nTo list the functions available in graphics package:\n\nls(\"package:graphics\")\nlsf.str(\"package:graphics\")\n\n\n12.3.1 High-level commands\n\n12.3.1.1 plot\n\n# Plot three data points\nplot(x = c(1, 2, 3), y = c(2, 5, 4))\n\n\n\n\n\n\n\n\nWe use built-in dataset cars which contains data for two variables:\n\nsummary(cars)\n\n     speed           dist       \n Min.   : 4.0   Min.   :  2.00  \n 1st Qu.:12.0   1st Qu.: 26.00  \n Median :15.0   Median : 36.00  \n Mean   :15.4   Mean   : 42.98  \n 3rd Qu.:19.0   3rd Qu.: 56.00  \n Max.   :25.0   Max.   :120.00  \n\n\nThe simplest form:\n\nplot(cars)\n\n\n\n\n\n\n\n\n\n# as long as the data is in matrix form\nplot(as.matrix(cars)) # matrix works just fine\n\n# specify the columns in formula form\nplot(dist ~ speed, data = cars)\n\n# specify xy values by vector\nplot(x = cars$dist, y = cars$speed)\n# - the axes are swapped\n# - axis labels\n\nNow let’s play spot the difference:\n\n#PAR_DEFAULTS &lt;- par(no.readonly = TRUE)\n\npar(mfrow = c(2, 1))\nplot(cars) # top plot\nplot(      # bottom plot\n  cars$dist ~ cars$speed, type = \"b\",\n  main = \"cars dataset\", xlab = \"Speed (mph)\", ylab = \"Stopping distance (ft)\",\n  xlim = c(30, 0), ylim = c(0, 140), pch = 16, lty = \"dashed\", col = \"blue\",\n  xaxs = \"i\", yaxs = \"i\"\n)\n\n\n\n\n\n\n\n\n\ncol, to get all colour names, run either\n\nshowCols1()\ndemo(\"colors\")\n\ntype can be the followings:\n\np for points\nl for lines\nb for both points and lines\nc for empty points joined by lines\no for overplotted points and lines\ns and “S” for stair steps\nh for histogram-like vertical lines\nn does not produce any points or lines\n\n\n\n\n12.3.1.2 barplot\n\ndta &lt;- c(\"red\" = 10, \"black\" = 13, \"silver\" = 20, \"yellow\" = 4)\nbarplot(dta)\n\n\n\n\n\n\n\n\nIdeal for plotting result of table:\n\nbarplot(\n  table(c(\"banana\", \"apple\", \"coconut\", \"apple\", \"apple\", \"banana\", \"banana\", \"banana\")),\n  horiz = TRUE\n)\n\n\n\n\n\n\n\n\n\nValues can be stacked\n\n\nbarplot(cbind(Employed, Unemployed) ~ Year, data = longley)\n\n\n\n\n\n\n\n\n\nbarplot(height = 1:10, names = letters[1:10])\n\n\n\n\n\n\n\n\n\n\n12.3.1.3 hist\n\nhist(1:10) # Compare this to the figure produced by `barplot`\n\n\n\n\n\n\n\n\nA table command is implied in hist\n\ndta &lt;- c(1, 1, 2, 2, 3, 3, 3, 4, 5, 6, 7, 7, 8, 8, 8, 8, 9, 9, 9, 9)\npar(mfrow = c(3, 1))\nhist(x = dta)\nhist(x = dta, breaks = c(0, 1, 2, 3, 5, 8, 9)) # note the change in y label\nhist(x = dta, breaks = 2)\n\n\n\n\n\n\n\n\n\nNot so reliable when the size of data is small\nGood for representing distribution\n\n\nn &lt;- 10000\npar(mfrow = c(3, 1))\nhist(rnorm(n), breaks = 40)\nhist(runif(n), breaks = 40)\n\nd &lt;- density(rnorm(n))\nplot(d)\n\n\n\n\n\n\n\n\n\n\n12.3.1.4 stripchart\n\nstripchart treats each column of data as measurements of one variable.\n\n\nstripchart(1:10)\n\n\n\n\n\n\n\n\n\nUse jitter to distinguish overlapping points\n\n\ndta &lt;- rnorm(100)\npar(mfrow = c(2, 1), mar = c(2, 2, 1, 1))\nstripchart(dta, pch = 20)\nstripchart(dta, method = \"jitter\", pch = 20)\n\n\n\n\n\n\n\n\n\nA strip is created for each variable (column) in the dataset:\n\n\nset.seed(1)\nn &lt;- 500\ndtf &lt;- data.frame(\n  normal = rnorm(n),\n  uniform = runif(n, min = -1, max = 1)\n)\nstripchart(\n  dtf,\n  at = c(1, 2), xlim = c(0.5, 2.5), ylim = c(-3, 3),\n  method = \"jitter\", pch = 20,\n  group.names = c(\"Normal\", \"Uniform\"), xlab = \"Distribution\", ylab = \"Value\",\n  vertical = TRUE,\n  col = c(\"blue\", \"red\")\n)\nabline(h = c(-1, 1), lty = \"dashed\")\n\n\n\n\n\n\n\n\n\n\n12.3.1.5 boxplot\n\nDescriptive statistics of data\nGood for big datasets\n\n\nboxplot(dtf) # compare this with stripchart\n\n\n\n\n\n\n\n# abline(h = c(-1, 1), lty = \"dashed\")\n\n\nQuantiles isn’t everything, don’t rely on boxplots\n\n\nboxplot(anscombe)\n\n\n\n\n\n\n\n\n\n\n12.3.1.6 pairs\n\nCorrelation between pairs of variables\n\n\npairs(swiss, panel = panel.smooth, pch = \".\") \n\n\n\n\n\n\n\n\n\n\n12.3.1.7 coplot\n\nMultiple variables involved\nFocus on correlation between two variables\n\n\ncoplot(conc ~ Time | Subject, data = Theoph, show.given = FALSE)\n\n\n\n\n\n\n\n\n\n# coplot(lat ~ long | depth * mag, data = quakes)\n\n\n\n12.3.1.8 matplot\n\nmatplot, plot columns of matrices\n\n\nn &lt;- 20\nld &lt;- c(3, 5, 8, 10)\ndta &lt;- data.frame(\n  \"a\" = cumsum(rpois(n, lambda = ld[1])),\n  \"b\" = cumsum(rpois(n, lambda = ld[2])),\n  \"c\" = cumsum(rpois(n, lambda = ld[3])),\n  \"d\" = cumsum(rpois(n, lambda = ld[4]))\n)\nmatplot(dta, type = \"o\", pch = names(dta))\n\n\n\n\n\n\n\n\n\n\n12.3.1.9 dotchart\n\nnumber of values to be plotted are tenable\nall values are numeric from a range\nall values are to be compared\nboth column and row names are important\n\n\ndotchart(c(\"a\" = 1:3, \"b\" = 4:6))\n\n\n\n\n\n\n\n\n\nwith row name\n\n\ndotchart(VADeaths)\n\n\n\n\n\n\n\n# dotchart(mtcars)\n\n\n\n12.3.1.10 curve\n\nPlot value of a function over an interval\n\n\n{\npar(pty=\"s\")\ncurve(x^2 - 2, -3, 3, col = \"blue\", asp = 1, ylab = \"\", lwd = 2,\n      main = expression(paste(\"Curve shifting \", x^{2})))\ncurve(x^2, add = TRUE, col = \"black\", lwd = 2)\ncurve((x + 1)^2 + 1, add = TRUE, col = \"violet\", lwd = 2)\nabline(h = 0, v = 0)\nabline(h = c(1, 2), v = -1, lty = \"dashed\")\naxis(side = 2, at = 1)\naxis(side = 1, at = -1)\narrows(x0 = 0, y0 = 0, x1 = 0, y1 = -2, code = 2, length = 0.2, angle = 15, col = \"blue\", lwd = 3)\narrows(x0 = 0, y0 = 0, x1 = -1, y1 = 0, code = 2, length = 0.2, angle = 15, col = \"violet\", lwd = 3)\narrows(x0 = -1, y0 = 0, x1 = -1, y1 = 1, code = 2, length = 0.2, angle = 15, col = \"violet\", lwd = 3)\nlegend(\"bottomright\",\n       legend = c(\n          expression(x^{2}),\n          expression(x^{2} - 2),\n          expression((x + 1)^{2} + 1)\n        ),\n       lty = 1,\n       lwd = 2,\n       col = c(\"black\", \"blue\", \"violet\")\n)\n}\n\n\n\n\n\n\n\n\nSee 12.2.1 Mathematical annotation\nFrom this example we see that\n\nPlots can be added to the existing plot with the add option (only available in some high-level plotting commands. e.g. ?barplot, ?stripchart, ?curve)\nLow-level commands can modify elements in the existing plot\n\n\n\n\n12.3.2 Low-level commands\nWe’ve seen in the previous example how extra information can be added to plots created by high-level commands. We give another example:\n\n{\nxs &lt;- seq(0, 1, by = 0.01)\nys &lt;- sqrt(1 - xs^2)\n\nset.seed(1)\nxp &lt;- runif(n)\nyp &lt;- runif(n)\n\nic &lt;- xp^2 + yp^2 &lt; 1\n\nn &lt;- 1000\npar(pty=\"s\")\nplot(0:1, 0:1, type = \"n\", asp = 1, xaxs = \"i\", yaxs = \"i\",\n     xlab = \"\", ylab = \"\")\nlines(x = xs, y = ys)\n# curve(sqrt(1 - x^2), 0, 1, add = TRUE)\n#curve(-sqrt(1 - x^2), -1, 1, add = TRUE)\npolygon(c(xs, 1, 0), c(ys, 0, 0), col = \"lightblue\")\npoints(xp[ic], yp[ic], col = \"blue\", pch = 19)\npoints(xp[!ic], yp[!ic], col = \"black\", pch = 1)\ntext(0.4, 0.4, expression(pi/4), cex = 4, bg = \"red\")\ntitle(main = \"Monte Carlo integration\", sub = expression(paste(\"estimating \", pi)))\n\n}\n\n\n\n\n\n\n\n\n\npoints, add scattered points\nlines, add lines\ntext, annotate graph with text\nabline, add straight line, shorthand for horizontal or vertical\npolygon, add a shaded area\narrows, add arrow\nlegend, add legend\ntitle(main =, sub =), add title to plot\naxis, edit axis",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Data Visualisation I</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_base.html#stats-graphics",
    "href": "chap_02/vis_base.html#stats-graphics",
    "title": "12  Data Visualisation I",
    "section": "12.4 stats graphics",
    "text": "12.4 stats graphics\nThe commands we demonstrated so far are from the graphics package which is part of base R. Another key package in base R is the stats package, which also includes some plotting commands. Take a look at ls(\"package:stats\") for more. We give a short example\n\nscatter.smooth(x = cars$speed, y = cars$dist)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Data Visualisation I</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_base.html#graphical-parameters",
    "href": "chap_02/vis_base.html#graphical-parameters",
    "title": "12  Data Visualisation I",
    "section": "12.5 Graphical Parameters",
    "text": "12.5 Graphical Parameters\nMany of the graph settings are set via the par command. For a full list, refer to ?par. We give a lookup table for two most frequently used parameters.\n\n12.5.1 Point shapes pch\npch in R: How to Use Plot Character in R, R-Lang\n\nggpubr::show_point_shapes()\n\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\n\n\n\n\n\n\n\n\n\n\n\n12.5.2 Line Type lty\n\nggpubr::show_line_types()",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Data Visualisation I</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_base.html#exercises",
    "href": "chap_02/vis_base.html#exercises",
    "title": "12  Data Visualisation I",
    "section": "Exercises",
    "text": "Exercises\nSee Section 15.3 for exercises on plotting with Base R functions.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Data Visualisation I</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_ggplot.html",
    "href": "chap_02/vis_ggplot.html",
    "title": "13  Data Visualisation II",
    "section": "",
    "text": "13.1 R Markdown\nRecommended readings",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Data Visualisation II</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_ggplot.html#r-markdown",
    "href": "chap_02/vis_ggplot.html#r-markdown",
    "title": "13  Data Visualisation II",
    "section": "",
    "text": "This week’s lecture notes are all in R Markdown format (rather than powerpoint)\n.nb.html are rendered notebooks (with option to download the R Markdown source)\nInteraction with .Rmd files in RStudio is similar to Jupyter Notebooks (IPython)\nrmarkdown comes installed with RStudio\n\n\n\n\nIllustration: R Markdown workflow\n\n\n\nWrite once, output in many formats\n\nAs html\nAs pdf\n\ninstall.packages('tinytex')\ntinytex::install_tinytex()\n\nAs slides (ppt, HTML-based presentations)\n\nCombines\n\nDescriptive text\nCode\nCode result\n\n\n\n\n\nScreenshot: Create R Markdown file",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Data Visualisation II</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_ggplot.html#ggplot2",
    "href": "chap_02/vis_ggplot.html#ggplot2",
    "title": "13  Data Visualisation II",
    "section": "13.2 ggplot2",
    "text": "13.2 ggplot2\nTo use ggplot2 in your script, put library(\"ggplot2\") at the beginning of your .R script:\n\nlibrary(\"ggplot2\")\n\nSO: What is the difference between require() and library()\n\n13.2.1 Basics\nIn the graphics package, plots are created by a combination of high-level and low-level plotting functions. Plots are first created by high-level functions. Low-level functions add/modifies elements on top of the existing plot. ggplot2 has a similar approach.\nEach graph produced by ggplot is a top-down view on a stack of plots. At the bottom of this stack is the ggplot function which holds the data component. This data set is then mapped by geom_* functions (i.e. the geom component) onto a coordinate system to produce a plot.\n\n\n\nsource: https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf\n\n\n\nEach geom function has its own geometry definition of how to present the data:\n\ngeom_line() draws lines connecting data points\ngeom_point() draws data points as individuals\ngeom_histogram puts values of the plotted variable into bins before drawing vertical bars showing the size of each bin.\ngeom_*\nTo see what geom_ functions are available in ggplot2:\n\n\nlibrary(\"ggplot2\")\na &lt;- grep(\"geom\", ls(\"package:ggplot2\"), fixed = TRUE)\nls(\"package:ggplot2\")[a]\n\n [1] \"element_geom\"           \"geom_abline\"            \"geom_area\"             \n [4] \"geom_bar\"               \"geom_bin_2d\"            \"geom_bin2d\"            \n [7] \"geom_blank\"             \"geom_boxplot\"           \"geom_col\"              \n[10] \"geom_contour\"           \"geom_contour_filled\"    \"geom_count\"            \n[13] \"geom_crossbar\"          \"geom_curve\"             \"geom_density\"          \n[16] \"geom_density_2d\"        \"geom_density_2d_filled\" \"geom_density2d\"        \n[19] \"geom_density2d_filled\"  \"geom_dotplot\"           \"geom_errorbar\"         \n[22] \"geom_errorbarh\"         \"geom_freqpoly\"          \"geom_function\"         \n[25] \"geom_hex\"               \"geom_histogram\"         \"geom_hline\"            \n[28] \"geom_jitter\"            \"geom_label\"             \"geom_line\"             \n[31] \"geom_linerange\"         \"geom_map\"               \"geom_path\"             \n[34] \"geom_point\"             \"geom_pointrange\"        \"geom_polygon\"          \n[37] \"geom_qq\"                \"geom_qq_line\"           \"geom_quantile\"         \n[40] \"geom_raster\"            \"geom_rect\"              \"geom_ribbon\"           \n[43] \"geom_rug\"               \"geom_segment\"           \"geom_sf\"               \n[46] \"geom_sf_label\"          \"geom_sf_text\"           \"geom_smooth\"           \n[49] \"geom_spoke\"             \"geom_step\"              \"geom_text\"             \n[52] \"geom_tile\"              \"geom_violin\"            \"geom_vline\"            \n[55] \"get_geom_defaults\"      \"guide_geom\"             \"is_geom\"               \n[58] \"reset_geom_defaults\"    \"update_geom_defaults\"  \n\n\nAs well as ggplot and geom_* functions, we have other functions such as theme_* functions and scale_* functions to tweak other elements of the graph. This group of functions are not strictly required from the user. ggplot provides default values in absence of user defined values. To make publication quality graphs, it is essential to understand how these functions work.\n\n\n\n13.2.2 Plotting COVID-19\n\n13.2.2.1 Prepare data\nWe start by loading the cases.Rda file used by the CoMo app\n\n#try(lapply(paste('package:',names(sessionInfo()$otherPkgs),sep=\"\"),detach,character.only=TRUE,unload=TRUE), silent = TRUE) # clear additional package space if any is loaded\nrm(list = ls()) # delete all objects in current environment\n\nlibrary(ggplot2)\n\nload(url(\"https://github.com/ocelhay/como/raw/master/inst/comoapp/www/data/cases.Rda\"))\nls()\n\n[1] \"cases\" \"tests\"\n\ntypeof(cases)\n\n[1] \"list\"\n\n\nTwo data sets loaded. What’s in cases\n\nload(url(\"https://github.com/ocelhay/como/raw/master/inst/comoapp/www/data/cases.Rda\"))\n#head(cases)\n#summary(cases)\n#unique(cases$country)\n\nif (knitr::is_html_output()) {\n  rmarkdown::paged_table(cases)\n} else {\n  head(cases)\n}\n\n\n  \n\n\n\nGet UK specific time series\n\nload(url(\"https://github.com/ocelhay/como/raw/master/inst/comoapp/www/data/cases.Rda\"))\nuk_cases &lt;- cases[cases[[\"country\"]] == \"United Kingdom\", ] # filter rows\nuk_cases &lt;- uk_cases[c(\"country\", \"date\", \"cases\")]         # pick columns\nuk_cases &lt;- uk_cases[rowSums(is.na(uk_cases)) == 0, ]       # remove NAs\nif (knitr::is_html_output()) {\n  rmarkdown::paged_table(uk_cases)\n} else {\n  head(uk_cases)\n}\n\n\n  \n\n\n\n\n\n13.2.2.2 ggplot base plot\n\n\n\nsource: https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf\n\n\nggplot2 states that graphs are built from 3 components:\n\na data set\na coordinate system\ngeoms (specifications of aesthetic elements e.g. x and y locations, shape, size, and colour of data points)\n\nWhere a sensible default coordinate system is useful for most graphs, the &lt;data&gt; and &lt;geoms&gt; components need to be provided by the user.\nHere we tell ggplot that we want to draw a plot based on a data frame named uk_cases, and we pick the geom_point function to draw the data as points on the graph. We want to map the date column to the x axis, and the cases column to the y axis.\n\nggplot(data = uk_cases) +                        # data\n  geom_point(mapping = aes(x = date, y = cases)) # geom_func(mapping)\n\n\n\n\n\n\n\n\nThis is good, but often time series are drawn as lines. So let’s replace geom_point with geom_line\n\nggplot(data = uk_cases) +                       # data\n  geom_line(mapping = aes(x = date, y = cases)) # geom_func(mapping)\n\n\n\n\n\n\n\n\nThis looks better already. But what if I want both points and lines?\n\nLet’s stack the two layers together.\nWe also add an additional geom_smooth layer to give us some visual on the overall trend.\n\n\nggplot(data = uk_cases) +\n  geom_point(mapping = aes(x = date, y = cases)) +\n  geom_line(mapping = aes(x = date, y = cases)) +\n  geom_smooth(mapping = aes(x = date, y = cases), method = \"loess\", span = .2)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nThe graph is overly busy for no good reason now, but we demonstrated how different layers can be created by different geom functions and stacked together.\n\nMore on geom_smooth: https://ggplot2.tidyverse.org/reference/geom_smooth.html\nOn loess : https://en.wikipedia.org/wiki/Local_regression\n\n\n\n13.2.2.3 Inheritance\nSo far the data + geom_func(aes) grammar is readable from the code, but we also see some repetition of the code segment mapping = aes(x = date, y = cases) appearing 3 times in our code. To simplify our code, a mechanism called inheritance can be utilised.\n?geom_point and ?geom_line both show that a parameter inherit.aes is TRUE by default, which allows both geom functions to inherit the aesthetics mapping from the base layer defined by ggplot\n\nggplot(uk_cases, aes(x = date, y = cases)) +\n  geom_point() + geom_line() + geom_smooth(span = .2)\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nWe can see that using inheritance, we produced exactly the same plot without repeating ourselves. (Don’t repeat yourself is a principle applied in good software practices).\nNote that we lost the data and mapping keywords too, and the aes definition only appear once in the code. We now have shorter and easier code to maintain, but the grammar in grammar of graphics has become less obvious. This is also why every online tutorial is slightly different to each other despite performing the same actions. Reading others’ codes is a very useful way to improve your own coding skill.\n\n\n13.2.2.4 Overwrite\nGet data for United States in us_cases.\n\nus_cases &lt;- cases[cases[[\"country\"]] == \"United States\",] # filter rows\nus_cases &lt;- us_cases[c(\"country\", \"date\", \"cases\")]       # pick columns\nus_cases &lt;- us_cases[rowSums(is.na(us_cases)) == 0,]      # remove NAs\nif (knitr::is_html_output()) {\n  rmarkdown::paged_table(us_cases)\n} else {\n  head(us_cases)\n}\n\n\n  \n\n\n\nWe reset the UK time series to just one plot using the points and add the US time series as a line. The UK case numbers look a lot less scary now.\n\nggplot(uk_cases, aes(x = date, y = cases)) +\n  geom_point() + geom_line(data = us_cases)\n\n\n\n\n\n\n\n\nThe data = us_cases statement in geom_line() now overwrites the data = uk_cases statement inherited from the base layer constructed by the ggplot function.\n\nQuestion: Here, the aes did not need to be re-stated in geom_line despite having a different data to plot. Why?\n\nLet’s add the world total number of daily cases to our graph too. We draw all three time series with lines.\n\nworld_sum &lt;- aggregate(cases[, \"cases\"], list(date = cases[[\"date\"]]), sum) # Forgot to filter the rows for the continents here\n#unique(cases[[\"country\"]])\nworld_sum &lt;- world_sum[rowSums(is.na(world_sum)) == 0, ]\n\nggplot(mapping = aes(x = date, y = cases)) +\n  geom_line(data = world_sum) + \n  geom_line(data = uk_cases) + \n  geom_line(data = us_cases)\n\n\n\n\n\n\n\n\nNote that each of the three lines are from a different data frame.\n\nQuestion: If we remove mapping = from ggplot so that it is written like ggplot(aes(x = date, y = cases)) + .... would it still work?\n\n\nggplot(aes(x = date, y = cases)) +\n  geom_line(data = world_sum) +\n  geom_line(data = uk_cases) +\n  geom_line(data = us_cases)\n\n\n\n13.2.2.5 Colours, labels, scales, and coordinates\nNow let’s better the graph so that\n\nThe three time series are distinguishable\nBoth axes are labeled clearly\nTicks on the axes are more informative\nY is in log-scale\nRemove the grey background\nTruncate the lines so that the plot covers exactly one year in time\n\n\noptions(scipen = 999)  # turn off scientific notation like 1e+06\n\ng &lt;- ggplot(mapping = aes(x = date, y = cases)) +\n  geom_line(data = world_sum, aes(color = \"World\")) +\n  geom_line(data = uk_cases,  aes(color = \"UK\")) +\n  geom_line(data = us_cases,  aes(color = \"US\")) +\n  labs(\n    x = \"Dates\",\n    y = \"Daily Cases\",\n    title = \"Covid-19 daily cases comparison\",\n    subtitle = \"1 year tracker\",\n    caption = \"source: CoMo\"\n  ) +\n  scale_y_log10(\n    breaks = scales::trans_breaks(\"log10\", function(x) 10^x),\n    labels = scales::trans_format(\"log10\", scales::math_format(10^.x))\n  ) +\n  # scale_y_continuous(\n  #   trans = \"log10\",\n  #   breaks = scales::trans_breaks(\"log10\", function(x) 10^x),\n  #   labels = scales::trans_format(\"log10\", scales::math_format(10^.x))\n  # ) +\n  annotation_logticks() +\n  theme_bw() +\n  scale_color_manual(\n    # name=\"\",\n    values = c(\"World\" = \"black\", \"US\" = \"#50e2c1\", \"UK\" = \"#faaf3f\")\n  )\n  \ng1 &lt;- g +\n  scale_x_date(\n    date_labels = \"%b\",\n    date_breaks = \"1 month\",\n    limits = as.Date(c(\"2020-03-01\", \"2021-03-01\"))\n  )\nplot(g1)\n\nWarning in scale_y_log10(breaks = scales::trans_breaks(\"log10\", function(x) 10^x), : log-10 transformation introduced infinite values.\nlog-10 transformation introduced infinite values.\nlog-10 transformation introduced infinite values.\n\n\nWarning: Removed 60 rows containing missing values or values outside the scale range\n(`geom_line()`).\nRemoved 60 rows containing missing values or values outside the scale range\n(`geom_line()`).\nRemoved 60 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\n\n\n\n\n\n\n\n\n?ggplot2::labs\n?ggplot2::scale_y_continuous\n?ggplot2::annotation_logticks\n\n\n\n13.2.2.6 Coordinate system\nWe can set x range by adjusting the &lt;coordinate system&gt; (last element of the grammar) instead.\n\ng2 &lt;- g + \n  coord_cartesian(\n      xlim = as.Date(c(\"2020-03-01\", \"2021-03-01\"))\n  ) + \n  scale_x_date(date_labels = \"%b\", date_breaks = \"1 month\")\n\nplot(g2)\n\nWarning in scale_y_log10(breaks = scales::trans_breaks(\"log10\", function(x) 10^x), : log-10 transformation introduced infinite values.\nlog-10 transformation introduced infinite values.\nlog-10 transformation introduced infinite values.\n\n\n\n\n\n\n\n\n\nNote how g1 and g2 differ at truncating the lines at the beginning:\n\ng1, setting limits in the scale function truncates the data before they are plotted\ng2, changing the coordinate system only modifies the viewing-window of the graph\n\nThis is mostly useful when you want to zoom in to an area of the plot.\n\ng3 &lt;- g + \n  coord_cartesian(\n    xlim = as.Date(c(\"2020-07-01\", \"2020-08-01\"))\n  ) +\n  scale_x_date(\n    date_labels = \"%b\", \n    date_breaks = \"1 month\"\n  )\n\nplot(g3)\n\nWarning in scale_y_log10(breaks = scales::trans_breaks(\"log10\", function(x) 10^x), : log-10 transformation introduced infinite values.\nlog-10 transformation introduced infinite values.\nlog-10 transformation introduced infinite values.\n\n\n\n\n\n\n\n\n\n\n\n13.2.2.7 Annotations\n\nuk_peak &lt;- uk_cases[which.max(uk_cases[[\"cases\"]]),]\ng11 &lt;- g1 +\n  geom_curve(aes(\n      xend = uk_peak[[\"date\"]],\n      yend = uk_peak[[\"cases\"]],\n      x = uk_peak[[\"date\"]]+60,\n      y = uk_peak[[\"cases\"]]*1.5\n    ),\n    curvature = 0.2,\n    arrow = arrow(length = unit(10, \"points\"))\n  ) +\n  geom_point(data = uk_peak, color = \"#ffaf3f\") +\n  annotate(\n    geom = \"text\",\n    label = \"UK max\",\n    x = uk_peak[[\"date\"]]+80,\n    y = uk_peak[[\"cases\"]]*1.5\n  )\nplot(g11)\n\nWarning in scale_y_log10(breaks = scales::trans_breaks(\"log10\", function(x) 10^x), : log-10 transformation introduced infinite values.\nlog-10 transformation introduced infinite values.\nlog-10 transformation introduced infinite values.\n\n\nWarning: Removed 60 rows containing missing values or values outside the scale range\n(`geom_line()`).\nRemoved 60 rows containing missing values or values outside the scale range\n(`geom_line()`).\nRemoved 60 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\n\n\n\n\n\n\n\n\n?ggplot2::annotation_logticks",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Data Visualisation II</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_ggplot.html#long-and-wide-data-format",
    "href": "chap_02/vis_ggplot.html#long-and-wide-data-format",
    "title": "13  Data Visualisation II",
    "section": "13.3 Long and wide data format",
    "text": "13.3 Long and wide data format\nIn the previous section, we used three separate data frames side by side which resembles a Wide data format. For data in this format, each series is stored in its own column. No filtering is needed once the column has been specified. The &lt;data&gt; component needs redefinition in each &lt;geom&gt; layer because a different column is used.\nThe same set of data can be rearranged in a Long format. In such format, all series keep their data in the same column. To distinguish ownership of each row’s data, an extra column is created.\n\n\n\nIllustration: Wide vs Long data format\n\n\n\nworld_sum[\"country\"] &lt;- \"World Total\"\nlong_data &lt;- rbind(uk_cases, us_cases, world_sum)\nggplot(data = long_data, mapping = aes(x = date, y = cases)) +\n  geom_line(aes(colour = country))\n\n\n\n\n\n\n\n\nNote how R automatically added a legend to the plot. This comes when an aesthetic setting is dependent on a column,colour = country in this case.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Data Visualisation II</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_ggplot.html#more-plot-types",
    "href": "chap_02/vis_ggplot.html#more-plot-types",
    "title": "13  Data Visualisation II",
    "section": "13.4 More plot types",
    "text": "13.4 More plot types\n\n13.4.1 Scatter\n\nper_country_sum &lt;- aggregate(\n  x = list(cases[, \"cases\"], cases[,\"deaths\"]),\n  by = list(country = cases[[\"country\"]]),\n  FUN = sum,\n  na.rm = TRUE\n)\n\nlibrary(\"countrycode\")\nper_country_sum[[\"continent\"]] &lt;- countrycode(\n                                      sourcevar = per_country_sum[,\"country\"],\n                                      origin = \"country.name\",\n                                      destination = \"continent\"\n                                    )\n\nWarning: Some values were not matched unambiguously: Africa, America, Asia, Europe, Kosovo, Oceania, Other continent, World\n\nper_country_sum &lt;- per_country_sum[rowSums(is.na(per_country_sum)) == 0,]\nper_country_sum &lt;- per_country_sum[per_country_sum[\"deaths\"] &gt; 10,]\n\n#paged_table(per_country_sum)\n\ng4 &lt;- ggplot(data = per_country_sum, aes(x = cases, y = deaths, colour = continent)) +\n  geom_smooth(data = per_country_sum, mapping = aes(colour = NULL), method = \"lm\", span = .2) +\n  geom_point() +\n  scale_y_log10(\n    breaks = scales::trans_breaks(\"log10\", function(x) 10^x),\n    labels = scales::trans_format(\"log10\", scales::math_format(10^.x)),\n    limits = c(10,10^6)\n  ) +\n  scale_x_log10(\n    breaks = scales::trans_breaks(\"log10\", function(x) 10^x),\n    labels = scales::trans_format(\"log10\", scales::math_format(10^.x)),\n    limits = c(10,10^8)\n  ) +\n  annotation_logticks() +\n  coord_fixed()\n\nplot(g4)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning: Removed 6 rows containing missing values or values outside the scale range\n(`geom_smooth()`).\n\n\n\n\n\n\n\n\n\n\nmin_death_rate &lt;- per_country_sum[\n                    which.min(\n                      per_country_sum[[\"deaths\"]]/per_country_sum[[\"cases\"]]\n                    ),\n                  ]\nmax_death_rate &lt;- per_country_sum[\n                    which.max(\n                      per_country_sum[[\"deaths\"]]/per_country_sum[[\"cases\"]]\n                    ),\n                  ]\nmax_death_count &lt;- per_country_sum[\n                    which.max(\n                      per_country_sum[[\"deaths\"]]\n                    ),\n                  ]\nmax_cases_count &lt;- per_country_sum[\n                    which.max(\n                      per_country_sum[[\"cases\"]]\n                    ),\n                  ]\n\ninterested_countries &lt;- per_country_sum[is.element(\n                            per_country_sum[[\"country\"]],\n                            c(\"United Kingdom\", \"Australia\", \"Japan\")\n                        ),]\n\nhighlighted_rows &lt;- rbind(\n                      min_death_rate,\n                      max_death_rate,\n                      max_death_count,\n                      max_cases_count,\n                      interested_countries\n                    )\n\ng41 &lt;- g4 +\n  geom_point(\n    data = highlighted_rows,\n    shape = 4,\n    size = 5\n  ) +\n  geom_label(\n    data = highlighted_rows,\n    mapping = aes(label = country),\n    nudge_x = 0.3,\n    nudge_y = 0.4\n  )\n\nplot(g41)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning: Removed 6 rows containing missing values or values outside the scale range\n(`geom_smooth()`).\n\n\n\n\n\n\n\n\n\n\n\n13.4.2 Density\n\nper_country_sum[[\"death_rate\"]] &lt;- per_country_sum[[\"deaths\"]]/per_country_sum[[\"cases\"]]\n\ng5 &lt;- ggplot(per_country_sum, aes(x = death_rate))\ng5 +\n  geom_density(aes(color = continent), alpha = 0.4) #+\n\n\n\n\n\n\n\n  #scale_x_continuous(limits = c(0,0.1))\n\n\n\n13.4.3 Boxplot\n\n#per_country_sum[[\"death_rate\"]] &lt;- per_country_sum[[\"deaths\"]]/per_country_sum[[\"cases\"]]\nper_country_sum_no_yemen &lt;- per_country_sum[per_country_sum[[\"country\"]] != \"Yemen\",]\n\ng6 &lt;- ggplot(\n  per_country_sum_no_yemen,\n  aes(\n    x = continent,\n    y = death_rate,\n    fill = continent,\n  ),\n  alpha = 0.5\n)\n\nWarning in fortify(data, ...): Arguments in `...` must be used.\n✖ Problematic argument:\n• alpha = 0.5\nℹ Did you misspell an argument name?\n\ng_vio &lt;- g6 + geom_violin()\ng_box &lt;- g6 + geom_boxplot()\nplot(g_box)\n\n\n\n\n\n\n\nplot(g_vio)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Data Visualisation II</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_ggplot.html#other-related-packages",
    "href": "chap_02/vis_ggplot.html#other-related-packages",
    "title": "13  Data Visualisation II",
    "section": "13.5 Other related packages",
    "text": "13.5 Other related packages\n\nggsci, Scientific Journal and Sci-Fi Themed Color Palettes for ggplot2\ngridExtra, Miscellaneous Functions for “Grid” Graphics\n\n\nlibrary(\"ggsci\")\nlibrary(\"gridExtra\")\ng_box_npg &lt;- g_box + scale_fill_npg()\ng_box_nejm &lt;- g_box + scale_fill_nejm()\ng_box_lancet &lt;- g_box + scale_fill_lancet()\ng_box_jama &lt;- g_box + scale_fill_jama()\ngrid.arrange(g_box_npg, g_box_nejm, g_box_lancet, g_box_jama, ncol = 2)\n\n\n\n\n\n\n\n\n\nggExtra, Marginal Histograms and Boxplots\n\n\nlibrary(\"ggExtra\")\nggMarginal(g41, type = \"histogram\")\n\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning: Removed 6 rows containing missing values or values outside the scale range\n(`geom_smooth()`).",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Data Visualisation II</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_ggplot.html#read-more-about-ggplot2",
    "href": "chap_02/vis_ggplot.html#read-more-about-ggplot2",
    "title": "13  Data Visualisation II",
    "section": "13.6 Read more about ggplot2",
    "text": "13.6 Read more about ggplot2\n\n50 Examples http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html\nggplot2: Elegant Graphics for Data Analysis https://ggplot2-book.org/introduction.html\ngrid.arrange https://cran.r-project.org/web/packages/egg/vignettes/Ecosystem.html",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Data Visualisation II</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_ggplot.html#challenge",
    "href": "chap_02/vis_ggplot.html#challenge",
    "title": "13  Data Visualisation II",
    "section": "13.7 Challenge",
    "text": "13.7 Challenge\nFind an open access article from Nature Communications and reproduce a plot from the article.\n\nArticles are listed on https://www.nature.com/ncomms/articles?type=article\nUse the search box on the top right of the page to find articles of your interest (e.g. “covid-19”, “malaria”, “epidemiology”, “modelling etc. ).\nMost articles include the data they use for their figures in the “Source Data” section.\nUse the source data\ne.g. https://www.nature.com/articles/s41467-021-24997-7#Sec41\n\nYour version of the plot can be a exact replica of the author’s plot if you think it is of good quality, you can also make an improved version of the original plot if you see fit.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Data Visualisation II</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_ggplot.html#publication-quality-figures",
    "href": "chap_02/vis_ggplot.html#publication-quality-figures",
    "title": "13  Data Visualisation II",
    "section": "Publication-quality figures",
    "text": "Publication-quality figures\n\nNicolas P. Rougier, Michael Droettboom, Philip E. Bourne, Ten Simple Rules for Better Figures, PLOS Computational Biology, code\nDaniel Evanko, Data Visualization: A view of every Points of View column, Nature Methods, methagora\nTamara Munzner, Talk on d3.unconf(2015), Video: Visualization Analysis & Design\nTamara Munzner, Talk, Visualisation Analysis & Design\nTamara Munzner, Video: Map Color and Other Channels. Visualization Analysis & Design Tutorial, Video 6",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Data Visualisation II</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_ggplot.html#colours-in-r",
    "href": "chap_02/vis_ggplot.html#colours-in-r",
    "title": "13  Data Visualisation II",
    "section": "Colours in R",
    "text": "Colours in R\n\nR color cheat sheet\nColors in R",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Data Visualisation II</span>"
    ]
  },
  {
    "objectID": "chap_02/vis_ggplot.html#the-operator",
    "href": "chap_02/vis_ggplot.html#the-operator",
    "title": "13  Data Visualisation II",
    "section": "The + operator",
    "text": "The + operator\nEach layer on the ggplot graph stack is defined by a function, and these functions are all concatenated with the + operator. We know how + is defined for literals, such as in 1 + 2 or \"abc\" + \"def\". But what does it do in between ggplot functions?\nWhereas commonly used math functions such as max, abs, and sqrt return the user with a numerical value, these functions such as the geom functions perform a set of procedures that either produce or modify a plot or several plots in the graph stack. The + operator here not only sticks these plots and performs the procedures one by one to produce the final graph. Because these functions are of different nature, the + operator in this context also acts as a dispatcher. For those interested in knowing more about this subject and what’s going on behind the scenes:\n\n&gt; ggplot2:::`+.gg`\nfunction (e1, e2) {\n  e2name &lt;- deparse(substitute(e2))\n  if (is.theme(e1))\n    add_theme(e1, e2, e2name)\n  else if (is.ggplot(e1))\n    add_ggplot(e1, e2, e2name)\n}\n\nref: https://stackoverflow.com/questions/40450904/how-is-ggplot2-plus-operator-defined",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Data Visualisation II</span>"
    ]
  },
  {
    "objectID": "chap_02/work_w_files.html",
    "href": "chap_02/work_w_files.html",
    "title": "14  Working with files",
    "section": "",
    "text": "14.1 Working directory\nWhen your code refers to a file on your HD, the first thing it needs is the address of that file. The address contains directory names and file name which works as a path that leads the code to the target file, therefore we also refer to the address as the path of the file.\nThere are two methods to compose the path of a file, namely absolute path and relative path. Read Appendix A first if you are not familiar to the differences between these two concepts.\nIn this section, we assume that we are working within an R project all relevant files of which are saved under one directory which we refer to as the root directory of the project. And we only use relative paths that begins from this root directory to address our target files.\nThe example project has the following directory structure:\nEvery time you open RStudio or start an interactive session (REPL), a Working Directory is set for that session. This is so that R knows where you are in the file system, to prepare for any I/O operations.\nThis is similar to when you press the “Crew” button on an flight cabin. In order to answer your call, the first piece of information the cabin crew needs to know is where you are in the cabin.\ngetwd()\nsetwd(file.path(\"C:\", \"temp\"))\nlist.files()",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Working with files</span>"
    ]
  },
  {
    "objectID": "chap_02/work_w_files.html#working-directory",
    "href": "chap_02/work_w_files.html#working-directory",
    "title": "14  Working with files",
    "section": "",
    "text": "image source\n\n\n\nThe default working directory for RStudio (when no project is open) is the user’s home directory, which is:\n\non macOS is /Users/[your user name]\non Windows is C:/Users/[your user name]/Documents\n\nYou can find out what your current working directory is by calling the getwd() function\nYou can change the working directory with setwd\nUse file.path to concatenate your directory names",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Working with files</span>"
    ]
  },
  {
    "objectID": "chap_02/work_w_files.html#save-load",
    "href": "chap_02/work_w_files.html#save-load",
    "title": "14  Working with files",
    "section": "14.2 save, load",
    "text": "14.2 save, load\n\nsave writes an external representation of the current workspace/global environment to a file. That includes everything (Data, Values, Functions) that you see in the Environment tab.\nsave.image() is a short-hand version of save. A file named .RData is created in the current working directory that contains everything in your current global environment.\nload reloads everything that was saved in the RData file into the global environment (default, specified by the envir argument)\n\n\nsave.image()\nload(file.path(\"C:\", \"Users\", \"bogao\", \"Projects\", \"OxfordMGH\", \"intro-r-material\", \".RData\"))\n# load(file.choose())\nload(url(\"https://github.com/ocelhay/como/raw/master/inst/comoapp/www/data/cases.Rda\"))\n\n\nYou can also select the objects that you wish to save to the file\n\n\na &lt;- 100\nb &lt;- a * 32\n# ls()\nout_file &lt;- file.path(\"data\", \"ab.RData\")\nsave(a, b, file = out_file)\nload(file = out_file)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Working with files</span>"
    ]
  },
  {
    "objectID": "chap_02/work_w_files.html#sec-working-dir",
    "href": "chap_02/work_w_files.html#sec-working-dir",
    "title": "14  Working with files",
    "section": "14.3 Working directory",
    "text": "14.3 Working directory",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Working with files</span>"
    ]
  },
  {
    "objectID": "chap_02/work_w_files.html#sec-file.path",
    "href": "chap_02/work_w_files.html#sec-file.path",
    "title": "14  Working with files",
    "section": "14.4 file.path",
    "text": "14.4 file.path",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Working with files</span>"
    ]
  },
  {
    "objectID": "chap_02/work_w_files.html#save-load-1",
    "href": "chap_02/work_w_files.html#save-load-1",
    "title": "14  Working with files",
    "section": "14.5 save, load",
    "text": "14.5 save, load\nWe introduced save and load in session 1. We did not introduce the concept of environment then. So here we give an example of loading an R datafile into an environment.\n\ne1 &lt;- new.env()\nload(url(\"https://github.com/ocelhay/como/raw/master/inst/comoapp/www/data/cases.Rda\"), envir = e1)\nls(e1)\ne1$cases",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Working with files</span>"
    ]
  },
  {
    "objectID": "chap_02/work_w_files.html#summary",
    "href": "chap_02/work_w_files.html#summary",
    "title": "14  Working with files",
    "section": "14.6 summary",
    "text": "14.6 summary\nUse summary for an overview of the dataset\n\nsummary(e1$cases)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Working with files</span>"
    ]
  },
  {
    "objectID": "chap_02/work_w_files.html#read.table",
    "href": "chap_02/work_w_files.html#read.table",
    "title": "14  Working with files",
    "section": "14.7 read.table",
    "text": "14.7 read.table\n\n?read.table - Reads a file in table format and creates a data frame from it, with cases corresponding to lines and variables to fields in the file.\n\nPatients admitted to hospital, daily, Oxford University Hospital NHS Foundation Trust, data downloaded from this link.\n\nfile_name &lt;- file.path(\"data\", \"data_2021-Oct-05.csv\")\n# file_name &lt;- file.choose()\n# d &lt;- read.table(file_name)\nd &lt;- read.table(file_name, sep = \",\")\n# head(d)\nsummary(d)\n\nread.csv is a shorthand call on read.table\n\nd &lt;- read.csv(file_name) # no need for sep = \",\"\nsummary(d)\ntypeof(d)\nclass(d)\n\nWe also notice that instead of “characters”, the columns now have the correct type. This is due to the different defaults on the header parameter\nLet’s read a header-less version of the csv with file.path\n\nd_no_header &lt;- read.table(\n  file.path(\"data\", \"data_2021-Oct-05_no_header.csv\"),\n  sep = \",\"\n)\nsummary(d_no_header)\n\nMore from the documentation ?read.table:\n\nread.table(file, header = FALSE, sep = \"\", quote = \"\\\"'\",\n           dec = \".\", numerals = c(\"allow.loss\", \"warn.loss\", \"no.loss\"),\n           row.names, col.names, as.is = !stringsAsFactors,\n           na.strings = \"NA\", colClasses = NA, nrows = -1,\n           skip = 0, check.names = TRUE, fill = !blank.lines.skip,\n           strip.white = FALSE, blank.lines.skip = TRUE,\n           comment.char = \"#\",\n           allowEscapes = FALSE, flush = FALSE,\n           stringsAsFactors = FALSE,\n           fileEncoding = \"\", encoding = \"unknown\", text, skipNul = FALSE)\n\nread.csv(file, header = TRUE, sep = \",\", quote = \"\\\"\",\n         dec = \".\", fill = TRUE, comment.char = \"\", ...)\n\nread.csv2(file, header = TRUE, sep = \";\", quote = \"\\\"\",\n          dec = \",\", fill = TRUE, comment.char = \"\", ...)\n\nread.delim(file, header = TRUE, sep = \"\\t\", quote = \"\\\"\",\n           dec = \".\", fill = TRUE, comment.char = \"\", ...)\n\nread.delim2(file, header = TRUE, sep = \"\\t\", quote = \"\\\"\",\n            dec = \",\", fill = TRUE, comment.char = \"\", ...)\n\nFrom the above documentation, we can see the difference in parameter values between each of the read.x function.\nTake a look at read.csv’s implementation:\n\nread.csv\n\nfunction (file, header = TRUE, sep = \",\", quote = \"\\\"\", dec = \".\", \n    fill = TRUE, comment.char = \"\", ...) \nread.table(file = file, header = header, sep = sep, quote = quote, \n    dec = dec, fill = fill, comment.char = comment.char, ...)\n&lt;bytecode: 0x12c9f5140&gt;\n&lt;environment: namespace:utils&gt;\n\n\n\nA few useful parameters:\n\nstringsAsFactors\n\n\nd &lt;- read.csv(file_name, stringsAsFactors = TRUE)\nsummary(d)\n\n\nas.is (?read.table: as.is = !stringsAsFactors)\n\n\nd &lt;- read.csv(file_name, stringsAsFactors = TRUE, as.is = c(1, 2))\nsummary(d)\ntypeof(d$areaCode)\ntypeof(d$areaType)\n\n\nstrip.white\n\n\nd &lt;- read.csv(file_name, stringsAsFactors = TRUE)\nsummary(d)\nd &lt;- read.csv(file_name, stringsAsFactors = TRUE, strip.white = TRUE)\nsummary(d)\n\n\nDate column\n\n\nd$date &lt;- as.Date(d$date)\nsummary(d)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Working with files</span>"
    ]
  },
  {
    "objectID": "chap_02/work_w_files.html#write.csv",
    "href": "chap_02/work_w_files.html#write.csv",
    "title": "14  Working with files",
    "section": "14.8 write.csv",
    "text": "14.8 write.csv\nThe opposite of reading a file is to write one to the disk, ?write.csv:\n\nwrite.table(x, file = \"\", append = FALSE, quote = TRUE, sep = \" \",\n            eol = \"\\n\", na = \"NA\", dec = \".\", row.names = TRUE,\n            col.names = TRUE, qmethod = c(\"escape\", \"double\"),\n            fileEncoding = \"\")\n\nwrite.csv(...)\nwrite.csv2(...)\n\nNote write.csv and write.csv2 has different parameter defaults althought they are not shown in the documentation\n\nwrite.csv(d, file = file.path(\"data\", \"write_d.csv\"))\n\nSee implementation of write.csv\n\nwrite.csv\n\n\nrow.names\n\n\nwrite.csv(\n  d,\n  file = file.path(\"data\", \"write_d.csv\"),\n  row.names = FALSE\n)\n\n\nna\n\nCompare the outputs from the two calls of write.csv\n\nd[2, 3] &lt;- NA\nwrite.csv(\n  d,\n  file = file.path(\"data\", \"write_d.csv\"),\n  row.names = FALSE\n)\nwrite.csv(\n  d,\n  file = file.path(\"data\", \"write_d.csv\"),\n  row.names = FALSE,\n  na = \"missing\"\n)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Working with files</span>"
    ]
  },
  {
    "objectID": "chap_02/work_w_files.html#excel-spreadsheet",
    "href": "chap_02/work_w_files.html#excel-spreadsheet",
    "title": "14  Working with files",
    "section": "14.9 Excel spreadsheet",
    "text": "14.9 Excel spreadsheet\n\nTo read Excel spreadsheet we use the readxl library from tidyverse.\nBecause it is part of tidyverse, the returned data set is a tibble.\n\n\nlibrary(readxl)\n# the package comes with example data files\nreadxl_example()\nfile_name &lt;- readxl_example(\"datasets.xlsx\")\n\n\nread_excel(file_name) # reads sheet 1 by default\nexcel_sheets(file_name)\nread_excel(file_name, sheet = \"quakes\")\nread_excel(file_name, sheet = \"quakes\", range = \"B4:D8\") # no header\n\nFor more information:\n\n?read_excel\nhttps://readxl.tidyverse.org/",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Working with files</span>"
    ]
  },
  {
    "objectID": "chap_02/work_w_files.html#other-statistical-systems",
    "href": "chap_02/work_w_files.html#other-statistical-systems",
    "title": "14  Working with files",
    "section": "14.10 Other statistical systems",
    "text": "14.10 Other statistical systems\nOther statistical systems are available, to communicate with files used in those systems, we use the foreign package. We give example of importing a .sav from from SPSS. Read more on this: Importing from other statistical systems\n\n# an example .sav is packed within the foreign package\nf &lt;- system.file(\"files\", \"electric.sav\", package = \"foreign\")\nsav &lt;- read.spss(file = f)\nstr(sav)\nclass(sav)\n\nsav &lt;- read.spss(file = f, to.data.frame = TRUE)\nclass(sav)",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Working with files</span>"
    ]
  },
  {
    "objectID": "exercises/exercises_all_2.html",
    "href": "exercises/exercises_all_2.html",
    "title": "15  Exercises II",
    "section": "",
    "text": "15.1 Exercises 3: Using vectors",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Exercises II</span>"
    ]
  },
  {
    "objectID": "exercises/exercises_all_2.html#sec-exercises-3",
    "href": "exercises/exercises_all_2.html#sec-exercises-3",
    "title": "15  Exercises II",
    "section": "",
    "text": "E3.1 Bmi2\nAdd a return value advice_text to the Bmi2 function we drafted in the lecture. The value of advice_text should be chosen from one of the four character strings below according to bim_value:\n\n“below 18.5 – you’re in the underweight range”\n“between 18.5 and 24.9 – you’re in the healthy weight range”\n“between 25 and 29.9 – you’re in the overweight range”\n“between 30 and 39.9 – you’re in the obese range”\n\n\nBmi2 &lt;- function(weight, height) {\n  # your code\n}\nbb &lt;- Bmi2(weight = 90, height = 1.75)\nbb[[\"value\"]]\nbb[[\"reduce_weight\"]]\nbb[[\"advice_text\"]]\n\n\n\nE3.2 ||, |, &&, &\nExecute the following code snippet and answer the two questions in the comment:\n\nrm(u)\nu # expect to see an error\n# Error: object 'u' not found\n\n# 1. Why do the next two expressions evaluate to different results and why?\nTRUE || u\nTRUE | u\n\n# 2. Why do the next two expressions evaluate to different results and why?\nFALSE && u\nFALSE & u\n\n\n\nE3.3 table\nGiven t &lt;- table(c(\"apple\", \"banana\", \"coconut\", \"apple\", \"apple\", \"banana\")) 1. What is the base type of t? 2. What attributes are associated with t? 3. What do you know about each of t’s attributes? 4. Which attribute(s) does t share with a matrix?\n\n\nE3.4 apply\nThe runif function generates a vector of uniformly distributed random numbers within a given interval. For example, runif(10, min = 2, max = 3) returns 10 random numbers between 2 and 3.\n\nWith the help of this function, create a 1000 x 6 matrix of uniformly distributed values between 5 and 6.\nCalculate the 6 column-wise averages of the 1000 x 6 matrix without using a for loop.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Exercises II</span>"
    ]
  },
  {
    "objectID": "exercises/exercises_all_2.html#sec-exercises-4",
    "href": "exercises/exercises_all_2.html#sec-exercises-4",
    "title": "15  Exercises II",
    "section": "15.2 Exercises 4: Using data.frame",
    "text": "15.2 Exercises 4: Using data.frame\n\nE4.1 SumPrimes\nProblem 10, Project Euler: The sum of the primes below 10 is 2 + 3 + 5 + 7 = 17. Find the sum of all the primes below two million. Use the sieve of Eratosthenes algorithm.\n\nSumPrimes &lt;- function(max_value) {\n  # your code\n}\nSumPrimes(10)  # 17\nSumPrimes(2e6) # 142913828922\n\n\n\nE4.2 data()\nHow many datasets are available via the data() command?\n\n\nE4.3 VADeaths\nThe VADeaths dataset that comes with R base records the death rates per 1000 in Virginia in 1940:\n\nWhat is the average death rate in the 55-59 age group in 1940?\nWhich population group has the highest death rate in the 60-64 age group?\n\n\n\nE4.4 WorldPhones\nThe WorldPhones dataset that comes with R base contains the number (in thousands) of telephones in various regions of the world:\n\nWhat is the total number of phones in year 1961?\nWhat is the year on year increase rate in phone usage in Asia from 1957 to 1958?\nWhere did the highest year on year increase happen from 1951 to 1961? and when?\nWhich year did Asia see the biggest increase rate in phone usage?\n\n\n\nE4.5 airquality\nThe airquality dataset that comes with R base gives the daily air quality measurements in New York, from May to September 1973:\n\nWhat is the average wind speed in New York in August 1973?\nIs there any dates missing from this dataset? (Are all dates from May to September 1973 in this dataset?)\nWhich day in May had the highest solar radiation?\nWhich variable (each column contains values/observations of a variable) has the most number of missing values?\n\n\n\nE4.6 Indometh\nThe Indometh dataset (built-in to R base) has 66 rows and 3 columns of data on the pharmacokinetics of indometacin of 6 subjects. Reshape it to a wide format.\n\n\nE4.7\nA simulation was run for a period of 10 years. Each year is assumed to be 365 days ignoring leap years. A row of data is written to an output csv file for each day of the simulation. (i.e. the output file has 3650 rows of data) The days column of this csv is a sequence of ascending integers from 9126 to 12775, with 9126 representing 2022-Jan-01, 12775 representing 2031-Dec-31. Our task now is to extract from this file, rows that represent the first day of each month, i.e. 2022-Jan-01, 2022-Feb-01, 2022-Mar-01, … 2031-Dec-01. For this purpose we need to construct a logical vector data_sel.\nIn the following script, let data_days represent the days column of the csv file.\n\nConstruct a vector data_sel which is of equal length to data_days with data_sel[ii] indicate whether data_days[ii] should be selected (data_sel[ii] == TRUE) or not (data_sel[ii] == FALSE). (Try do this without using any for / while loops)\nCheck that data_sel has 120 TRUE values, with all the rest being FALSE. How many ways (each using different functions) can you do this?",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Exercises II</span>"
    ]
  },
  {
    "objectID": "exercises/exercises_all_2.html#sec-exercises-5",
    "href": "exercises/exercises_all_2.html#sec-exercises-5",
    "title": "15  Exercises II",
    "section": "15.3 Exercises 5: Base R plotting",
    "text": "15.3 Exercises 5: Base R plotting",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Exercises II</span>"
    ]
  },
  {
    "objectID": "exercises/exercises_all_2.html#e5.1",
    "href": "exercises/exercises_all_2.html#e5.1",
    "title": "15  Exercises II",
    "section": "E5.1",
    "text": "E5.1\nMake a graph to illustrate the relation between Temp and Month in the airquality dataset.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Exercises II</span>"
    ]
  },
  {
    "objectID": "exercises/exercises_all_2.html#e5.2",
    "href": "exercises/exercises_all_2.html#e5.2",
    "title": "15  Exercises II",
    "section": "E5.2",
    "text": "E5.2\nMake a graph to illustrate the relation between count and spray in the InsectSprays dataset.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Exercises II</span>"
    ]
  },
  {
    "objectID": "exercises/exercises_all_2.html#e5.challenge-1-unit-circle",
    "href": "exercises/exercises_all_2.html#e5.challenge-1-unit-circle",
    "title": "15  Exercises II",
    "section": "E5.challenge 1: Unit circle",
    "text": "E5.challenge 1: Unit circle\nReproduce this graph of a unit circle as much as you can:",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Exercises II</span>"
    ]
  },
  {
    "objectID": "exercises/exercises_all_2.html#e5.challenge-2-the-datasaurus-dozen",
    "href": "exercises/exercises_all_2.html#e5.challenge-2-the-datasaurus-dozen",
    "title": "15  Exercises II",
    "section": "E5.challenge 2: The Datasaurus Dozen",
    "text": "E5.challenge 2: The Datasaurus Dozen\n\n\n\nDatasaurus image source\n\n\nThe Datasaurus Dozen is a modern adaptation of Anscombe’s Quartet. The Datasaurus dataset was originally proposed by Alberto Cairo to emphasis the importance of visualising data link. It was extended to the Datasaurus Dozen dataset and published on CHI’17. The dataset and its description is available via this link.\n\nDownload the dataset using this link, and plot all 13 datasets with scatter plots in a 4 x 4 grid.\nUse the blank spaces of the 4 x 4 grid with plots of your choice to illustrate that whilst these datasets are indistinguishable by summary statistics, each dataset has its own distribution pattern.",
    "crumbs": [
      "Data Processing",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Exercises II</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html",
    "href": "chap_03/chap_07.html",
    "title": "16  Statistical Models",
    "section": "",
    "text": "Model building in R\nOutline\nRecommended readings:",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html#model-building-in-r",
    "href": "chap_03/chap_07.html#model-building-in-r",
    "title": "16  Statistical Models",
    "section": "",
    "text": "What is R? - R is a language and environment for statistical computing and graphics.\n\n\n\nModel types\nStatistical methods\n\nLinear interpolation\nLinear regression\nNonlinear regression\nOptimisation\n\nMathematical models\n\nModel limits\nLorenz system\nSolve differential equations with desolve\nExponential growth model\nLogistic growth model\nLotka-Volterra model\nDrug concentration model\n\n\n\n\nChapter 23, R for Data Science, Hadley\n\n\nModel types\nWorldPhones is a dataset for the number of telephones in various regions of the world (in thousands) in the 1950s.\n\nWorldPhones\n\n     N.Amer Europe Asia S.Amer Oceania Africa Mid.Amer\n1951  45939  21574 2876   1815    1646     89      555\n1956  60423  29990 4708   2568    2366   1411      733\n1957  64721  32510 5230   2695    2526   1546      773\n1958  68484  35218 6662   2845    2691   1663      836\n1959  71799  37598 6856   3000    2868   1769      911\n1960  76036  40341 8220   3145    3054   1905     1008\n1961  79831  43173 9053   3338    3224   2005     1076\n\n\nWe see that data for a few years between 1951 and 1956 are missing.\n\nx_data &lt;- rownames(WorldPhones)[1:2]\ny_data &lt;- WorldPhones[1:2, \"N.Amer\"]\n{\nplot(\n  x = x_data, xlab = \"Years (t)\", col = \"blue\", pch = 16,\n  y = y_data, ylab = \"number of phones (n)\"\n)\ntext(x = 1953, y = 52500 + (rnorm(7)*3000), labels = c(\"?\"))\n}\n\n\n\n\n\n\n\n\nWhat if we want to estimate how many phones “N.Amer” had in 1953?\n\nWe assume that the increase in the number of phones (\\(n\\)) is constant over time (\\(t\\))\nWe assume that the values between 1951 and 1956 are only related to these two data points\n\n\n\nMethod 1 : Linear interpolation (approx, approxfun)\n\n\na &lt;- approx(x = x_data, y = y_data)\nafunc &lt;- approxfun(x = x_data, y = y_data)\nwanted_t &lt;- 1953\nwanted_n &lt;- afunc(wanted_t)\n\n{\nplot(\n  x = rownames(WorldPhones)[1:2], xlab = \"Years (t)\", col = \"blue\", pch = 16,\n  y = WorldPhones[1:2, \"N.Amer\"], ylab = \"number of phones (n)\",\n  main = \"Linear interpolation\"\n)\npoints(a)\npoints(x = wanted_t, y = wanted_n, pch = 18, col = \"red\", cex = 2)\ntext(x = wanted_t, y = wanted_n * 1.01, labels = paste0(\"(t = \", wanted_t, \", n = \", wanted_n, \")\"), pos = 2)\nabline(v = wanted_t, lty = \"dotted\")\nabline(h = wanted_n, lty = \"dotted\")\naxis(2, at = wanted_n, labels = paste0(wanted_n%/%1000, \"k\"), las = 2)\n}\n\n\n\n\n\n\n\n\n\nMethod 2 : Mathematical model\n\n\ndndt &lt;- diff(y_data) / diff(as.numeric(x_data))\n\nYearStep &lt;- function(n_prev_year, dndt) {\n  return(n_prev_year + dndt)\n}\n\nn &lt;- y_data[1]\nnum_years &lt;- wanted_t - as.numeric(x_data[1])\nstopifnot(num_years &gt;= 1)\nfor (tt in 1:num_years) {\n  n &lt;- YearStep(n, dndt)\n}\nn\n  \n# simplified version\n# f &lt;- function(init_n, init_t, dndt, t) {\n#   return(init_n + (t - init_t) * dndt)\n# }\n# f(y_data[1], as.numeric(x_data[1]), dndt, wanted_t) \n\nWe see that although the two methods reach the same conclusion, their modelling methods differ.\n\nMethod 1 (statistical): values are interpolated between the two known data points\nMethod 2 (mathematical): the yearly rate of change (\\(dn/dt\\)) is worked out for the state change equation\nThe initial assumption that the number of phones (\\(n\\)) increase linearly in time (\\(t\\)) is often a conclusion drawn from statistical analysis of the known data points.\nStatistical models build on the premise that a pattern is identifiable from a set of data points, and estimate the probability distribution of a set of outcomes.\nMathematical models describe the mechanisms of real world event with a set of equations (a system of equations), and derive predictions via simulation.\nStatistics is a mathematical discipline, and statistical models are a special class of mathematical model that uses statistical methods to describe data and make inferences\nMathematical model, just like mathematics, is widely applied across disciplines.\n\nMore on the difference between statistical and mathematical modelling approaches",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html#interpolation",
    "href": "chap_03/chap_07.html#interpolation",
    "title": "16  Statistical Models",
    "section": "16.1 Interpolation",
    "text": "16.1 Interpolation\n\nLinear interpolation\n\napprox - returns a list of points which linearly interpolate given data points.\napproxfun - returns a function that performs the interpolation.\n\nPolynomial interpolation\n\nspline - returns a list of points along the spline interpolation of the given data points.\nsplinefun - returns a function of the spline interpolation\n\n\n?approx:\n\nwith approx:\n\n\nset.seed(1)\nx &lt;- 1:10\ny &lt;- rnorm(10)\n{\nplot(x, y, pch = 16)\npoints(approx(x, y), col = \"blue\")\npoints(approx(x, y, method = \"constant\"), col = \"red\")\nlegend(\"topleft\",\n    legend = c(\"method = linear\", \"method = constant\"),\n    col = c(\"blue\", \"red\"),\n    pch = c(1, 1)\n)\n}\n\n\n\n\n\n\n\n\n\napproxfun\n\n\nf &lt;- approxfun(x, y)\n{\ncurve(f(x), 1, 10, col = \"green2\")\npoints(x, y)\n}\n\n\n\n\n\n\n\n\n\nsplinefun\n\n\n# x &lt;- 1:10\n# y &lt;- rnorm(10)\nf &lt;- splinefun(x, y)\ncurve(f(x), 1, 10)\npoints(x, y)\n\n\n\n\n\n\n\n\nInterpolation methods ensures that the fitted curve goes through every point in the observed dataset. A bit like connecting the dots:\n\n\nIt is great at preserving the known data exactly\nIt preserves all flaws that the data carries\nSelective representation of the real world situation, missing data points are not represented\nOver fit\n\nExample:\n\n# x &lt;- 1:10\n# y &lt;- rnorm(10)\n# f &lt;- splinefun(x, y)\nx_extra &lt;- 7.5\ny_extra &lt;- 0\nf2 &lt;- splinefun(c(x, x_extra), c(y, y_extra))\n\n{\ncurve(f(x), 1, 10)\npoints(x, y)\n# par(new = TRUE)\nx2 &lt;- seq(1, 10, by = 0.1)\ny2 &lt;- f2(x2)\nlines(x2, y2, col = \"red\")\npoints(x_extra, y_extra, col = \"red\", pch = 16)\nlegend(\"bottomright\", legend = c(\"original data\", \"additional data\"), pch = c(1, 16), col = c(\"black\", \"red\"))\n}",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html#linear-regression",
    "href": "chap_03/chap_07.html#linear-regression",
    "title": "16  Statistical Models",
    "section": "16.2 Linear regression",
    "text": "16.2 Linear regression\n\n?lm - performs linear least squares regression to fit linear models\n\n\n\n\nresiduals of least square fit, image source\n\n\n\n16.2.1 Dobson 2.2.2\nThis dataset comes from section 2.2.2 of Annette J. Dobson, “An introduction to generalized linear models”, 2nd edition:\n\nIn this table are the birthweights (in grams) and estimated gestational ages (in weeks) of 12 boys and 12 girls born in a certain hospital.\n\ndtf &lt;- data.frame(\n  age = c(40, 38, 40, 35, 36, 37, 41, 40, 37, 38, 40, 38,  # boys\n          40, 36, 40, 38, 42, 39, 40, 37, 36, 38, 39, 40), # girls\n\n  weight = c(2968, 2795, 3163, 2925, 2625, 2847, 3292, 3473, 2628, 3176, 3421, 2975, # boys\n             3317, 2729, 2935, 2754, 3210, 2817, 3126, 2539, 2412, 2991, 2875, 3231), # girls\n\n  gender = gl(2, 12, 24, labels = c(\"boys\", \"girls\"))\n)\nsummary(dtf)\n\n      age            weight       gender  \n Min.   :35.00   Min.   :2412   boys :12  \n 1st Qu.:37.00   1st Qu.:2785   girls:12  \n Median :38.50   Median :2952             \n Mean   :38.54   Mean   :2968             \n 3rd Qu.:40.00   3rd Qu.:3184             \n Max.   :42.00   Max.   :3473             \n\n\nLet’s use the simple weight is a function of age formula:\n\nf1 &lt;- weight ~ age\nlm1 &lt;- lm(f1, data = dtf)\nsummary(lm1)\n\n\nCall:\nlm(formula = f1, data = dtf)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-262.03 -158.29    8.35   88.15  366.50 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  -1485.0      852.6  -1.742   0.0955 .  \nage            115.5       22.1   5.228 3.04e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 192.6 on 22 degrees of freedom\nMultiple R-squared:  0.554, Adjusted R-squared:  0.5338 \nF-statistic: 27.33 on 1 and 22 DF,  p-value: 3.04e-05\n\n\n\nThe R-squared values is between 0 and 1. The lower end (closer to 0) indicate a poorly fitted model, the higher end (closer to 1) indicate a model of good fit.\nA p-value that’s less than 0.05 means an independent variable (predictor) plays a meaningful part in the fitted model.\nA small p-value of 3.04e-05 means that age plays a significant part in this model.\nA p-value of 0.0955 means that the intercept term is not significant for this model.\n\nLet’s take a look at the coefficients of the fitted model:\n\nattributes(lm1)\n\n$names\n [1] \"coefficients\"  \"residuals\"     \"effects\"       \"rank\"         \n [5] \"fitted.values\" \"assign\"        \"qr\"            \"df.residual\"  \n [9] \"xlevels\"       \"call\"          \"terms\"         \"model\"        \n\n$class\n[1] \"lm\"\n\nlm1$coefficients\n\n(Intercept)         age \n -1484.9846    115.5283 \n\n\nThe fitted formula is \\(weight = -1484.9846 + 115.5283\\times age\\):\n\n{\nplot(f1, data = dtf,  xlim = c(0,42), ylim = c(-1500, 3400))\nabline(lm1, col = \"red\")\nabline(h = 0)\n}#plot(lm1)\n\n\n\n\n\n\n\n\n\nThe negative intercept means that the baby has a negative weight at age 0\n\n\npredict(object = lm1, newdata = data.frame(age = 0)) # weight when age is 0 (intercept)\n\n        1 \n-1484.985 \n\n\nLet’s drop the intercept term from the formula:\n\nf2 &lt;- weight ~ age - 1\nlm2 &lt;- lm(f2, data = dtf)\nsummary(lm2)\n\n\nCall:\nlm(formula = f2, data = dtf)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-362.91 -148.65  -16.19  135.71  389.77 \n\nCoefficients:\n    Estimate Std. Error t value Pr(&gt;|t|)    \nage   77.081      1.063   72.51   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 200.9 on 23 degrees of freedom\nMultiple R-squared:  0.9956,    Adjusted R-squared:  0.9955 \nF-statistic:  5258 on 1 and 23 DF,  p-value: &lt; 2.2e-16\n\n\nThe p-value for age is 2.2e-16. Compare the two fitted models:\n\n{\nplot(f2, data = dtf, xlim = c(0,42), ylim = c(0, 3400))\nabline(lm2, col = \"blue\")\nabline(lm1, col = \"red\")\nlegend(\"topleft\", c(\"no intercept\", \"with intercept\"), lty = 1, col = c(\"blue\", \"red\"))\n}\n\n\n\n\n\n\n\n\n\nWe can bring gender into the formula:\n\nf3 &lt;- weight ~ 0 + age + gender\nlm3 &lt;- lm(f3, data = dtf)\nsummary(lm3)\n\n\nCall:\nlm(formula = f3, data = dtf)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-257.49 -125.28  -58.44  169.00  303.98 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \nage           120.89      20.46   5.908 7.28e-06 ***\ngenderboys  -1610.28     786.08  -2.049   0.0532 .  \ngendergirls -1773.32     794.59  -2.232   0.0367 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 177.1 on 21 degrees of freedom\nMultiple R-squared:  0.9969,    Adjusted R-squared:  0.9965 \nF-statistic:  2258 on 3 and 21 DF,  p-value: &lt; 2.2e-16\n\n\n\nWe can also fit the two genders separately:\n\nlm2_boys &lt;- lm(f2, data = dtf, subset = (gender == \"boys\"))\nlm2_girls &lt;- lm(f2, data = dtf, subset = (gender == \"girls\"))\nsummary(lm2_boys)\n\n\nCall:\nlm(formula = f2, data = dtf, subset = (gender == \"boys\"))\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-293.50 -194.15  -10.41  164.95  314.62 \n\nCoefficients:\n    Estimate Std. Error t value Pr(&gt;|t|)    \nage   78.959      1.515   52.13 1.59e-14 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 201.3 on 11 degrees of freedom\nMultiple R-squared:  0.996, Adjusted R-squared:  0.9956 \nF-statistic:  2718 on 1 and 11 DF,  p-value: 1.593e-14\n\nsummary(lm2_girls)\n\n\nCall:\nlm(formula = f2, data = dtf, subset = (gender == \"girls\"))\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-296.72 -108.26  -19.58  120.19  307.31 \n\nCoefficients:\n    Estimate Std. Error t value Pr(&gt;|t|)    \nage   75.242      1.345   55.95 7.34e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 180.7 on 11 degrees of freedom\nMultiple R-squared:  0.9965,    Adjusted R-squared:  0.9962 \nF-statistic:  3130 on 1 and 11 DF,  p-value: 7.343e-15\n\n\n\nb_col &lt;- \"deepskyblue\"\ng_col &lt;- \"deeppink\"\n{\nplot(f2, data = dtf, col = b_col, pch = 16)\npoints(dtf[dtf$gender == \"girls\",], col = g_col, pch = 16)\nabline(lm2_boys, col = b_col)\nabline(lm2_girls, col = g_col)\nlegend(\"topleft\", c(\"boys\", \"girls\"), lty = 1, col = c(b_col, g_col))\n}\n\n\n\n\n\n\n\n\n\nThe “R-squared” values is between 0 and 1. The lower end (closer to 0) indicate a poorly fitted model, the higher end (closer to 1) indicate a model of good fit.\nAdding gender to the model does improve the quality of the fit.",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html#non-linear-models",
    "href": "chap_03/chap_07.html#non-linear-models",
    "title": "16  Statistical Models",
    "section": "16.3 Non-linear models",
    "text": "16.3 Non-linear models\n\n16.3.1 Transformation\nThe Indometh dataset contains plasma concentration data of 6 subjects of indometacin, which was published in Kwan, Breault, Umbenhauer, McMahon and Duggan (1976) Kinetics of Indomethacin absorption, elimination, and enterohepatic circulation in man. Journal of Pharmacokinetics and Biopharmaceutics 4, 255–280.\nLet’s first inspect the dataset:\n\n# inspect the dataset\nnames(Indometh)\n\n[1] \"Subject\" \"time\"    \"conc\"   \n\nsummary(Indometh)\n\n Subject      time            conc       \n 1:11    Min.   :0.250   Min.   :0.0500  \n 4:11    1st Qu.:0.750   1st Qu.:0.1100  \n 2:11    Median :2.000   Median :0.3400  \n 5:11    Mean   :2.886   Mean   :0.5918  \n 6:11    3rd Qu.:5.000   3rd Qu.:0.8325  \n 3:11    Max.   :8.000   Max.   :2.7200  \n\nplot(conc ~ time, data = Indometh)\n\n\n\n\n\n\n\n\nWe see that data resembles the pattern of exponential decay:\n\n\n\nimage source\n\n\nTherefore we transform conc with log() and get a linear regression fit:\n\\(log(conc) = b + a \\times time\\)\n\nidm &lt;- lm(log(conc) ~ time, data = Indometh)\nsummary(idm)\n\n\nCall:\nlm(formula = log(conc) ~ time, data = Indometh)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.9558 -0.2940 -0.0206  0.3528  1.0125 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.09288    0.09337   0.995    0.324    \ntime        -0.41910    0.02468 -16.982   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4904 on 64 degrees of freedom\nMultiple R-squared:  0.8184,    Adjusted R-squared:  0.8155 \nF-statistic: 288.4 on 1 and 64 DF,  p-value: &lt; 2.2e-16\n\nt &lt;- 0:8\n{\nplot(conc ~ time, data = Indometh)\nlines(\n  x = t,\n  y = exp(predict(idm, data.frame(time = t))) # note we need exp() to transform y back\n)\n}\n\n\n\n\n\n\n\n\nPick one subject for fitting:\n\nIndometh_1 &lt;- Indometh[Indometh$Subject == 1,]\nidm_1 &lt;- lm(log(conc) ~ time, data = Indometh_1)\nsummary(idm_1)\n\n\nCall:\nlm(formula = log(conc) ~ time, data = Indometh_1)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.63614 -0.27362 -0.08709  0.33472  0.73837 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -0.22825    0.22407  -1.019    0.335    \ntime        -0.41862    0.05923  -7.068 5.87e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4804 on 9 degrees of freedom\nMultiple R-squared:  0.8473,    Adjusted R-squared:  0.8304 \nF-statistic: 49.96 on 1 and 9 DF,  p-value: 5.869e-05\n\n{\nt &lt;- 0:8\nplot(conc ~ time, data = Indometh)\npoints(conc ~ time, data = Indometh_1, pch = 16, col = \"blue\")\nlines(\n  x = t,\n  y = exp(predict(idm_1, data.frame(time = t))),\n  col = \"blue\"\n)\nlines(\n  x = t,\n  y = exp(predict(idm, data.frame(time = t))),\n  col = \"black\"\n)\nlegend(\"topright\", legend = c(\"all subjects\", \"subject 1\"), pch = c(1, 16), col = c(\"black\", \"blue\") )\n}\n\n\n\n\n\n\n\n\n\n\n16.3.2 nls\nWe now further our search with an nls (non-linear least squares) regression search.\nWe fitted with lm with a transformed conc:\n\n\\(log(conc) = b + a \\times time\\)\nb estimated at 0.09288\na estimated at -0.41910\n\nTransform the formula back to exponential form: \\(conc = exp(b + a \\times time)\\) –&gt; \\(conc = exp(b) \\times exp(a \\times time)\\)\nA standard exponential growth function: \\(P(t) = P_{0} \\times exp(r \\times t)\\)\nWe take the result from lm as starting\n\np0_init &lt;- exp(coefficients(idm)[1])\nr_init  &lt;- coefficients(idm)[2]\n\ninit &lt;- list(p0 = unname(p0_init), r = unname(r_init))\ninit\n\n$p0\n[1] 1.097336\n\n$r\n[1] -0.4191029\n\nidm_nls &lt;- nls(conc ~ p0 * exp(r * time), data = Indometh, start = init)\nsummary(idm_nls)\n\n\nFormula: conc ~ p0 * exp(r * time)\n\nParameters:\n   Estimate Std. Error t value Pr(&gt;|t|)    \np0  2.77706    0.15379   18.06   &lt;2e-16 ***\nr  -1.35038    0.09938  -13.59   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2001 on 64 degrees of freedom\n\nNumber of iterations to convergence: 9 \nAchieved convergence tolerance: 4.283e-06\n\n{\nt &lt;- seq(0, 8, by = 0.1)\nplot(conc ~ time, data = Indometh)\nlines(\n  x = t,\n  y = exp(predict(idm, data.frame(time = t))),\n  col = \"black\"\n)\nlines(\n  x = t,\n  y = predict(idm_nls, data.frame(time = t)),\n  col = \"skyblue\",\n  lwd = 2\n)\n}\n\n\n\n\n\n\n\n\n\nresiduals(idm)\nresiduals(idm_nls)\n\nsum(residuals(idm)^2)\nsum(residuals(idm_nls)^2)",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html#optimisation-with-optim",
    "href": "chap_03/chap_07.html#optimisation-with-optim",
    "title": "16  Statistical Models",
    "section": "16.4 Optimisation with optim",
    "text": "16.4 Optimisation with optim\nObserving the fitted model from nls we see that the fitting is done in iterations until a convergence tolerance is met. This type of search is often applied when the optimal solution (the best fit curve) isn’t obvious and the search space is also big enough that it is (computationally) impossible to try all combinations of parameter values.\nThis class of problem, when generalised, is referred to as optimisation problems. optim is R’s general-purpose optimisation function.\nThe Rosenbrock function is a non-convex function with the definition:\n\\(f(x, y) = (a - x)^2 + b(y-x^2)^2\\)\nThe global minimum is at \\((x, y) = (a, a^2)\\) where \\(f(x, y) = 0\\)\n\n\n\nimage source\n\n\n\na &lt;- 2\nb &lt;- 100\nfr &lt;- function(x) {   # Rosenbrock Banana function\n    x1 &lt;- x[1]\n    x2 &lt;- x[2]\n    (a - x1)^2 + b * (x2 - x1 * x1)^2\n}\noptim(c(-1.2, 1), fr)\n\n$par\n[1] 2.000267 4.001077\n\n$value\n[1] 7.874009e-08\n\n$counts\nfunction gradient \n     265       NA \n\n$convergence\n[1] 0\n\n$message\nNULL\n\n\nSee Test functions for optimisation for more functions like the Rosenbrock Banana function.",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html#e7.1",
    "href": "chap_03/chap_07.html#e7.1",
    "title": "16  Statistical Models",
    "section": "E7.1",
    "text": "E7.1\nIn our example using the WorldPhones dataset, we built a mathematical model assuming the number of new phones per year is a constant. What if we assume that the rate of change is constant, rather than the quantity? i.e. the number of phones has a constant year on year change rate of \\(r\\) such that:\n\\[n_{a+n} = n_{a}*(1+r)^{n}\\]\n\nModify the mathematical model we implemented in the lecture with this new assumption.\nCompare the results between these two different assumptions with a plot",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html#e7.2",
    "href": "chap_03/chap_07.html#e7.2",
    "title": "16  Statistical Models",
    "section": "E7.2",
    "text": "E7.2\nWe talked about how linear interpolation can be done with approxfun during the lecture. But we only talked about how values are interpolated between the extremes of the dataset. What if we need values outside of these bounds? (Tip: Read the documentation on approxfun)",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html#e7.3",
    "href": "chap_03/chap_07.html#e7.3",
    "title": "16  Statistical Models",
    "section": "E7.3",
    "text": "E7.3\nDuring the lecture, we used the following code to demonstrate how an additional data point can change the result of polynomial interpolations. Modify the code to demonstrate how changes in data point values (in this case a new value for y8) can also affect the interpolation result.\n\nset.seed(1)\nx &lt;- 1:10\ny &lt;- rnorm(10)\nf &lt;- splinefun(x, y)\nx_extra &lt;- 7.5\ny_extra &lt;- 0\nf2 &lt;- splinefun(c(x, x_extra), c(y, y_extra))\n\ny8_new &lt;- rnorm(1) # new value for y[8]\n\n{\ncurve(f(x), 1, 10)\npoints(x, y)\n# par(new = TRUE)\nx2 &lt;- seq(1, 10, by = 0.1)\ny2 &lt;- f2(x2)\nlines(x2, y2, col = \"red\")\npoints(x_extra, y_extra, col = \"red\", pch = 16)\n}",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html#e7.4",
    "href": "chap_03/chap_07.html#e7.4",
    "title": "16  Statistical Models",
    "section": "E7.4",
    "text": "E7.4\nPerform linear regression on R base’s built-in cars dataset.",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html#e7.5",
    "href": "chap_03/chap_07.html#e7.5",
    "title": "16  Statistical Models",
    "section": "E7.5",
    "text": "E7.5\nPerform linear regression on the anscombe dataset",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_07.html#e7.6",
    "href": "chap_03/chap_07.html#e7.6",
    "title": "16  Statistical Models",
    "section": "E7.6",
    "text": "E7.6\nUse optim to find the minimum of the Golstein-Price function.",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Statistical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_08.html",
    "href": "chap_03/chap_08.html",
    "title": "17  Mathematical Models",
    "section": "",
    "text": "17.1 Time travel etiquette\nModel building in R, outline\nThe human mind has long been fascinated by the concept of time. The idea of Time Travel makes frequent appearances in popular Sci-Fi mediums. In a scene from Avengers Endgame, the Ancient One explains why she can’t lend the Time Stone to Dr. Bruce Banner, and how the universe’s path would alter if the Time Stone were to be removed from its present timeline. A similar illustration was shown in the TV series Loki which shows multiple timelines veer off the pre-determined timeline because of unexpected events.\nAlthough we don’t yet have the technology to verify the details of time travel, don’t change anything in the past is a established etiquette when it comes to the practicalities of time travel. Theories such as the Butterfly Effect, which states that a small change in the present state of a dynamic system may have a dramatic effect in its future states, is also widely accepted.",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Mathematical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_08.html#time-travel-etiquette",
    "href": "chap_03/chap_08.html#time-travel-etiquette",
    "title": "17  Mathematical Models",
    "section": "",
    "text": "Image from Avengers Endgame and Loki",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Mathematical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_08.html#the-know-all-intellect",
    "href": "chap_03/chap_08.html#the-know-all-intellect",
    "title": "17  Mathematical Models",
    "section": "17.2 The know-all intellect",
    "text": "17.2 The know-all intellect\nUnderlying all these speculations and theories about time and the events it carries, sci-fi or scientific, is the human desire to know about the future, and the belief that for every action, there is an effect, and that between every two consequential states there is a determined path.\nAs eloquently put by the French scholar Pierre Simon Laplace (1749:1827):\n\n\n\n“A Philosophical Essay on Probabilities”\nPierre-Simon Laplace\n\n\n\n\nWe may regard the present state of the universe as the effect of its past and the cause of its future. An intellect which at a certain moment would know all forces that set nature in motion, and all positions of all items of which nature is composed, if this intellect were also vast enough to submit these data to analysis, it would embrace in a single formula the movements of the greatest bodies of the universe and those of the tiniest atom; for such an intellect nothing would be uncertain and the future just like the past would be present before its eyes.",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Mathematical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_08.html#mortal-model-limits",
    "href": "chap_03/chap_08.html#mortal-model-limits",
    "title": "17  Mathematical Models",
    "section": "17.3 Mortal model limits",
    "text": "17.3 Mortal model limits\nAs modellers, we wish to understand the past and predict the future just like the know-all intellect described by Laplace. This know-all intellect (also referred to as Laplace’s demon) is the ultimate goal of a mathematical modeller, the Holy Grail of the modelling trade. However, as good as it sounds, we have to admit that its requirements far exceed the mortal human capacity at present.\nTherefore, in the present reality, one all important rule while building and interpreting a model is to know its limits, and to understand the full range of outcomes it may produce. Above all, the key message from Laplace’s description of the know-all intellect is that without the know-all abilities, it is impossible for a model to give exact predictions of the future.\nA good model output often look like this:\n\n\n\nimage source",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Mathematical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_08.html#lorenz-system",
    "href": "chap_03/chap_08.html#lorenz-system",
    "title": "17  Mathematical Models",
    "section": "17.4 Lorenz system",
    "text": "17.4 Lorenz system\nLet’s build a model. To emphasis the effect of small changes in model parameters, i.e. the sensitivity of a model, as a first example of a mathematical model, let’s implement the Lorenz system from which the term “butterfly effect” stems.\n\nBehind every all powerful “model”, there is a set of differential equations.\n\nA Lorenz system is described by this set of differential equations:\n\\[\n\\frac{dx}{dt} = a \\cdot (y - x) \\\\\n\\frac{dy}{dt} = x \\cdot (b - z) - y \\\\\n\\frac{dz}{dt} = x \\cdot y - c \\cdot z\n\\]\nStep 1 - Let’s translate these differential equations into an R function:\n\nLorenz &lt;- function(t, state, parms) {\n  dx &lt;- parms[\"a\"]*(state[\"y\"] - state[\"x\"])\n  dy &lt;- state[\"x\"]*(parms[\"b\"] - state[\"z\"]) - state[\"y\"]\n  dz &lt;- state[\"x\"]*state[\"y\"] - parms[\"c\"]*state[\"z\"]\n  return(list(c(dx, dy, dz)))\n}\n\nSee ?ode for specification of the differential equation’s definition\nStep 2 - Now we define the initial states of the system:\n\ninit_state_1 &lt;- c(x = 1, y = 1, z = 1)\ninit_state_2 &lt;- c(x = 1.01, y = 1, z = 1)\n\nStep 3 - Assign values to the parameters:\n\nparameters &lt;- c(a = 10, b = 28, c = 8/3)\n\nStep 4 - Create a sequence of time points we want outputs for:\n\ntps &lt;- seq(0, 20, by = 0.01)\n\nStep 5 - We are ready to solve the model (integrate the differential equations) with the ode function from the deSolve package:\n\nout_1 &lt;- deSolve::ode(y = init_state_1, times = tps, func = Lorenz, parms = parameters)\nout_2 &lt;- deSolve::ode(y = init_state_2, times = tps, func = Lorenz, parms = parameters)\n\nLet’s remember these 5 steps as D.I.P.T.O.\n\n\n\nDIPTO\n\n\nCheck the result:\n\nhead(cbind(out_1, out_2))\n\n     time        x        y         z time        x        y         z\n[1,] 0.00 1.000000 1.000000 1.0000000 0.00 1.010000 1.000000 1.0000000\n[2,] 0.01 1.012567 1.259918 0.9848912 0.01 1.021742 1.262486 0.9850108\n[3,] 0.02 1.048823 1.523999 0.9731148 0.02 1.057485 1.528931 0.9733919\n[4,] 0.03 1.107207 1.798314 0.9651593 0.03 1.115622 1.805484 0.9656337\n[5,] 0.04 1.186866 2.088545 0.9617377 0.04 1.195268 2.097894 0.9624546\n[6,] 0.05 1.287555 2.400161 0.9638068 0.05 1.296153 2.411688 0.9648211\n\n\nPlot the outputs:\n\n# plot( x = out_1[, \"x\"], y = out_1[, \"z\"], type = \"l\", xlab = \"x\", ylab = \"z\", col = \"blue\")\n# lines(x = out_2[, \"x\"], y = out_2[, \"z\"], type = \"l\", xlab = \"x\", ylab = \"z\", col = \"red\")\n# {\n# rgl::plot3d (\n#   x = out_1[, \"x\"], y = out_1[, \"y\"], z = out_1[, \"z\"], type = \"l\", col = \"blue\",\n#   xlab = \"x\", ylab = \"y\", zlab = \"z\")\n# rgl::lines3d(x = out_2[, \"x\"], y = out_2[, \"y\"], z = out_2[, \"z\"], col = \"red\")  \n  \n# #rgl::play3d( rgl::spin3d( axis = c(0, 0, 1), rpm = 10), duration = 10 )\n# rgl::rglwidget(elementId = \"lorenz\", width = 520, height = 520)\n# }\n\nHave you found the butterfly yet? Watch this YouTube video in your spare time: Chaos - The Science of the Butterfly Effect\nMore on deSolve’s documentation",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Mathematical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_08.html#population-growth-models",
    "href": "chap_03/chap_08.html#population-growth-models",
    "title": "17  Mathematical Models",
    "section": "17.5 Population growth models",
    "text": "17.5 Population growth models\n\n17.5.1 Exponential growth / decay\n\n\n\nThe wheet and chessboard problem. image source\n\n\nA biological population grows at a rate that is proportional to its size. In a unit of time (\\(t\\)), with \\(P\\) denoting the population size, and \\(r\\) denoting the proportionality constant, the instantaneous growth rate is given by:\n\\[\\frac{dP}{dt} = r \\cdot P\\]\nLet’s follow the same 5 steps (D.I.P.T.O.):\n\nP0 &lt;- 10       # initial state P0\nT_LAST &lt;- 100  # time length\nT_INTR &lt;- 0.01 # time interval\nEXP_R &lt;- 0.1       # growth proportionality constant\n\n# 1 - Differential equation\nExpGrowth &lt;- function(t, state, parms) {\n  dp &lt;- parms[\"r\"]*state[\"p\"]\n  return(list(c(dp)))\n}\n## Using the `with` construct:\n# ExpGrowth &lt;- function(t, state, parms) {\n#   with(as.list(c(state, parms)), {\n#     dp &lt;- r * p\n#     return(list(c(dp)))\n#   })\n# }\n\n# 2 - Initial state\ninit_state &lt;- c(p = P0)\n\n# 3 - Parameters\nparameters &lt;- c(r = EXP_R)\n\n# 4 - Time\ntps &lt;- seq(0, T_LAST, by = T_INTR)\n\n# 5 - Ode (model integration)\nout_exp &lt;- deSolve::ode(y = init_state, times = tps, func = ExpGrowth, parms = parameters)\n\nNow, let’s plot the integrated model:\n\nplot(out_exp, xlab = \"Time (t)\", ylab = \"Population (P)\", main = \"Exponential growth\")\n\n\n\n\n\n\n\n\nThe exponential growth function can be solved analytically (most models don’t have an analytical solution):\n\\[P(t) = P_0 \\cdot e^{rt}\\]\nAnd we can check our result from the integrator (ode) against this function:\n\nExpFunc &lt;- function(t){\n  P0 * exp(EXP_R * t)\n}\n\n{\n# options(scipen=999)\nplot(out_exp, xlab = \"Time (t)\", ylab = \"Population (P)\", main = \"Exponential growth\")\nlines(x = tps + 0.5, y = ExpFunc(tps), col = \"blue\") # 0.5 - x-axis offset to see both curves\n}\n\n\n\n\n\n\n\n\nWe also often see the use of exponential decay function in biological system models. Drug concentration in blood is a typical example. The exponential decay model has negative growth rate:\n\\[\\frac{dP}{dt} = - r \\cdot P\\]\n\ninit_state_decay &lt;- c(p = 200000)\nparameters_decay &lt;- c(r = -EXP_R)\n\nout_exp_decay &lt;- deSolve::ode(y = init_state_decay, times = tps, func = ExpGrowth, parms = parameters_decay)\n\n{\nplot(out_exp, xlab = \"Time (t)\", ylab = \"Population (P)\", main = \"Exponential growth\", col = \"blue\")\nlines(out_exp_decay, col = \"red\")\ntext(x = 85, y = 150000, labels = \"growth\", col = \"blue\")\ntext(x = 15, y = 150000, labels = \"decay\", col = \"red\")\n}\n\n\n\n\n\n\n\n\n\n\n17.5.2 Logistic growth\nResource limitations mean that the population can’t exceed a certain limit, which we refer to as carrying capacity denoted \\(K\\). We introduce a term \\(1-\\frac{P}{K}\\) into the differential equation:\n\\[\\frac{dP}{dt} = r \\cdot P \\cdot (1-\\frac{P}{K})\\]\nwhich is referred to as the logistic growth or the Verhulst model. Note that the term \\(1-\\frac{P}{K}\\) is close to 1 when \\(P\\) is small which makes this equation to share a similar shape with the exponential growth model at the beginning. The growth slows as the population \\(P\\) approaches carrying capacity \\(K\\).\nDIPTO:\n\nLOG_K &lt;- 5000\n\n# 1 - Differential equation\nLogGrowth &lt;- function(t, state, parms) {\n  dp &lt;- parms[\"r\"] * state[\"p\"] * (1 - state[\"p\"] / parms[\"k\"])\n  return(list(c(dp)))\n}\n\n# 2 - Initial state\ninit_state_1 &lt;- c(p = P0) # Same as exponential growth\ninit_state_2 &lt;- c(p = LOG_K * 1.8) # Initial population greater than carrying capacity\n\n# 3 - Parameters\nparameters &lt;- c(r = EXP_R, k = LOG_K)\n\n# 4 - Time\n# Same as exponential growth\ntps &lt;- seq(0, T_LAST, by = T_INTR)\n\n# 5 - Ode (model integration)\nout_log_1 &lt;- deSolve::ode(y = init_state_1, times = tps, func = LogGrowth, parms = parameters)\nout_log_2 &lt;- deSolve::ode(y = init_state_2, times = tps, func = LogGrowth, parms = parameters)\n\nLet’s compare the two growth functions:\n\n{\ncol_1 &lt;- \"blue\"\ncol_2 &lt;- \"red\"\ncol_3 &lt;- \"black\"\nplot(\n  out_exp,\n  xlab = \"Time (t)\", ylab = \"Population (P)\", main = \"Population growth functions\",\n  ylim = c(0, LOG_K * 2), col = col_1\n)\nlines(out_log_1, col = col_2)\nlines(out_log_2, col = col_2)\nabline(h = LOG_K, col = col_3, lty = 2)\ntext(x = 10, y = LOG_K * 0.95, labels = paste0(\"K = \", LOG_K), col = col_3, pos = 1)\ntext(x = 55, y = LOG_K * 1.8, labels = \"Exponential\", col = col_1)\ntext(x = 85, y = LOG_K * 0.7, labels = \"Logistic\", col = col_2)\n}",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Mathematical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_08.html#e8.1",
    "href": "chap_03/chap_08.html#e8.1",
    "title": "17  Mathematical Models",
    "section": "E8.1",
    "text": "E8.1\nWhat data structure is returned by the ode function?",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Mathematical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_08.html#e8.2-lotka-volterra",
    "href": "chap_03/chap_08.html#e8.2-lotka-volterra",
    "title": "17  Mathematical Models",
    "section": "E8.2 Lotka-Volterra",
    "text": "E8.2 Lotka-Volterra\nThe Lotka-Volterra model describes the dynamics of two interactive species (predator and prey) in an ecological system, and contains a pair of equations:\n\\[\n\\frac{dx}{dt} = a \\cdot x - b \\cdot x \\cdot y \\\\\n\\frac{dy}{dt} = c \\cdot x \\cdot y - d \\cdot y\n\\]\nSolve and plot the model based on these parameter values\n\nX0 &lt;- 1\nY0 &lt;- 1\n\nLV_A &lt;- 2/3\nLV_B &lt;- 4/3\nLV_C &lt;- 1\nLV_D &lt;- 1\n\nT_LAST &lt;- 40\nT_INTR &lt;- 0.01",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Mathematical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_08.html#e8.3-drug-concentration-model",
    "href": "chap_03/chap_08.html#e8.3-drug-concentration-model",
    "title": "17  Mathematical Models",
    "section": "E8.3 Drug concentration model",
    "text": "E8.3 Drug concentration model\nA simple 2 compartment model based on this set of differential equations is very useful for modelling the concentraition of drugs: \\[\n\\frac{dx}{dt} = -r1 * x \\\\\n\\frac{dy}{dt} = r1 * x - r2 * y\n\\]\nSolve and plot the model based on these parameter values\n\nX0 &lt;- 1\nY0 &lt;- 0\nR1 &lt;- 1/3\nR2 &lt;- 1/10",
    "crumbs": [
      "Model Building",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Mathematical Models</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_09.html",
    "href": "chap_03/chap_09.html",
    "title": "18  Performance",
    "section": "",
    "text": "18.1 Good practices\nOutline\nRecommended Readings:\nWorkflow:",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Performance</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_09.html#good-practices",
    "href": "chap_03/chap_09.html#good-practices",
    "title": "18  Performance",
    "section": "",
    "text": "DRY\n\n\n\nrm(list = ls()) at the beginning of your script\nMake sure you understand all warnings\nDon’t repeat yourself (DRY)\n\nUse functions (Session 1)\nVectorise functions (Session 3)\nUse inheritance (Session 6)\n\nReadable code\n\nComment where needed\nNo magic numbers\nVariable names\n\nBigCamelCase for function names\nsnake_case for everything else\nALL_CAPS for constants\n\nVersion control",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Performance</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_09.html#code-profiling",
    "href": "chap_03/chap_09.html#code-profiling",
    "title": "18  Performance",
    "section": "18.2 Code Profiling",
    "text": "18.2 Code Profiling\nWe now demonstrate the process of optimising the performance of an algorithm’s implementation using the profiling tool provided by RStudio. The algorithm we implement is the Monte Carlo integration method to estimate the value of pi. The idea is to randomly sample points in a unit square and count how many of them fall within a quarter circle inscribed within that square. The ratio of points inside the quarter circle to the total number of points sampled can be used to estimate pi.\n\n18.2.1 Version 1\n\nMonteCarloPiV1 &lt;- function (n) {\n  stopifnot(n &gt; 1)\n  n_inside_count &lt;- 0\n  for (ii in seq_len(n)) {\n    x &lt;- runif(1)\n    y &lt;- runif(1)\n    if (x^2 + y^2 &lt; 1) {\n      n_inside_count &lt;- n_inside_count + 1\n    }\n  }\n  return(n_inside_count / n)\n}\n\nN &lt;- 500000\nsystem.time(pi_est &lt;- MonteCarloPiV1(N)*4)\n\nstopifnot(pi_est - pi &lt; 0.01)\nprint(\"test passed\")\n\n\nprofvis - Profile an R expression and visualise profiling data\nRStudio &gt; Profile &gt; Profile Selected Line(s)\nWe see that most of the time is spent on the two runif calls\n\n\n\n18.2.2 Version 2\n\nMonteCarloPiV2 &lt;- function (n) {\n  stopifnot(n &gt; 1)\n  n_inside_count &lt;- 0\n  x_sq &lt;- runif(n)\n  y_sq &lt;- runif(n)\n  for (ii in seq_along(x_sq)) {\n    if (x_sq[ii]^2 + y_sq[ii]^2 &lt; 1) {\n      n_inside_count &lt;- n_inside_count + 1\n    }\n  }\n  return(n_inside_count / n)\n}\n# MonteCarloPiV2(1000)*4\nN &lt;- 500000\nN &lt;- N * 10\nsystem.time(pi_est &lt;- MonteCarloPiV2(N)*4)\n\n\nstopifnot(pi_est - pi &lt; 0.01)\nprint(\"test passed\")\n\n\nIncrease the size of N to see that most of the time is spent in the for loop\n\n\n\n18.2.3 Version 3\n\nMonteCarloPiV3 &lt;- function (n) {\n  stopifnot(n &gt; 1)\n  n_inside_count &lt;- 0\n  x_sq &lt;- runif(n)\n  y_sq &lt;- runif(n)\n  \n  d_sq &lt;- x_sq^2 + y_sq^2\n  d_sq_bol &lt;- d_sq &lt; 1\n  \n  n_inside_count &lt;- length(d_sq_bol[d_sq_bol == TRUE])\n  \n  return(n_inside_count / n)\n}\n# MonteCarloPiV2(1000)*4\nN &lt;- 500000\nN &lt;- N * 10\nsystem.time(pi_est &lt;- MonteCarloPiV3(N)*4)\n\n\nstopifnot(pi_est - pi &lt; 0.01)\nprint(\"test passed\")\n\n\n\n18.2.4 Version 4\n\nMonteCarloPiV4 &lt;- function (n) {\n  stopifnot(n &gt; 1)\n  n_inside_count &lt;- 0\n  x_sq &lt;- runif(n)\n  y_sq &lt;- runif(n)\n  \n  d_sq &lt;- x_sq^2 + y_sq^2\n  d_sq_bol &lt;- d_sq &lt; 1\n  \n  n_inside_count &lt;- sum(d_sq_bol, na.rm = TRUE)\n  \n  return(n_inside_count / n)\n}\n# MonteCarloPiV2(1000)*4\nN &lt;- 500000\nN &lt;- N * 10\nsystem.time(pi_est &lt;- MonteCarloPiV4(N)*4)\n\n\nstopifnot(pi_est - pi &lt; 0.01)\nprint(\"test passed\")\n\n\n\n18.2.5 microbenchmark\n\nN &lt;- 500000\n# N &lt;- N * 10\nif (!exists(\"mb_res1\")) {\n  mb_res1 &lt;- microbenchmark::microbenchmark(\n            times = 100, unit = \"ms\",\n            MonteCarloPiV1(N),\n            MonteCarloPiV2(N),\n            MonteCarloPiV3(N),\n            MonteCarloPiV4(N)              \n          )\n}\n\n# print(mb_res)\n# boxplot(mb_res)\n\nggplot2::autoplot(mb_res1) #+\n  # scale_fill_viridis(discrete=TRUE)",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Performance</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_09.html#general-principles",
    "href": "chap_03/chap_09.html#general-principles",
    "title": "18  Performance",
    "section": "18.3 General principles",
    "text": "18.3 General principles\n\n18.3.1 Don’t grow your data\n\nrm(list = ls())\n\nFun1 &lt;- function(n) {\n  res &lt;- NULL\n  for (ii in seq_len(n)) {\n    res &lt;- c(res, ii)\n  }\n  return(res)\n}\n\nFun2 &lt;- function(n) {\n  res &lt;- numeric(n) # pre-allocate memory space\n  for (ii in seq_len(n)) {\n    res[ii] &lt;- ii\n  }\n  return(res)\n}\n\nFun3 &lt;- function(n) {\n  return(seq_len(n)) # use a built-in function when possible\n}\n\nN &lt;- 10000\nif (!exists(\"mb_res2\")) {\n  mb_res2 &lt;- microbenchmark::microbenchmark(\n    times = 100, unit = \"ms\",\n    Fun1(N), Fun2(N), Fun3(N)\n  )\n}\n\nWarning in microbenchmark::microbenchmark(times = 100, unit = \"ms\", Fun1(N), :\nless accurate nanosecond times to avoid potential integer overflows\n\nggplot2::autoplot(mb_res2)\n\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\nℹ Please use tidy evaluation idioms with `aes()`.\nℹ See also `vignette(\"ggplot2-in-packages\")` for more information.\nℹ The deprecated feature was likely used in the microbenchmark package.\n  Please report the issue at\n  &lt;https://github.com/joshuaulrich/microbenchmark/issues/&gt;.\n\n\n\n\n\n\n\n\n\n\n\n18.3.2 Lazy evaluation\n\nrm(list = ls())\n\nN &lt;- 1e6\nV &lt;- runif(N)\nv1 &lt;- V &gt; 0.1\nv2 &lt;- V &gt; 0.4\nv3 &lt;- V &gt; 0.9\n\nmb_res_le &lt;- microbenchmark::microbenchmark(\n  times = 100, unit = \"ms\",\n  which(v1 & v2 & v3), which(v3 & v2 & v1)\n)\nstopifnot(identical(which(v1 & v2 & v3), which(v3 & v2 & v1)))\nggplot2::autoplot(mb_res_le)\n\n\n\n\n\n\n\n\n\nmb_res_le_or &lt;- microbenchmark::microbenchmark(\n  times = 100, unit = \"ms\",\n  which(v1 | v2 | v3), which(v3 | v2 | v1)\n)\nstopifnot(identical(which(v1 | v2 | v3), which(v3 | v2 | v1)))\nggplot2::autoplot(mb_res_le_or)\n\n\n\n\n\n\n\n\n\n\n18.3.3 Use low level structure\n\nrm(list = ls())\n\nC &lt;- 10000\nM &lt;- matrix(runif(C^2), nrow = C)\nDF &lt;- as.data.frame(M)\n\nmb_res4 &lt;- microbenchmark::microbenchmark(\n  times = 100, unit = \"ms\",\n  sum(M[1, ]), sum(DF[1, ])\n)\nstopifnot(sum(M[1, ]) == sum(DF[1, ]))\nggplot2::autoplot(mb_res4)",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Performance</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_09.html#biy",
    "href": "chap_03/chap_09.html#biy",
    "title": "18  Performance",
    "section": "18.4 BIY",
    "text": "18.4 BIY\nBenchmark it yourself\n\n18.4.1 Check for NA\n\nrm(list = ls())\n\nN &lt;- 1e5\nV &lt;- runif(N)\n\nV_has_NA_l &lt;- V # low\nV_has_NA_m &lt;- V # mid\nV_has_NA_h &lt;- V # high\n\n\nV_has_NA_l[1] &lt;- NA\nV_has_NA_m[N/2] &lt;- NA\nV_has_NA_h[N] &lt;- NA\n\nmb_res5 &lt;- microbenchmark::microbenchmark(\n  times = 100, unit = \"ms\",\n  anyNA(V), any(is.na(V)), is.na(sum(V)),\n  anyNA(V_has_NA_l), any(is.na(V_has_NA_l)), is.na(sum(V_has_NA_l)),\n  anyNA(V_has_NA_m), any(is.na(V_has_NA_m)), is.na(sum(V_has_NA_m)),\n  anyNA(V_has_NA_h), any(is.na(V_has_NA_h)), is.na(sum(V_has_NA_h))\n)\n\nWarning in microbenchmark::microbenchmark(times = 100, unit = \"ms\", anyNA(V), :\nCould not measure a positive execution time for 10 evaluations.\n\nstopifnot(!any(\n  anyNA(V), any(is.na(V)), is.na(sum(V))\n))\nstopifnot(all(\n  anyNA(V_has_NA_l), any(is.na(V_has_NA_l)), is.na(sum(V_has_NA_l))\n))\nstopifnot(all(\n  anyNA(V_has_NA_m), any(is.na(V_has_NA_m)), is.na(sum(V_has_NA_m))\n))\nstopifnot(all(\n  anyNA(V_has_NA_h), any(is.na(V_has_NA_h)), is.na(sum(V_has_NA_h))\n))\n\nlibrary(\"ggplot2\", \"RColorBrewer\")\n# ggplot2::autoplot(mb_res5, fill = expr) +\n#   scale_fill_brewer(palette=\"Set1\")\n\ncol_list &lt;- c(\"#E41A1C\", \"#984EA3\", \"#4DAF4A\") #\"#377EB8\"\n\nggplot(data = mb_res5, aes(x = expr, y = time, fill = expr, col = expr)) + \n  geom_violin() + \n  scale_y_continuous(trans = \"log10\") +\n  # scale_fill_brewer(palette=\"Set1\") +\n  scale_color_manual(values = rep(col_list, 4)) +\n  scale_fill_manual(values = rep(col_list, 4)) +\n  theme(legend.position = \"none\") +\n  coord_flip()\n\nWarning in scale_y_continuous(trans = \"log10\"): log-10 transformation\nintroduced infinite values.\n\n\nWarning: Removed 46 rows containing non-finite outside the scale range\n(`stat_ydensity()`).\n\n\n\n\n\n\n\n\n\n\nSome algorithms’ performance is data dependent\n\n\n\n18.4.2 Column-wise max\n\nrm(list = ls())\nC &lt;- 100\n# C &lt;- 1000 # Some algorithm's performance is data-dependent\n# M &lt;- matrix(1:C^2, nrow = C/2)\nM &lt;- matrix(runif(C^2), nrow = C/2)\n\nFun1 &lt;- function(m) {\n  c &lt;- ncol(m)\n  res &lt;- numeric(c)\n  \n  for (cc in seq_len(c)) {\n    res[cc] &lt;- max(m[, cc])\n  }\n  return(res)\n}\n\nFun1_glb &lt;- function() {\n  c &lt;- ncol(M)\n  res &lt;- numeric(c)\n  for (cc in seq_len(c)) {\n    res[cc] &lt;- max(M[, cc])\n  }\n  return(res)\n}\nstopifnot(identical(Fun1(M), Fun1_glb()))\n\nFun2 &lt;- function(m) {\n  return(apply(m, MARGIN = 2, max))\n}\n\nFun2_glb &lt;- function() {\n  return(apply(M, MARGIN = 2, max))\n}\n# stopifnot(identical(Fun2(M), Fun2_glb()))\n\n# stopifnot(all.equal(Fun1(M), Fun2(M), matrixStats::colMaxs(M)))\n\n\nmb_res3 &lt;- microbenchmark::microbenchmark(\n  times = 100, unit = \"ms\",\n  Fun1(M),\n  Fun1_glb(),\n  Fun2(M),\n  Fun2_glb,\n  apply(M, MARGIN = 2, max),\n  matrixStats::colMaxs(M)\n)\n\nWarning in microbenchmark::microbenchmark(times = 100, unit = \"ms\", Fun1(M), :\nCould not measure a positive execution time for 36 evaluations.\n\nggplot2::autoplot(mb_res3)\n\nWarning in ggplot2::scale_y_log10(name = y_label): log-10 transformation\nintroduced infinite values.\n\n\nWarning: Removed 68 rows containing non-finite outside the scale range\n(`stat_ydensity()`).\n\n\n\n\n\n\n\n\n# typeof(M)\n# a &lt;- Fun1(M)\n# b &lt;- Fun2(M)\n# typeof(a)\n# typeof(b)\n# typeof(matrixStats::colMaxs(M))\n\n\n\n18.4.3 Row-wise sum\n\nrm(list = ls())\n\nC &lt;- 1000\n# C &lt;- 1000 # Some algorithm's performance is data-dependent\n# M &lt;- matrix(1:C^2, nrow = C/2)\nM &lt;- matrix(runif(C^2), nrow = C)\n\n# stopifnot(all.equal(\n#   apply(M, MARGIN = 1, sum),\n#   rowSums(M),\n#   matrixStats::rowSums2(M)\n# ))\n\nmb_res_sum &lt;- microbenchmark::microbenchmark(\n  times = 10, unit = \"ms\",\n  apply(M, MARGIN = 1, sum),\n  rowSums(M),\n  matrixStats::rowSums2(M)\n)\nggplot2::autoplot(mb_res_sum)",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Performance</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_09.html#summary",
    "href": "chap_03/chap_09.html#summary",
    "title": "18  Performance",
    "section": "18.5 Summary",
    "text": "18.5 Summary\n\nUse vectorised function\n\nRemember that there is no scalar type in R\nKnow which functions are vectorised\nAvoid for loop when possible\n\nHand over to R as soon as possible\nDon’t grow your data\nUtilise lazy evaluation\nUse low level structure\nSpecify integer when possible\nCompare different methods yourself\nAsk Google (example)\nThere is Rcpp to look forward to",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Performance</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_09.html#revision",
    "href": "chap_03/chap_09.html#revision",
    "title": "18  Performance",
    "section": "Revision",
    "text": "Revision\n\nWhat have we achieved this week:\n\nWe learnt ~5% of what R can do, maybe.\nThe CRAN package repository features 18090 packages, source\nWe learnt ~0.01% of what programming languages can do, likely less.\n\nWhat is R?\n\nLook at the language as a statistician\n\n\n\n\n\nTop programming languages 2021, IEEE Spectrum\n\n\n\nFunctions\n\nSession 1:\n\nHow to write your own function\nEverything that happens in R is a function call\n\nSession 2:\n\nFunction environment\n\nSession 3&4:\n\nApply functions to vectors\n\n\nVectors\n\nSession 3\n\nThere is no scalar type in R\nEverything is a fancy vector\n\nSession 4\n\nHow to work with vectors\n\nSession 9\n\nUtilise vectorised functions\n\n\n\n\n\n\nDiagram: data structures in R",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Performance</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_09.html#what-to-do-next",
    "href": "chap_03/chap_09.html#what-to-do-next",
    "title": "18  Performance",
    "section": "What to do next?",
    "text": "What to do next?\n\nPractice, practice, …\n\nProject Euler, https://projecteuler.net/\nhttps://leetcode.com/\nAdvanced R Solutions\nCode reading skills\n\nGet help in R\n\n?\nstr\n\nLearn editor tricks\n\nALT + click up/down\nALT + SHIFT + click and drag a rectangle\nCTRL + ALT + SHIFT + M (find in scope)\nMore tricks",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Performance</span>"
    ]
  },
  {
    "objectID": "chap_03/chap_09.html#assessment-time",
    "href": "chap_03/chap_09.html#assessment-time",
    "title": "18  Performance",
    "section": "Assessment Time",
    "text": "Assessment Time\n\n\n\nGood luck with your adventuRe :)",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Performance</span>"
    ]
  },
  {
    "objectID": "workshops/wks_02_rnumbers.html",
    "href": "workshops/wks_02_rnumbers.html",
    "title": "19  Random Numbers and Probability Distributions",
    "section": "",
    "text": "19.1 Generating Random Numbers\nThis worksheet focuses on the use of functions in the stats package (base R) related to standard probability distributions. These functions come in four groups, each with a different prefix:\nFor example, for the normal distribution, the functions are:\nSee ?Distributions for the full list of distributions and their corresponding function names.\nThe r functions generate random numbers from a specified distribution. The general syntax is:\nr&lt;distribution&gt;(n, parameters)\nWhere n is the number of random numbers to generate, and parameters are the specific parameters of the distribution (e.g., mean and standard deviation for normal distribution). For example, to generate 10,000 random numbers from a normal distribution with mean 5 and standard deviation 2:\nrandom_numbers &lt;- rnorm(n = 10000, mean = 5, sd = 2)\nplot(density(random_numbers))\nIt is computationally more efficient to generate random numbers in batches rather than one at a time with a loop:\nsize &lt;- 100000\n# Generating random numbers one at a time (inefficient)\ntime_single &lt;- system.time({\n  random_numbers_single &lt;- rep(0, size)\n  for (i in seq_along(random_numbers_single)) {\n    random_numbers_single[i] &lt;- rnorm(1, mean = 5, sd = 2)\n  }\n})\n\n# Generating random numbers in a batch (efficient)\ntime_batch &lt;- system.time({\n  random_numbers_batch &lt;- rnorm(size, mean = 5, sd = 2)\n})\n\n# Compare the times\ncat(\"Time for single generation:\", time_single[\"elapsed\"], \"seconds\\n\")\ncat(\"Time for batch generation:\", time_batch[\"elapsed\"], \"seconds\\n\")\ncat(\"Speed-up factor:\", round(time_single[\"elapsed\"] / time_batch[\"elapsed\"], 1), \"x\\n\")\n\nTime for single generation: 0.035 seconds\nTime for batch generation: 0.001 seconds\nSpeed-up factor: 35 x",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Random Numbers and Probability Distributions</span>"
    ]
  },
  {
    "objectID": "workshops/wks_02_rnumbers.html#relation-between-the-four-groups-of-functions",
    "href": "workshops/wks_02_rnumbers.html#relation-between-the-four-groups-of-functions",
    "title": "19  Random Numbers and Probability Distributions",
    "section": "19.2 Relation between the four groups of functions",
    "text": "19.2 Relation between the four groups of functions\nThe four functions are interrelated:\n\nThe cumulative distribution function (p) is the integral (or sum, for discrete distributions) of the density function (d).\nThe quantile function (q) is the inverse of the cumulative distribution function (p).\nThe random generation function (r) generates random samples based on the specified distribution. A random sample from the runif function can be transformed into a sample from any other distribution using the corresponding quantile function (q).\n\nWe can demonstrate these relationships with the normal distribution:\n\n\nCode\nset.seed(101)\n\n# Parameters of our example normal distribution\nsize  &lt;- 1000\nmu    &lt;- 5\nsigma &lt;- 2\n\n# Generate random samples\nsamples &lt;- rnorm(n = size, mean = mu, sd = sigma)\n\nx_vals &lt;- seq(mu - 3 * sigma, mu + 3 * sigma, length.out = size)\n# Cal density, cumulative probabilities, and quantiles of this distribution\ndensity_vals &lt;- dnorm(x_vals, mean = mu, sd = sigma)\ncum_probs    &lt;- pnorm(x_vals, mean = mu, sd = sigma)\nquantiles    &lt;- qnorm(cum_probs, mean = mu, sd = sigma)\n\n\npar(mfrow = c(2, 2))\nhist(\n    samples, breaks = 30, probability = TRUE,\n    main = \"Histogram of samples from rnorm\",\n    xlab = \"Value (bins of values sampled from rnorm)\"\n)\nlines(x_vals, density_vals, col = \"blue\", lwd = 2)\nplot(\n    x_vals, density_vals, type = \"l\",\n    main = \"Density Function (dnorm)\",\n    xlab = \"x_vals\", ylab = \"Density\", col = \"blue\", lwd = 2\n)\nplot(\n    x_vals, cum_probs, type = \"l\", \n    main = \"Cumulative Distribution Function (pnorm)\",\n    xlab = \"x\", ylab = \"Cumulative Probability\", col = \"green\", lwd = 2\n)\nplot(\n    cum_probs, quantiles, type = \"l\",\n    main = \"Quantile Function (qnorm)\",\n    xlab = \"Cumulative Probability\",\n    ylab = \"Quantile\", col = \"red\", lwd = 2\n)",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Random Numbers and Probability Distributions</span>"
    ]
  },
  {
    "objectID": "workshops/wks_02_rnumbers.html#commonly-used-distributions",
    "href": "workshops/wks_02_rnumbers.html#commonly-used-distributions",
    "title": "19  Random Numbers and Probability Distributions",
    "section": "19.3 Commonly used distributions",
    "text": "19.3 Commonly used distributions\nHere are some commonly used probability distributions along with their parameters:\n\nNormal: rnorm(n, mean, sd) where mean is the average and sd is the standard deviation. Represent real-valued random variables whose distributions are not known to be non-normal.\nUniform: runif(n, min, max) where min and max define the range of the distribution. Represents a distribution where all outcomes are equally likely within the specified range.\nBinomial: rbinom(n, size, prob) where size is the number of trials and prob is the probability of success on each trial. Represents the number of successes in a fixed number of independent Bernoulli trials.\nPoisson: rpois(n, lambda) where lambda is the average rate (mean) of occurrence. Represents the number of events occurring within a fixed interval of time or space.\nExponential: rexp(n, rate) where rate is the rate parameter (inverse of the mean). Represents the time between events in a Poisson process.\n\n\n\nCode\nnum_samples &lt;- 1e6\n\nnormal_samples &lt;- rnorm(num_samples, mean = 0, sd = 1)\nuniform_samples &lt;- runif(num_samples, min = 0, max = 10)\npoisson_samples &lt;- rpois(num_samples, lambda = 3)\nbinomial_samples &lt;- rbinom(num_samples, size = 10, prob = 0.5)\nexponential_samples &lt;- rexp(num_samples, rate = 1)\n\npar(mfrow = c(3, 2))\nplot(density(normal_samples), main = \"Normal Distribution\", xlab = \"Value\")\nplot(density(uniform_samples), main = \"Uniform Distribution\", xlab = \"Value\")\nhist(poisson_samples, main = \"Poisson Distribution\", xlab = \"Value\", breaks = 30)\nhist(binomial_samples, main = \"Binomial Distribution\", xlab = \"Value\", breaks = 30)\nplot(density(exponential_samples), main = \"Exponential Distribution\", xlab = \"Value\")",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Random Numbers and Probability Distributions</span>"
    ]
  },
  {
    "objectID": "workshops/wks_01.html",
    "href": "workshops/wks_01.html",
    "title": "20  Sensitivity analysis workflow",
    "section": "",
    "text": "An example sensitivity analysis workflow: https://bogaotory.github.io/training-r/intro-sa/sa.nb.html",
    "crumbs": [
      "Further Topics",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Sensitivity analysis workflow</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Apple. 2017. “Technical Note TN2339.” 2017. https://developer.apple.com/library/archive/technotes/tn2339/_index.html.\n\n\nApple, Developer Documentation. 2018-04-09. “File System\nProgramming Guide.” 2018-04-09. https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/FileSystemOverview/FileSystemOverview.html.\n\n\nAsodariya, Parth. 2025. “Command Line Tools for Xcode: A Quick\nInstallation Guide.” DhiWise. 2025. https://www.dhiwise.com/post/command-line-tools-for-xcode-a-quick-installation-guide.\n\n\nGeaksforGeeks. 2025. “Difference Between Terminal, Console, Shell,\nand Command Line.” 2025. https://www.geeksforgeeks.org/operating-systems/difference-between-terminal-console-shell-and-command-line/.\n\n\nStack Overflow. 2025. “Most Popular Development Environments /\n2025 Developer Survey.” 2025. https://survey.stackoverflow.co/2025/technology#most-popular-technologies-dev-envs.\n\n\nThe R Core Team. 2025. “Packages in the Standard Library.”\n2025. https://stat.ethz.ch/R-manual/R-devel/doc/html/packages.html.\n\n\nThe R Foundation. 2025. “What Is R?” 2025. https://www.r-project.org/about.html.",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "chap_00/file_address_sys.html",
    "href": "chap_00/file_address_sys.html",
    "title": "Appendix A — File address system",
    "section": "",
    "text": "A.1 Absolute path\nWhen you organise an event, and you need to tell everyone where it is held, you have a choice to make:\nThis is the same when you refer to a file or a directory located on your computer’s hard drive (HD). These two options are referred to as absolute (full) and relative paths of the target file or directory. When it comes to a coding project, it is almost always preferable to use relative paths.\nEvery file and directory on your hard drive (HD) has its own address. For example, if you have a file named child.csv which is inside a directory (also referred to as a folder) named parent which is inside another directory named grand_parent, the parent of which is the root of your HD:\nDepending on which family of operating system(OS) you have, the address of child.csv may be written as:\nRepresenting the full addresses of your file, these strings of characters are also referred to as the absolute paths of your file. Depending on which family of operating system (OS) you have on your computer, the address is formatted differently. Let’s look at this more closely:",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>File address system</span>"
    ]
  },
  {
    "objectID": "chap_00/file_address_sys.html#absolute-path",
    "href": "chap_00/file_address_sys.html#absolute-path",
    "title": "Appendix A — File address system",
    "section": "",
    "text": "[root]\n+-- grand_parent\n    +-- parent\n        +-- child.csv\n\n\nOn macOS (and other UNIX systems): /grand_parent/parent/child.csv\nOn Windows: C:\\grand_parent\\parent\\child.csv\n\n\n\nThe address always begin (from the left) with the biggest identifiable unit that contains the target file. This is the opposite to how you would write an address in real life (in the West). For example, you would write: “University Offices, Wellington Square, Oxford, OX1 2JD, United Kingdom” as the address on a letter addressed to the University of Oxford, starting with the smallest identifiable unit from the left.\nSince the file you are addressing for is somewhere on the HD of your computer, the address begins with the symbol that represents the root of your HD. On UNIX systems, this is the / character, and on Windows, this is the C:\\ character string.1 If we were to have an equivalent address for the University of Oxford, it probably would begin with Earth 🌍.\nAs we look towards the end (right) of the address, there is a zoom-in process with the identifiable unit (the directories or folders) getting smaller and smaller until it gets to the file that you are addressing for. All these identifiable units need to be concatenated. We don’t like having blank spaces in addresses, but we still need a way to separate the names of these units. This separator character is / on UNIX, and \\ on Windows.\nGiven the definition of the separator characters, you might review our definition of the roots, and say that the root is [nothing] on UNIX, and C: on Windows, with the first / and \\ character in the string being the separator between the root and the first directory on the path.\n\n1 With C indicating the C drive. And yes, there was at a time A and B drives too, and D drive (on the same HD) which went out of fashion not long ago.\nThese examples are known as absolute paths, in that these paths begins (on its left) from the root directory and spell out absolutely everything that’s along the way to your file.\n\n\n\n\n\n\n\nTipExercise\n\n\n\nWhen you browse the web, look at the address bar at the top of your browser. Each resource that’s published on the internet also has an address. Ask yourself, what is the root and separator character in that address system?\n\n\n\nA.1.1 Why you should not use absolute path in your code\nAlong the whole string of characters on an absolute path, you have the names of all of the directories until you get to the file you want. The directory structure differs from machine to machine, and it is very unlikely that you would have identical directory structures on two machines.\nFor example, Adam is working on a project that involves two files on his laptop:\n\n/Users/adam/Projects/big_project/data.csv, a csv file that contains some data\n/Users/adam/Projects/big_project/process_data.r, an R script that processes data.csv\n\nIn process_data.r, he wrote the following to read the csv file:\n\n\n\nListing A.1: process_data.r, works for Adam only\n\n\nfile_to_read &lt;- \"/Users/adam/Projects/big_project/data.csv\"\ndf &lt;- read.csv(file_to_read)\n\n\n\nYou can see that he specified the path of the file (in file_to_read) using the absolute path of data.csv. This script (process_data.r) works perfectly fine on Adam’s machine.\nFor the next step of the project he needs to send it to Eve who wants to extend the work. So Adam sends these two files (data.csv and process_csv.r) to Eve via email. Eve downloaded these two files from the email attachment to her laptop. On her laptop, the absolute paths of these two files are:\n\n/Users/eve/Downloads/data.csv\n/Users/eve/Downloads/process_data.r\n\nNow, Eve wants to run Adam’s code (process_data.r, Listing A.1) to see what it produces. Given what we know about the absolute path of data.csv on Eve’s laptop in comparison to that on Adam’s laptop, do you think the script would run correctly on Eve’s machine?\nOf course not, because in Adam’s code (Listing A.1), the path of data.csv is given as /Users/adam/Projects/big_project/data.csv which does not exist on Eve’s machine. On Eve’s laptop, the absolute path of data.csv is /Users/eve/Downloads/data.csv.\nIn order for the code to work, Eve will need to modify process_data.r (Listing A.1) to be:\n\n\n\nListing A.2: process_data.r, works for Eve only\n\n\nfile_to_read &lt;- \"/Users/eve/Downloads/data.csv\"\ndf &lt;- read.csv(file_to_read)\n\n\n\nDon’t under-estimate the negative impact of this extra step of work. Although the work involved is not technically complex or challenging, it creates a barrier between different collaborators of the project.\n\n\n\n\n\n\nTipWho are your collaborators?\n\n\n\n\n\n\nYourself. Yes, you are collaborating with yourself, the future you. That you in a couple of days/weeks/months’ time. You are handing over the development of this project to the future you. Will that you be able to understand everything that you are writing now? How easy will it be for you to pick this project up in the future? Will that future you hate the now you?\nYour assignment and dissertation marker. They are very judgemental, and they expect your code to work without modification.\nOthers working on the same project.\n\n\n\n\nIn this example, the script only requires one other file. That is far from reality. The workload increases dramatically as your project grows. What if Eve has extended the code and it now works with 10 csv files, and now she needs to pass the project back to Adam? What’s the workload needed from Adam’s end?\n\nAbsolute paths are only likely to be valid on one machine, and that it is a terrible idea to use absolute paths to specify file locations in a coding project.\n\n\n\n\n\n\n\nNoteThe problematic part of the absolute path\n\n\n\n\n\nAll the characters preceding data.csv are invalid on Eve’s laptop. And this section of the absolute path can be seen as in two parts:\n\nThe first part /Users/adam is written to comply with the setting of the OS. The OS has full control of the HD that it is installed on, and you as the user is only allowed to operate within a designated space on the HD, which in this case is /Users/adam. The first / refers to the root of the HD. The next directory name is Users because macOS saves all user files in that directory (Figure A.1). Adam as the user has no control over this.\n\n\n\n\n\n\n\nFigure A.1: macOS file system Apple (2018-04-09)\n\n\n\n\n\n\n\n\n\nTipWhat’s in the (local domain) Library directory?\n\n\n\n\n\nIn Figure A.1, note where the (local domain) Library directory is in relation to the other system directories. If you installed R or Python correctly on your macOS, then you should be able to find them in the following two directories:\n/Library/Frameworks/R.framework\n/Library/Frameworks/Python.framework\n\n\n\nNot only do we as the users not have control over the names of these OS-defined directory names, we also don’t have control over what OS/settings the other users have on their machines. (The user has control over what username is used, but that’s done only once when the user account is created by the OS for the user, and users are not expected to change this once it has been set up.)\n\nThe next part of this absolute path (/Projects/big_project), is decided by the user Adam, and we cannot expect Eve to have the same habit of naming directories on her laptop.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>File address system</span>"
    ]
  },
  {
    "objectID": "chap_00/file_address_sys.html#relative-path",
    "href": "chap_00/file_address_sys.html#relative-path",
    "title": "Appendix A — File address system",
    "section": "A.2 Relative Path",
    "text": "A.2 Relative Path\nTo avoid the issues that come with absolute paths, we need an alternative way to specify the location of a file/directory which is valid across machines. Essentially, we want to do /Users/adam/Projects/big_project/data.csv ignoring everything that’s outside the scope of the project. In fact, that’s not too far from how relative paths are constructed:\nWith . denoting the project’s root directory, the relative path to data.csv which is equivalent to /Users/adam/Projects/big_project/data.csv in the context of the big_project project is:\n./data.csv\nThe key here is the definition of .. Within the context of a project, . refers to the current working directory of the project which by default is the root directory of the project.\nLet’s look at these concepts with our Adam and Eve example. Assuming that Adam and Eve are now working collaboratively on the big_project project with Adam taking the lead role. They both use macOS. Adam saves all his projects in a directory named Projects. Eve has moved everything out of the Downloads folder and has created a directory named Others_projects that contains projects that she works collaboratively with other people:\n\n\n\nAdam’s laptop\n/\n+-- Users\n    +-- adam\n        +-- Projects\n            +-- big_project\n            |   +-- data.csv\n            |   +-- process_data.r\n            +-- another_project\n            |   +-- data\n            |   |   +-- log_day_1.csv\n            |   |   +-- log_day_2.csv\n            |   +-- main.r\n            |   +-- script_01.r\n\n\n\nEve’s laptop\n/\n+-- Users\n    +-- eve\n        +-- Downloads\n        +-- Others_projects\n            +-- big_project_adam\n            |   +-- data.csv\n            |   +-- process_data.r\n\n\n\nOn Adam’s laptop, we see that he is working on two projects both of which are saved under his Projects directory. Each of the two directories (big_project and another_project) under the Projects directory contains files relevant to each of the two projects respectively, and therefore are the root directories of those two projects.\nOn Eve’s laptop, big_project_adam is the root directory of Eve’s copy of Adam’s big_project project.\nOrienting from the root directory of the big_project project, with relative path, instead of writing our address beginning from the root of the HD (i.e. /), we begin our address referring to the root directory of the project with a .. With this approach, process_data.r is written as:\n\n\n\nListing A.3: process_data.r with relative path, works on both machines\n\n\nfile_to_read &lt;- \"./data.csv\"\ndf &lt;- read.csv(file_to_read)\n\n\n\nAdam and Eve now have identical process_data.r that works on their own as well as each other’s machines.\n\n\n\n\n\n\nTipSame setting using absolute path.\n\n\n\n\n\nUsing absolute path, Adam and Eve’s copy of process_data.r would need to have different values assigned to the file_to_read variable:\n\n\n\nListing A.4: process_data.r with absolute path on Adam’s laptop\n\n\nfile_to_read &lt;- \"/Users/adam/Projects/big_project/data.csv\"\ndf &lt;- read.csv(file_to_read)\n\n\n\n\n\n\nListing A.5: process_data.r with absolute path on Eve’s laptop\n\n\nfile_to_read &lt;- \"/Users/eve/Others_projects/big_project_adam/data.csv\"\ndf &lt;- read.csv(file_to_read)",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>File address system</span>"
    ]
  },
  {
    "objectID": "chap_00/file_address_sys.html#the-.",
    "href": "chap_00/file_address_sys.html#the-.",
    "title": "Appendix A — File address system",
    "section": "A.3 The .",
    "text": "A.3 The .\n. denotes the current working directory which refers to the project’s root directory in the context of a coding project by default. Compared to /, . is context-specific. Meaning that . is interpreted differently under different projects. You will learn more on how this works in R from Section 14.3.\nOne other remaining issue with paths is the separator character which is different on different platforms. In R, we solve this issue with the file.path function. You will learn more on this from Section 14.4.\n\n\n\n\nApple, Developer Documentation. 2018-04-09. “File System Programming Guide.” 2018-04-09. https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/FileSystemOverview/FileSystemOverview.html.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>File address system</span>"
    ]
  },
  {
    "objectID": "workshops/00_know_your_computer.html",
    "href": "workshops/00_know_your_computer.html",
    "title": "Appendix B — Know your computer",
    "section": "",
    "text": "B.1 Operating System Tools\nSee Table B.1.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Know your computer</span>"
    ]
  },
  {
    "objectID": "workshops/00_know_your_computer.html#operating-system-tools",
    "href": "workshops/00_know_your_computer.html#operating-system-tools",
    "title": "Appendix B — Know your computer",
    "section": "",
    "text": "Table B.1: Equivalent applications on macOS and Windows\n\n\n\n\n\nmacOS\nWindows\n\n\n\n\nFinder\nFile Explorer\n\n\nTerminal\nCommand Prompt",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Know your computer</span>"
    ]
  },
  {
    "objectID": "workshops/00_know_your_computer.html#sec-terminal",
    "href": "workshops/00_know_your_computer.html#sec-terminal",
    "title": "Appendix B — Know your computer",
    "section": "B.2 Terminal (Command Line)",
    "text": "B.2 Terminal (Command Line)\nBefore the advent of mainstream computer graphical interfaces (e.g. Microsoft Windows and macOS) that display buttons that the user may click with a cursor controlled by a mice, the only way to interact with a computer is by spelling things out (using the keyboard) to the computer on the command line space provided by a terminal.\n\n\n\n\n\n\n\n\n\n\n\n(a) System Terminal\n\n\n\n\n\n\n\n\n\n\n\n(b) R Terminal\n\n\n\n\n\n\n\nFigure B.1: Terminals\n\n\n\nFor example, in macOS, Figure B.1 (a) is a screenshot of a system level terminal, and Figure B.1 (b) is a R language specific terminal. These terminals are able to interpret text-based commands that you type between the prompts (e.g. $, &gt;, \\&gt;) and the Enter key that you type (which indicates the end of the command in most terminals).\nIn the literature, you will come across terminologies such as “Console”, “Shell” which implies the same context as “Terminal” and “Command Line” do. To know more about the differences between these terms, read (GeaksforGeeks 2025).\nThe interactive process that take place in a terminal, for its Read -&gt; Evaluation -&gt; Print -&gt; Read -&gt; Evaluation … sequence of Looped events, is also known as a (language-specific) REPL. This is a common terminology used for interpreted languages such as R and Python that allow this type of interaction.\nIn the context of this book/module, “R terminal”, “R Console”, “R REPL” all refer to the same program that sends your R commands to the R interpreter and prints the corresponding output back to you on the screen.\n\n\n\n\n\n\nNote\n\n\n\nIn this book:\n\nA $ character at the beginning of the line of code indicate that the code is to be type in to the OS-level terminal. See Figure B.1 (a)\nA &gt; or no character at the beginning of the line of code indicate that this is R code which is to be typed in the R terminal. See Figure B.1 (b)",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Know your computer</span>"
    ]
  },
  {
    "objectID": "workshops/00_know_your_computer.html#developer-tools",
    "href": "workshops/00_know_your_computer.html#developer-tools",
    "title": "Appendix B — Know your computer",
    "section": "B.3 Developer Tools",
    "text": "B.3 Developer Tools\n\nB.3.1 macOS\n\nXcode Command Line Tools\n\n\nThe Command Line Tools Package is a small self-contained package available for download separately from Xcode and that allows you to do command line development in macOS. It consists of the macOS SDK and command-line tools such as Clang, which are installed in the /Library/Developer/CommandLineTools directory. - (Apple 2017)\n\nTo install Xcode Command Line Tools:\n$ xcode-select --install\nTo see where Xcode Command Line Tools is installed on your computer:\n$ xcode-select -p\nTo see what tools have been installed as part of the Xcode Command Line Tools package:\n$ ls /Library/Developer/CommandLineTools/usr/bin/\nYou can see tools such as git, g++, make, python3, pip3 installed in that directory. Note that Python developers should download and install Python properly from the official Python site instead of using the version installed with Xcode Command Line Tools.\nYou can read more about this process from (Asodariya 2025)\n\n\n\n\nApple. 2017. “Technical Note TN2339.” 2017. https://developer.apple.com/library/archive/technotes/tn2339/_index.html.\n\n\nAsodariya, Parth. 2025. “Command Line Tools for Xcode: A Quick Installation Guide.” DhiWise. 2025. https://www.dhiwise.com/post/command-line-tools-for-xcode-a-quick-installation-guide.\n\n\nGeaksforGeeks. 2025. “Difference Between Terminal, Console, Shell, and Command Line.” 2025. https://www.geeksforgeeks.org/operating-systems/difference-between-terminal-console-shell-and-command-line/.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Know your computer</span>"
    ]
  }
]